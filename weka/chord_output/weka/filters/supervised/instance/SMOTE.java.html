<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<LINK REL=STYLESHEET TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">
<META NAME="GENERATOR" CONTENT="Java2HTML Version 1.5">
<TITLE>weka.filters.supervised.instance.SMOTE (Java2HTML)</TITLE>
</HEAD>
<BODY><TABLE id="Header" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2" width="33%">&nbsp;</td>
<td align="center" colspan="2" width="33%">
<font size="4">SMOTE.java</font>
</td>
<td align="right" colspan="2" width="33%">&nbsp;</td>
</tr>
</TABLE>
<pre ID="Classes">
<FONT ID="LN">1   </FONT><A NAME="1"></A><FONT ID="MultiLineComment">/*
<FONT ID="LN">2   </FONT><A NAME="2"></A> *    This program is free software; you can redistribute it and/or modify
<FONT ID="LN">3   </FONT><A NAME="3"></A> *    it under the terms of the GNU General Public License as published by
<FONT ID="LN">4   </FONT><A NAME="4"></A> *    the Free Software Foundation; either version 2 of the License, or
<FONT ID="LN">5   </FONT><A NAME="5"></A> *    (at your option) any later version.
<FONT ID="LN">6   </FONT><A NAME="6"></A> *
<FONT ID="LN">7   </FONT><A NAME="7"></A> *    This program is distributed in the hope that it will be useful,
<FONT ID="LN">8   </FONT><A NAME="8"></A> *    but WITHOUT ANY WARRANTY; without even the implied warranty of
<FONT ID="LN">9   </FONT><A NAME="9"></A> *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
<FONT ID="LN">10  </FONT><A NAME="10"></A> *    GNU General Public License for more details.
<FONT ID="LN">11  </FONT><A NAME="11"></A> *
<FONT ID="LN">12  </FONT><A NAME="12"></A> *    You should have received a copy of the GNU General Public License
<FONT ID="LN">13  </FONT><A NAME="13"></A> *    along with this program; if not, write to the Free Software
<FONT ID="LN">14  </FONT><A NAME="14"></A> *    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
<FONT ID="LN">15  </FONT><A NAME="15"></A> */</FONT>
<FONT ID="LN">16  </FONT><A NAME="16"></A>
<FONT ID="LN">17  </FONT><A NAME="17"></A><FONT ID="MultiLineComment">/*
<FONT ID="LN">18  </FONT><A NAME="18"></A> * SMOTE.java
<FONT ID="LN">19  </FONT><A NAME="19"></A> * 
<FONT ID="LN">20  </FONT><A NAME="20"></A> * Copyright (C) 2008 Ryan Lichtenwalter 
<FONT ID="LN">21  </FONT><A NAME="21"></A> * Copyright (C) 2008 University of Waikato, Hamilton, New Zealand
<FONT ID="LN">22  </FONT><A NAME="22"></A> */</FONT>
<FONT ID="LN">23  </FONT><A NAME="23"></A>
<FONT ID="LN">24  </FONT><A NAME="24"></A><FONT ID="Package">package</FONT> weka.filters.supervised.instance;
<FONT ID="LN">25  </FONT><A NAME="25"></A>
<FONT ID="LN">26  </FONT><A NAME="26"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/Attribute.java.html">weka.core.Attribute</A>;
<FONT ID="LN">27  </FONT><A NAME="27"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/Capabilities.java.html">weka.core.Capabilities</A>;
<FONT ID="LN">28  </FONT><A NAME="28"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/Instance.java.html">weka.core.Instance</A>;
<FONT ID="LN">29  </FONT><A NAME="29"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/DenseInstance.java.html">weka.core.DenseInstance</A>;
<FONT ID="LN">30  </FONT><A NAME="30"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/Instances.java.html">weka.core.Instances</A>;
<FONT ID="LN">31  </FONT><A NAME="31"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/Option.java.html">weka.core.Option</A>;
<FONT ID="LN">32  </FONT><A NAME="32"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/OptionHandler.java.html">weka.core.OptionHandler</A>;
<FONT ID="LN">33  </FONT><A NAME="33"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/RevisionUtils.java.html">weka.core.RevisionUtils</A>;
<FONT ID="LN">34  </FONT><A NAME="34"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/TechnicalInformation.java.html">weka.core.TechnicalInformation</A>;
<FONT ID="LN">35  </FONT><A NAME="35"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/TechnicalInformationHandler.java.html">weka.core.TechnicalInformationHandler</A>;
<FONT ID="LN">36  </FONT><A NAME="36"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/Utils.java.html">weka.core.Utils</A>;
<FONT ID="LN">37  </FONT><A NAME="37"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/Capabilities.java.html">weka.core.Capabilities.Capability</A>;
<FONT ID="LN">38  </FONT><A NAME="38"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/TechnicalInformation.java.html">weka.core.TechnicalInformation.Field</A>;
<FONT ID="LN">39  </FONT><A NAME="39"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/core/TechnicalInformation.java.html">weka.core.TechnicalInformation.Type</A>;
<FONT ID="LN">40  </FONT><A NAME="40"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/filters/Filter.java.html">weka.filters.Filter</A>;
<FONT ID="LN">41  </FONT><A NAME="41"></A><FONT ID="Import">import</FONT> <A HREF="../../../../weka/filters/SupervisedFilter.java.html">weka.filters.SupervisedFilter</A>;
<FONT ID="LN">42  </FONT><A NAME="42"></A>
<FONT ID="LN">43  </FONT><A NAME="43"></A><FONT ID="Import">import</FONT> java.util.Collections;
<FONT ID="LN">44  </FONT><A NAME="44"></A><FONT ID="Import">import</FONT> java.util.Comparator;
<FONT ID="LN">45  </FONT><A NAME="45"></A><FONT ID="Import">import</FONT> java.util.Enumeration;
<FONT ID="LN">46  </FONT><A NAME="46"></A><FONT ID="Import">import</FONT> java.util.HashMap;
<FONT ID="LN">47  </FONT><A NAME="47"></A><FONT ID="Import">import</FONT> java.util.HashSet;
<FONT ID="LN">48  </FONT><A NAME="48"></A><FONT ID="Import">import</FONT> java.util.Iterator;
<FONT ID="LN">49  </FONT><A NAME="49"></A><FONT ID="Import">import</FONT> java.util.LinkedList;
<FONT ID="LN">50  </FONT><A NAME="50"></A><FONT ID="Import">import</FONT> java.util.List;
<FONT ID="LN">51  </FONT><A NAME="51"></A><FONT ID="Import">import</FONT> java.util.Map;
<FONT ID="LN">52  </FONT><A NAME="52"></A><FONT ID="Import">import</FONT> java.util.Random;
<FONT ID="LN">53  </FONT><A NAME="53"></A><FONT ID="Import">import</FONT> java.util.Set;
<FONT ID="LN">54  </FONT><A NAME="54"></A><FONT ID="Import">import</FONT> java.util.Vector;
<FONT ID="LN">55  </FONT><A NAME="55"></A>
<FONT ID="LN">56  </FONT><A NAME="56"></A><FONT ID="FormalComment">/**
<FONT ID="LN">57  </FONT><A NAME="57"></A> &lt;!-- globalinfo-start --&gt;
<FONT ID="LN">58  </FONT><A NAME="58"></A> * Resamples a dataset by applying the Synthetic Minority Oversampling TEchnique (SMOTE). The original dataset must fit entirely in memory. The amount of SMOTE and number of nearest neighbors may be specified. For more information, see &lt;br/&gt;
<FONT ID="LN">59  </FONT><A NAME="59"></A> * &lt;br/&gt;
<FONT ID="LN">60  </FONT><A NAME="60"></A> * Nitesh V. Chawla et. al. (2002). Synthetic Minority Over-sampling Technique. Journal of Artificial Intelligence Research. 16:321-357.
<FONT ID="LN">61  </FONT><A NAME="61"></A> * &lt;p/&gt;
<FONT ID="LN">62  </FONT><A NAME="62"></A> &lt;!-- globalinfo-end --&gt;
<FONT ID="LN">63  </FONT><A NAME="63"></A> *
<FONT ID="LN">64  </FONT><A NAME="64"></A> &lt;!-- technical-bibtex-start --&gt;
<FONT ID="LN">65  </FONT><A NAME="65"></A> * BibTeX:
<FONT ID="LN">66  </FONT><A NAME="66"></A> * &lt;pre&gt;
<FONT ID="LN">67  </FONT><A NAME="67"></A> * &amp;#64;article{al.2002,
<FONT ID="LN">68  </FONT><A NAME="68"></A> *    author = {Nitesh V. Chawla et. al.},
<FONT ID="LN">69  </FONT><A NAME="69"></A> *    journal = {Journal of Artificial Intelligence Research},
<FONT ID="LN">70  </FONT><A NAME="70"></A> *    pages = {321-357},
<FONT ID="LN">71  </FONT><A NAME="71"></A> *    title = {Synthetic Minority Over-sampling Technique},
<FONT ID="LN">72  </FONT><A NAME="72"></A> *    volume = {16},
<FONT ID="LN">73  </FONT><A NAME="73"></A> *    year = {2002}
<FONT ID="LN">74  </FONT><A NAME="74"></A> * }
<FONT ID="LN">75  </FONT><A NAME="75"></A> * &lt;/pre&gt;
<FONT ID="LN">76  </FONT><A NAME="76"></A> * &lt;p/&gt;
<FONT ID="LN">77  </FONT><A NAME="77"></A> &lt;!-- technical-bibtex-end --&gt;
<FONT ID="LN">78  </FONT><A NAME="78"></A> * 
<FONT ID="LN">79  </FONT><A NAME="79"></A> &lt;!-- options-start --&gt;
<FONT ID="LN">80  </FONT><A NAME="80"></A> * Valid options are: &lt;p/&gt;
<FONT ID="LN">81  </FONT><A NAME="81"></A> * 
<FONT ID="LN">82  </FONT><A NAME="82"></A> * &lt;pre&gt; -S &amp;lt;num&amp;gt;
<FONT ID="LN">83  </FONT><A NAME="83"></A> *  Specifies the random number seed
<FONT ID="LN">84  </FONT><A NAME="84"></A> *  (default 1)&lt;/pre&gt;
<FONT ID="LN">85  </FONT><A NAME="85"></A> * 
<FONT ID="LN">86  </FONT><A NAME="86"></A> * &lt;pre&gt; -P &amp;lt;percentage&amp;gt;
<FONT ID="LN">87  </FONT><A NAME="87"></A> *  Specifies percentage of SMOTE instances to create.
<FONT ID="LN">88  </FONT><A NAME="88"></A> *  (default 100.0)
<FONT ID="LN">89  </FONT><A NAME="89"></A> * &lt;/pre&gt;
<FONT ID="LN">90  </FONT><A NAME="90"></A> * 
<FONT ID="LN">91  </FONT><A NAME="91"></A> * &lt;pre&gt; -K &amp;lt;nearest-neighbors&amp;gt;
<FONT ID="LN">92  </FONT><A NAME="92"></A> *  Specifies the number of nearest neighbors to use.
<FONT ID="LN">93  </FONT><A NAME="93"></A> *  (default 5)
<FONT ID="LN">94  </FONT><A NAME="94"></A> * &lt;/pre&gt;
<FONT ID="LN">95  </FONT><A NAME="95"></A> * 
<FONT ID="LN">96  </FONT><A NAME="96"></A> * &lt;pre&gt; -C &amp;lt;value-index&amp;gt;
<FONT ID="LN">97  </FONT><A NAME="97"></A> *  Specifies the index of the nominal class value to SMOTE
<FONT ID="LN">98  </FONT><A NAME="98"></A> *  (default 0: auto-detect non-empty minority class))
<FONT ID="LN">99  </FONT><A NAME="99"></A> * &lt;/pre&gt;
<FONT ID="LN">100 </FONT><A NAME="100"></A> * 
<FONT ID="LN">101 </FONT><A NAME="101"></A> &lt;!-- options-end --&gt;
<FONT ID="LN">102 </FONT><A NAME="102"></A> *  
<FONT ID="LN">103 </FONT><A NAME="103"></A> * @author Ryan Lichtenwalter (rlichtenwalter@gmail.com)
<FONT ID="LN">104 </FONT><A NAME="104"></A> * @version $Revision: 5987 $
<FONT ID="LN">105 </FONT><A NAME="105"></A> */</FONT>
<FONT ID="LN">106 </FONT><A NAME="106"></A><FONT ID="Public">public</FONT> <FONT ID="Class">class</FONT> SMOTE
<FONT ID="LN">107 </FONT><A NAME="107"></A>  <FONT ID="Extends">extends</FONT> <A HREF="../../../../weka/filters/Filter.java.html">Filter</A> 
<FONT ID="LN">108 </FONT><A NAME="108"></A>  <FONT ID="Implements">implements</FONT> <A HREF="../../../../weka/filters/SupervisedFilter.java.html">SupervisedFilter</A>, <A HREF="../../../../weka/core/OptionHandler.java.html">OptionHandler</A>, <A HREF="../../../../weka/core/TechnicalInformationHandler.java.html">TechnicalInformationHandler</A> {
<FONT ID="LN">109 </FONT><A NAME="109"></A>
<FONT ID="LN">110 </FONT><A NAME="110"></A>  <FONT ID="FormalComment">/** for serialization. */</FONT>
<FONT ID="LN">111 </FONT><A NAME="111"></A>  <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> <FONT ID="Long">long</FONT> serialVersionUID = -<FONT ID="IntegerLiteral">1653880819059250364L</FONT>;
<FONT ID="LN">112 </FONT><A NAME="112"></A>
<FONT ID="LN">113 </FONT><A NAME="113"></A>  <FONT ID="FormalComment">/** the number of neighbors to use. */</FONT>
<FONT ID="LN">114 </FONT><A NAME="114"></A>  <FONT ID="Protected">protected</FONT> <FONT ID="Int">int</FONT> m_NearestNeighbors = <FONT ID="IntegerLiteral">5</FONT>;
<FONT ID="LN">115 </FONT><A NAME="115"></A>  
<FONT ID="LN">116 </FONT><A NAME="116"></A>  <FONT ID="FormalComment">/** the random seed to use. */</FONT>
<FONT ID="LN">117 </FONT><A NAME="117"></A>  <FONT ID="Protected">protected</FONT> <FONT ID="Int">int</FONT> m_RandomSeed = <FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">118 </FONT><A NAME="118"></A>  
<FONT ID="LN">119 </FONT><A NAME="119"></A>  <FONT ID="FormalComment">/** the percentage of SMOTE instances to create. */</FONT>
<FONT ID="LN">120 </FONT><A NAME="120"></A>  <FONT ID="Protected">protected</FONT> <FONT ID="Double">double</FONT> m_Percentage = <FONT ID="FloatPointLiteral">100.0</FONT>;
<FONT ID="LN">121 </FONT><A NAME="121"></A>  
<FONT ID="LN">122 </FONT><A NAME="122"></A>  <FONT ID="FormalComment">/** the index of the class value. */</FONT>
<FONT ID="LN">123 </FONT><A NAME="123"></A>  <FONT ID="Protected">protected</FONT> String m_ClassValueIndex = <FONT ID="StringLiteral">"0"</FONT>;
<FONT ID="LN">124 </FONT><A NAME="124"></A>  
<FONT ID="LN">125 </FONT><A NAME="125"></A>  <FONT ID="FormalComment">/** whether to detect the minority class automatically. */</FONT>
<FONT ID="LN">126 </FONT><A NAME="126"></A>  <FONT ID="Protected">protected</FONT> <FONT ID="Boolean">boolean</FONT> m_DetectMinorityClass = <FONT ID="True">true</FONT>;
<FONT ID="LN">127 </FONT><A NAME="127"></A>
<FONT ID="LN">128 </FONT><A NAME="128"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">129 </FONT><A NAME="129"></A>   * Returns a string describing this classifier.
<FONT ID="LN">130 </FONT><A NAME="130"></A>   * 
<FONT ID="LN">131 </FONT><A NAME="131"></A>   * @return        a description of the classifier suitable for
<FONT ID="LN">132 </FONT><A NAME="132"></A>   *            displaying in the explorer/experimenter gui
<FONT ID="LN">133 </FONT><A NAME="133"></A>   */</FONT>
<FONT ID="LN">134 </FONT><A NAME="134"></A>  <FONT ID="Public">public</FONT> String globalInfo() {
<FONT ID="LN">135 </FONT><A NAME="135"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"Resamples a dataset by applying the Synthetic Minority Oversampling TEchnique (SMOTE)."</FONT> +
<FONT ID="LN">136 </FONT><A NAME="136"></A>    <FONT ID="StringLiteral">" The original dataset must fit entirely in memory."</FONT> +
<FONT ID="LN">137 </FONT><A NAME="137"></A>    <FONT ID="StringLiteral">" The amount of SMOTE and number of nearest neighbors may be specified."</FONT> +
<FONT ID="LN">138 </FONT><A NAME="138"></A>    <FONT ID="StringLiteral">" For more information, see \n\n"</FONT> 
<FONT ID="LN">139 </FONT><A NAME="139"></A>    + getTechnicalInformation().toString();
<FONT ID="LN">140 </FONT><A NAME="140"></A>  }
<FONT ID="LN">141 </FONT><A NAME="141"></A>
<FONT ID="LN">142 </FONT><A NAME="142"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">143 </FONT><A NAME="143"></A>   * Returns an instance of a TechnicalInformation object, containing 
<FONT ID="LN">144 </FONT><A NAME="144"></A>   * detailed information about the technical background of this class,
<FONT ID="LN">145 </FONT><A NAME="145"></A>   * e.g., paper reference or book this class is based on.
<FONT ID="LN">146 </FONT><A NAME="146"></A>   * 
<FONT ID="LN">147 </FONT><A NAME="147"></A>   * @return        the technical information about this class
<FONT ID="LN">148 </FONT><A NAME="148"></A>   */</FONT>
<FONT ID="LN">149 </FONT><A NAME="149"></A>  <FONT ID="Public">public</FONT> <A HREF="../../../../weka/core/TechnicalInformation.java.html">TechnicalInformation</A> getTechnicalInformation() {
<FONT ID="LN">150 </FONT><A NAME="150"></A>    <A HREF="../../../../weka/core/TechnicalInformation.java.html">TechnicalInformation</A> result = <FONT ID="New">new</FONT> <A HREF="../../../../weka/core/TechnicalInformation.java.html">TechnicalInformation</A>(Type.ARTICLE);
<FONT ID="LN">151 </FONT><A NAME="151"></A>
<FONT ID="LN">152 </FONT><A NAME="152"></A>    result.setValue(Field.AUTHOR, <FONT ID="StringLiteral">"Nitesh V. Chawla et. al."</FONT>);
<FONT ID="LN">153 </FONT><A NAME="153"></A>    result.setValue(Field.TITLE, <FONT ID="StringLiteral">"Synthetic Minority Over-sampling Technique"</FONT>);
<FONT ID="LN">154 </FONT><A NAME="154"></A>    result.setValue(Field.JOURNAL, <FONT ID="StringLiteral">"Journal of Artificial Intelligence Research"</FONT>);
<FONT ID="LN">155 </FONT><A NAME="155"></A>    result.setValue(Field.YEAR, <FONT ID="StringLiteral">"2002"</FONT>);
<FONT ID="LN">156 </FONT><A NAME="156"></A>    result.setValue(Field.VOLUME, <FONT ID="StringLiteral">"16"</FONT>);
<FONT ID="LN">157 </FONT><A NAME="157"></A>    result.setValue(Field.PAGES, <FONT ID="StringLiteral">"321-357"</FONT>);
<FONT ID="LN">158 </FONT><A NAME="158"></A>
<FONT ID="LN">159 </FONT><A NAME="159"></A>    <FONT ID="Return">return</FONT> result;
<FONT ID="LN">160 </FONT><A NAME="160"></A>  }
<FONT ID="LN">161 </FONT><A NAME="161"></A>
<FONT ID="LN">162 </FONT><A NAME="162"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">163 </FONT><A NAME="163"></A>   * Returns the revision string.
<FONT ID="LN">164 </FONT><A NAME="164"></A>   * 
<FONT ID="LN">165 </FONT><A NAME="165"></A>   * @return        the revision
<FONT ID="LN">166 </FONT><A NAME="166"></A>   */</FONT>
<FONT ID="LN">167 </FONT><A NAME="167"></A>  <FONT ID="Public">public</FONT> String getRevision() {
<FONT ID="LN">168 </FONT><A NAME="168"></A>    <FONT ID="Return">return</FONT> RevisionUtils.extract(<FONT ID="StringLiteral">"$Revision: 5987 $"</FONT>);
<FONT ID="LN">169 </FONT><A NAME="169"></A>  }
<FONT ID="LN">170 </FONT><A NAME="170"></A>
<FONT ID="LN">171 </FONT><A NAME="171"></A>  <FONT ID="FormalComment">/** 
<FONT ID="LN">172 </FONT><A NAME="172"></A>   * Returns the Capabilities of this filter.
<FONT ID="LN">173 </FONT><A NAME="173"></A>   *
<FONT ID="LN">174 </FONT><A NAME="174"></A>   * @return            the capabilities of this object
<FONT ID="LN">175 </FONT><A NAME="175"></A>   * @see               Capabilities
<FONT ID="LN">176 </FONT><A NAME="176"></A>   */</FONT>
<FONT ID="LN">177 </FONT><A NAME="177"></A>  <FONT ID="Public">public</FONT> <A HREF="../../../../weka/core/Capabilities.java.html">Capabilities</A> getCapabilities() {
<FONT ID="LN">178 </FONT><A NAME="178"></A>    <A HREF="../../../../weka/core/Capabilities.java.html">Capabilities</A> result = <FONT ID="Super">super</FONT>.getCapabilities();
<FONT ID="LN">179 </FONT><A NAME="179"></A>    result.disableAll();
<FONT ID="LN">180 </FONT><A NAME="180"></A>
<FONT ID="LN">181 </FONT><A NAME="181"></A>    <FONT ID="SingleLineComment">// attributes
<FONT ID="LN">182 </FONT><A NAME="182"></A></FONT>    result.enableAllAttributes();
<FONT ID="LN">183 </FONT><A NAME="183"></A>    result.enable(Capability.MISSING_VALUES);
<FONT ID="LN">184 </FONT><A NAME="184"></A>
<FONT ID="LN">185 </FONT><A NAME="185"></A>    <FONT ID="SingleLineComment">// class
<FONT ID="LN">186 </FONT><A NAME="186"></A></FONT>    result.enable(Capability.NOMINAL_CLASS);
<FONT ID="LN">187 </FONT><A NAME="187"></A>    result.enable(Capability.MISSING_CLASS_VALUES);
<FONT ID="LN">188 </FONT><A NAME="188"></A>
<FONT ID="LN">189 </FONT><A NAME="189"></A>    <FONT ID="Return">return</FONT> result;
<FONT ID="LN">190 </FONT><A NAME="190"></A>  }
<FONT ID="LN">191 </FONT><A NAME="191"></A>
<FONT ID="LN">192 </FONT><A NAME="192"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">193 </FONT><A NAME="193"></A>   * Returns an enumeration describing the available options.
<FONT ID="LN">194 </FONT><A NAME="194"></A>   *
<FONT ID="LN">195 </FONT><A NAME="195"></A>   * @return an enumeration of all the available options.
<FONT ID="LN">196 </FONT><A NAME="196"></A>   */</FONT>
<FONT ID="LN">197 </FONT><A NAME="197"></A>  <FONT ID="Public">public</FONT> Enumeration listOptions() {
<FONT ID="LN">198 </FONT><A NAME="198"></A>    Vector newVector = <FONT ID="New">new</FONT> Vector();
<FONT ID="LN">199 </FONT><A NAME="199"></A>    
<FONT ID="LN">200 </FONT><A NAME="200"></A>    newVector.addElement(<FONT ID="New">new</FONT> <A HREF="../../../../weka/core/Option.java.html">Option</A>(
<FONT ID="LN">201 </FONT><A NAME="201"></A>    <FONT ID="StringLiteral">"\tSpecifies the random number seed\n"</FONT>
<FONT ID="LN">202 </FONT><A NAME="202"></A>    + <FONT ID="StringLiteral">"\t(default 1)"</FONT>,
<FONT ID="LN">203 </FONT><A NAME="203"></A>    <FONT ID="StringLiteral">"S"</FONT>, <FONT ID="IntegerLiteral">1</FONT>, <FONT ID="StringLiteral">"-S &lt;num&gt;"</FONT>));
<FONT ID="LN">204 </FONT><A NAME="204"></A>    
<FONT ID="LN">205 </FONT><A NAME="205"></A>    newVector.addElement(<FONT ID="New">new</FONT> <A HREF="../../../../weka/core/Option.java.html">Option</A>(
<FONT ID="LN">206 </FONT><A NAME="206"></A>    <FONT ID="StringLiteral">"\tSpecifies percentage of SMOTE instances to create.\n"</FONT>
<FONT ID="LN">207 </FONT><A NAME="207"></A>    + <FONT ID="StringLiteral">"\t(default 100.0)\n"</FONT>,
<FONT ID="LN">208 </FONT><A NAME="208"></A>    <FONT ID="StringLiteral">"P"</FONT>, <FONT ID="IntegerLiteral">1</FONT>, <FONT ID="StringLiteral">"-P &lt;percentage&gt;"</FONT>));
<FONT ID="LN">209 </FONT><A NAME="209"></A>    
<FONT ID="LN">210 </FONT><A NAME="210"></A>    newVector.addElement(<FONT ID="New">new</FONT> <A HREF="../../../../weka/core/Option.java.html">Option</A>(
<FONT ID="LN">211 </FONT><A NAME="211"></A>    <FONT ID="StringLiteral">"\tSpecifies the number of nearest neighbors to use.\n"</FONT>
<FONT ID="LN">212 </FONT><A NAME="212"></A>    + <FONT ID="StringLiteral">"\t(default 5)\n"</FONT>,
<FONT ID="LN">213 </FONT><A NAME="213"></A>    <FONT ID="StringLiteral">"K"</FONT>, <FONT ID="IntegerLiteral">1</FONT>, <FONT ID="StringLiteral">"-K &lt;nearest-neighbors&gt;"</FONT>));
<FONT ID="LN">214 </FONT><A NAME="214"></A>    
<FONT ID="LN">215 </FONT><A NAME="215"></A>    newVector.addElement(<FONT ID="New">new</FONT> <A HREF="../../../../weka/core/Option.java.html">Option</A>(
<FONT ID="LN">216 </FONT><A NAME="216"></A>    <FONT ID="StringLiteral">"\tSpecifies the index of the nominal class value to SMOTE\n"</FONT>
<FONT ID="LN">217 </FONT><A NAME="217"></A>    +<FONT ID="StringLiteral">"\t(default 0: auto-detect non-empty minority class))\n"</FONT>,
<FONT ID="LN">218 </FONT><A NAME="218"></A>    <FONT ID="StringLiteral">"C"</FONT>, <FONT ID="IntegerLiteral">1</FONT>, <FONT ID="StringLiteral">"-C &lt;value-index&gt;"</FONT>));
<FONT ID="LN">219 </FONT><A NAME="219"></A>
<FONT ID="LN">220 </FONT><A NAME="220"></A>    <FONT ID="Return">return</FONT> newVector.elements();
<FONT ID="LN">221 </FONT><A NAME="221"></A>  }
<FONT ID="LN">222 </FONT><A NAME="222"></A>
<FONT ID="LN">223 </FONT><A NAME="223"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">224 </FONT><A NAME="224"></A>   * Parses a given list of options.
<FONT ID="LN">225 </FONT><A NAME="225"></A>   * 
<FONT ID="LN">226 </FONT><A NAME="226"></A>   &lt;!-- options-start --&gt;
<FONT ID="LN">227 </FONT><A NAME="227"></A>   * Valid options are: &lt;p/&gt;
<FONT ID="LN">228 </FONT><A NAME="228"></A>   * 
<FONT ID="LN">229 </FONT><A NAME="229"></A>   * &lt;pre&gt; -S &amp;lt;num&amp;gt;
<FONT ID="LN">230 </FONT><A NAME="230"></A>   *  Specifies the random number seed
<FONT ID="LN">231 </FONT><A NAME="231"></A>   *  (default 1)&lt;/pre&gt;
<FONT ID="LN">232 </FONT><A NAME="232"></A>   * 
<FONT ID="LN">233 </FONT><A NAME="233"></A>   * &lt;pre&gt; -P &amp;lt;percentage&amp;gt;
<FONT ID="LN">234 </FONT><A NAME="234"></A>   *  Specifies percentage of SMOTE instances to create.
<FONT ID="LN">235 </FONT><A NAME="235"></A>   *  (default 100.0)
<FONT ID="LN">236 </FONT><A NAME="236"></A>   * &lt;/pre&gt;
<FONT ID="LN">237 </FONT><A NAME="237"></A>   * 
<FONT ID="LN">238 </FONT><A NAME="238"></A>   * &lt;pre&gt; -K &amp;lt;nearest-neighbors&amp;gt;
<FONT ID="LN">239 </FONT><A NAME="239"></A>   *  Specifies the number of nearest neighbors to use.
<FONT ID="LN">240 </FONT><A NAME="240"></A>   *  (default 5)
<FONT ID="LN">241 </FONT><A NAME="241"></A>   * &lt;/pre&gt;
<FONT ID="LN">242 </FONT><A NAME="242"></A>   * 
<FONT ID="LN">243 </FONT><A NAME="243"></A>   * &lt;pre&gt; -C &amp;lt;value-index&amp;gt;
<FONT ID="LN">244 </FONT><A NAME="244"></A>   *  Specifies the index of the nominal class value to SMOTE
<FONT ID="LN">245 </FONT><A NAME="245"></A>   *  (default 0: auto-detect non-empty minority class))
<FONT ID="LN">246 </FONT><A NAME="246"></A>   * &lt;/pre&gt;
<FONT ID="LN">247 </FONT><A NAME="247"></A>   * 
<FONT ID="LN">248 </FONT><A NAME="248"></A>   &lt;!-- options-end --&gt;
<FONT ID="LN">249 </FONT><A NAME="249"></A>   *
<FONT ID="LN">250 </FONT><A NAME="250"></A>   * @param options the list of options as an array of strings
<FONT ID="LN">251 </FONT><A NAME="251"></A>   * @throws Exception if an option is not supported
<FONT ID="LN">252 </FONT><A NAME="252"></A>   */</FONT>
<FONT ID="LN">253 </FONT><A NAME="253"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setOptions(String[] options) <FONT ID="Throws">throws</FONT> Exception {
<FONT ID="LN">254 </FONT><A NAME="254"></A>    String seedStr = Utils.getOption(<FONT ID="CharacerLiteral">'S'</FONT>, options);
<FONT ID="LN">255 </FONT><A NAME="255"></A>    <FONT ID="If">if</FONT> (seedStr.length() != <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">256 </FONT><A NAME="256"></A>      setRandomSeed(Integer.parseInt(seedStr));
<FONT ID="LN">257 </FONT><A NAME="257"></A>    } <FONT ID="Else">else</FONT> {
<FONT ID="LN">258 </FONT><A NAME="258"></A>      setRandomSeed(<FONT ID="IntegerLiteral">1</FONT>);
<FONT ID="LN">259 </FONT><A NAME="259"></A>    }
<FONT ID="LN">260 </FONT><A NAME="260"></A>
<FONT ID="LN">261 </FONT><A NAME="261"></A>    String percentageStr = Utils.getOption(<FONT ID="CharacerLiteral">'P'</FONT>, options);
<FONT ID="LN">262 </FONT><A NAME="262"></A>    <FONT ID="If">if</FONT> (percentageStr.length() != <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">263 </FONT><A NAME="263"></A>      setPercentage(<FONT ID="New">new</FONT> Double(percentageStr).doubleValue());
<FONT ID="LN">264 </FONT><A NAME="264"></A>    } <FONT ID="Else">else</FONT> {
<FONT ID="LN">265 </FONT><A NAME="265"></A>      setPercentage(<FONT ID="FloatPointLiteral">100.0</FONT>);
<FONT ID="LN">266 </FONT><A NAME="266"></A>    }
<FONT ID="LN">267 </FONT><A NAME="267"></A>
<FONT ID="LN">268 </FONT><A NAME="268"></A>    String nnStr = Utils.getOption(<FONT ID="CharacerLiteral">'K'</FONT>, options);
<FONT ID="LN">269 </FONT><A NAME="269"></A>    <FONT ID="If">if</FONT> (nnStr.length() != <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">270 </FONT><A NAME="270"></A>      setNearestNeighbors(Integer.parseInt(nnStr));
<FONT ID="LN">271 </FONT><A NAME="271"></A>    } <FONT ID="Else">else</FONT> {
<FONT ID="LN">272 </FONT><A NAME="272"></A>      setNearestNeighbors(<FONT ID="IntegerLiteral">5</FONT>);
<FONT ID="LN">273 </FONT><A NAME="273"></A>    }
<FONT ID="LN">274 </FONT><A NAME="274"></A>
<FONT ID="LN">275 </FONT><A NAME="275"></A>    String classValueIndexStr = Utils.getOption( <FONT ID="CharacerLiteral">'C'</FONT>, options);
<FONT ID="LN">276 </FONT><A NAME="276"></A>    <FONT ID="If">if</FONT> (classValueIndexStr.length() != <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">277 </FONT><A NAME="277"></A>      setClassValue(classValueIndexStr);
<FONT ID="LN">278 </FONT><A NAME="278"></A>    } <FONT ID="Else">else</FONT> {
<FONT ID="LN">279 </FONT><A NAME="279"></A>      m_DetectMinorityClass = <FONT ID="True">true</FONT>;
<FONT ID="LN">280 </FONT><A NAME="280"></A>    }
<FONT ID="LN">281 </FONT><A NAME="281"></A>  }
<FONT ID="LN">282 </FONT><A NAME="282"></A>
<FONT ID="LN">283 </FONT><A NAME="283"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">284 </FONT><A NAME="284"></A>   * Gets the current settings of the filter.
<FONT ID="LN">285 </FONT><A NAME="285"></A>   *
<FONT ID="LN">286 </FONT><A NAME="286"></A>   * @return an array   of strings suitable for passing to setOptions
<FONT ID="LN">287 </FONT><A NAME="287"></A>   */</FONT>
<FONT ID="LN">288 </FONT><A NAME="288"></A>  <FONT ID="Public">public</FONT> String[] getOptions() {
<FONT ID="LN">289 </FONT><A NAME="289"></A>    Vector&lt;String&gt;  result;
<FONT ID="LN">290 </FONT><A NAME="290"></A>    
<FONT ID="LN">291 </FONT><A NAME="291"></A>    result = <FONT ID="New">new</FONT> Vector&lt;String&gt;();
<FONT ID="LN">292 </FONT><A NAME="292"></A>    
<FONT ID="LN">293 </FONT><A NAME="293"></A>    result.add(<FONT ID="StringLiteral">"-C"</FONT>);
<FONT ID="LN">294 </FONT><A NAME="294"></A>    result.add(getClassValue());
<FONT ID="LN">295 </FONT><A NAME="295"></A>    
<FONT ID="LN">296 </FONT><A NAME="296"></A>    result.add(<FONT ID="StringLiteral">"-K"</FONT>);
<FONT ID="LN">297 </FONT><A NAME="297"></A>    result.add(<FONT ID="StringLiteral">""</FONT> + getNearestNeighbors());
<FONT ID="LN">298 </FONT><A NAME="298"></A>    
<FONT ID="LN">299 </FONT><A NAME="299"></A>    result.add(<FONT ID="StringLiteral">"-P"</FONT>);
<FONT ID="LN">300 </FONT><A NAME="300"></A>    result.add(<FONT ID="StringLiteral">""</FONT> + getPercentage());
<FONT ID="LN">301 </FONT><A NAME="301"></A>    
<FONT ID="LN">302 </FONT><A NAME="302"></A>    result.add(<FONT ID="StringLiteral">"-S"</FONT>);
<FONT ID="LN">303 </FONT><A NAME="303"></A>    result.add(<FONT ID="StringLiteral">""</FONT> + getRandomSeed());
<FONT ID="LN">304 </FONT><A NAME="304"></A>    
<FONT ID="LN">305 </FONT><A NAME="305"></A>    <FONT ID="Return">return</FONT> result.toArray(<FONT ID="New">new</FONT> String[result.size()]);
<FONT ID="LN">306 </FONT><A NAME="306"></A>  }
<FONT ID="LN">307 </FONT><A NAME="307"></A>
<FONT ID="LN">308 </FONT><A NAME="308"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">309 </FONT><A NAME="309"></A>   * Returns the tip text for this property.
<FONT ID="LN">310 </FONT><A NAME="310"></A>   * 
<FONT ID="LN">311 </FONT><A NAME="311"></A>   * @return        tip text for this property suitable for
<FONT ID="LN">312 </FONT><A NAME="312"></A>   *            displaying in the explorer/experimenter gui
<FONT ID="LN">313 </FONT><A NAME="313"></A>   */</FONT>
<FONT ID="LN">314 </FONT><A NAME="314"></A>  <FONT ID="Public">public</FONT> String randomSeedTipText() {
<FONT ID="LN">315 </FONT><A NAME="315"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"The seed used for random sampling."</FONT>;
<FONT ID="LN">316 </FONT><A NAME="316"></A>  }
<FONT ID="LN">317 </FONT><A NAME="317"></A>
<FONT ID="LN">318 </FONT><A NAME="318"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">319 </FONT><A NAME="319"></A>   * Gets the random number seed.
<FONT ID="LN">320 </FONT><A NAME="320"></A>   *
<FONT ID="LN">321 </FONT><A NAME="321"></A>   * @return        the random number seed.
<FONT ID="LN">322 </FONT><A NAME="322"></A>   */</FONT>
<FONT ID="LN">323 </FONT><A NAME="323"></A>  <FONT ID="Public">public</FONT> <FONT ID="Int">int</FONT> getRandomSeed() {
<FONT ID="LN">324 </FONT><A NAME="324"></A>    <FONT ID="Return">return</FONT> m_RandomSeed;
<FONT ID="LN">325 </FONT><A NAME="325"></A>  }
<FONT ID="LN">326 </FONT><A NAME="326"></A>
<FONT ID="LN">327 </FONT><A NAME="327"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">328 </FONT><A NAME="328"></A>   * Sets the random number seed.
<FONT ID="LN">329 </FONT><A NAME="329"></A>   *
<FONT ID="LN">330 </FONT><A NAME="330"></A>   * @param value   the new random number seed.
<FONT ID="LN">331 </FONT><A NAME="331"></A>   */</FONT>
<FONT ID="LN">332 </FONT><A NAME="332"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setRandomSeed(<FONT ID="Int">int</FONT> value) {
<FONT ID="LN">333 </FONT><A NAME="333"></A>    m_RandomSeed = value;
<FONT ID="LN">334 </FONT><A NAME="334"></A>  }
<FONT ID="LN">335 </FONT><A NAME="335"></A>
<FONT ID="LN">336 </FONT><A NAME="336"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">337 </FONT><A NAME="337"></A>   * Returns the tip text for this property.
<FONT ID="LN">338 </FONT><A NAME="338"></A>   * 
<FONT ID="LN">339 </FONT><A NAME="339"></A>   * @return        tip text for this property suitable for
<FONT ID="LN">340 </FONT><A NAME="340"></A>   *            displaying in the explorer/experimenter gui
<FONT ID="LN">341 </FONT><A NAME="341"></A>   */</FONT>
<FONT ID="LN">342 </FONT><A NAME="342"></A>  <FONT ID="Public">public</FONT> String percentageTipText() {
<FONT ID="LN">343 </FONT><A NAME="343"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"The percentage of SMOTE instances to create."</FONT>;
<FONT ID="LN">344 </FONT><A NAME="344"></A>  }
<FONT ID="LN">345 </FONT><A NAME="345"></A>
<FONT ID="LN">346 </FONT><A NAME="346"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">347 </FONT><A NAME="347"></A>   * Sets the percentage of SMOTE instances to create.
<FONT ID="LN">348 </FONT><A NAME="348"></A>   * 
<FONT ID="LN">349 </FONT><A NAME="349"></A>   * @param value   the percentage to use
<FONT ID="LN">350 </FONT><A NAME="350"></A>   */</FONT>
<FONT ID="LN">351 </FONT><A NAME="351"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setPercentage(<FONT ID="Double">double</FONT> value) {
<FONT ID="LN">352 </FONT><A NAME="352"></A>    <FONT ID="If">if</FONT> (value &gt;= <FONT ID="IntegerLiteral">0</FONT>)
<FONT ID="LN">353 </FONT><A NAME="353"></A>      m_Percentage = value;
<FONT ID="LN">354 </FONT><A NAME="354"></A>    <FONT ID="Else">else</FONT>
<FONT ID="LN">355 </FONT><A NAME="355"></A>      System.err.println(<FONT ID="StringLiteral">"Percentage must be &gt;= 0!"</FONT>);
<FONT ID="LN">356 </FONT><A NAME="356"></A>  }
<FONT ID="LN">357 </FONT><A NAME="357"></A>
<FONT ID="LN">358 </FONT><A NAME="358"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">359 </FONT><A NAME="359"></A>   * Gets the percentage of SMOTE instances to create.
<FONT ID="LN">360 </FONT><A NAME="360"></A>   * 
<FONT ID="LN">361 </FONT><A NAME="361"></A>   * @return        the percentage of SMOTE instances to create
<FONT ID="LN">362 </FONT><A NAME="362"></A>   */</FONT>
<FONT ID="LN">363 </FONT><A NAME="363"></A>  <FONT ID="Public">public</FONT> <FONT ID="Double">double</FONT> getPercentage() {
<FONT ID="LN">364 </FONT><A NAME="364"></A>    <FONT ID="Return">return</FONT> m_Percentage;
<FONT ID="LN">365 </FONT><A NAME="365"></A>  }
<FONT ID="LN">366 </FONT><A NAME="366"></A>
<FONT ID="LN">367 </FONT><A NAME="367"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">368 </FONT><A NAME="368"></A>   * Returns the tip text for this property.
<FONT ID="LN">369 </FONT><A NAME="369"></A>   * 
<FONT ID="LN">370 </FONT><A NAME="370"></A>   * @return        tip text for this property suitable for
<FONT ID="LN">371 </FONT><A NAME="371"></A>   *            displaying in the explorer/experimenter gui
<FONT ID="LN">372 </FONT><A NAME="372"></A>   */</FONT>
<FONT ID="LN">373 </FONT><A NAME="373"></A>  <FONT ID="Public">public</FONT> String nearestNeighborsTipText() {
<FONT ID="LN">374 </FONT><A NAME="374"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"The number of nearest neighbors to use."</FONT>;
<FONT ID="LN">375 </FONT><A NAME="375"></A>  }
<FONT ID="LN">376 </FONT><A NAME="376"></A>
<FONT ID="LN">377 </FONT><A NAME="377"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">378 </FONT><A NAME="378"></A>   * Sets the number of nearest neighbors to use.
<FONT ID="LN">379 </FONT><A NAME="379"></A>   * 
<FONT ID="LN">380 </FONT><A NAME="380"></A>   * @param value   the number of nearest neighbors to use
<FONT ID="LN">381 </FONT><A NAME="381"></A>   */</FONT>
<FONT ID="LN">382 </FONT><A NAME="382"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setNearestNeighbors(<FONT ID="Int">int</FONT> value) {
<FONT ID="LN">383 </FONT><A NAME="383"></A>    <FONT ID="If">if</FONT> (value &gt;= <FONT ID="IntegerLiteral">1</FONT>)
<FONT ID="LN">384 </FONT><A NAME="384"></A>      m_NearestNeighbors = value;
<FONT ID="LN">385 </FONT><A NAME="385"></A>    <FONT ID="Else">else</FONT>
<FONT ID="LN">386 </FONT><A NAME="386"></A>      System.err.println(<FONT ID="StringLiteral">"At least 1 neighbor necessary!"</FONT>);
<FONT ID="LN">387 </FONT><A NAME="387"></A>  }
<FONT ID="LN">388 </FONT><A NAME="388"></A>
<FONT ID="LN">389 </FONT><A NAME="389"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">390 </FONT><A NAME="390"></A>   * Gets the number of nearest neighbors to use.
<FONT ID="LN">391 </FONT><A NAME="391"></A>   * 
<FONT ID="LN">392 </FONT><A NAME="392"></A>   * @return        the number of nearest neighbors to use
<FONT ID="LN">393 </FONT><A NAME="393"></A>   */</FONT>
<FONT ID="LN">394 </FONT><A NAME="394"></A>  <FONT ID="Public">public</FONT> <FONT ID="Int">int</FONT> getNearestNeighbors() {
<FONT ID="LN">395 </FONT><A NAME="395"></A>    <FONT ID="Return">return</FONT> m_NearestNeighbors;
<FONT ID="LN">396 </FONT><A NAME="396"></A>  }
<FONT ID="LN">397 </FONT><A NAME="397"></A>
<FONT ID="LN">398 </FONT><A NAME="398"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">399 </FONT><A NAME="399"></A>   * Returns the tip text for this property.
<FONT ID="LN">400 </FONT><A NAME="400"></A>   * 
<FONT ID="LN">401 </FONT><A NAME="401"></A>   * @return        tip text for this property suitable for
<FONT ID="LN">402 </FONT><A NAME="402"></A>   *            displaying in the explorer/experimenter gui
<FONT ID="LN">403 </FONT><A NAME="403"></A>   */</FONT>
<FONT ID="LN">404 </FONT><A NAME="404"></A>  <FONT ID="Public">public</FONT> String classValueTipText() {
<FONT ID="LN">405 </FONT><A NAME="405"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"The index of the class value to which SMOTE should be applied. "</FONT> +
<FONT ID="LN">406 </FONT><A NAME="406"></A>    <FONT ID="StringLiteral">"Use a value of 0 to auto-detect the non-empty minority class."</FONT>;
<FONT ID="LN">407 </FONT><A NAME="407"></A>  }
<FONT ID="LN">408 </FONT><A NAME="408"></A>
<FONT ID="LN">409 </FONT><A NAME="409"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">410 </FONT><A NAME="410"></A>   * Sets the index of the class value to which SMOTE should be applied.
<FONT ID="LN">411 </FONT><A NAME="411"></A>   * 
<FONT ID="LN">412 </FONT><A NAME="412"></A>   * @param value   the class value index
<FONT ID="LN">413 </FONT><A NAME="413"></A>   */</FONT>
<FONT ID="LN">414 </FONT><A NAME="414"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setClassValue(String value) {
<FONT ID="LN">415 </FONT><A NAME="415"></A>    m_ClassValueIndex = value;
<FONT ID="LN">416 </FONT><A NAME="416"></A>    <FONT ID="If">if</FONT> (m_ClassValueIndex.equals(<FONT ID="StringLiteral">"0"</FONT>)) {
<FONT ID="LN">417 </FONT><A NAME="417"></A>      m_DetectMinorityClass = <FONT ID="True">true</FONT>;
<FONT ID="LN">418 </FONT><A NAME="418"></A>    } <FONT ID="Else">else</FONT> {
<FONT ID="LN">419 </FONT><A NAME="419"></A>      m_DetectMinorityClass = <FONT ID="False">false</FONT>;
<FONT ID="LN">420 </FONT><A NAME="420"></A>    }
<FONT ID="LN">421 </FONT><A NAME="421"></A>  }
<FONT ID="LN">422 </FONT><A NAME="422"></A>
<FONT ID="LN">423 </FONT><A NAME="423"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">424 </FONT><A NAME="424"></A>   * Gets the index of the class value to which SMOTE should be applied.
<FONT ID="LN">425 </FONT><A NAME="425"></A>   * 
<FONT ID="LN">426 </FONT><A NAME="426"></A>   * @return        the index of the clas value to which SMOTE should be applied
<FONT ID="LN">427 </FONT><A NAME="427"></A>   */</FONT>
<FONT ID="LN">428 </FONT><A NAME="428"></A>  <FONT ID="Public">public</FONT> String getClassValue() {
<FONT ID="LN">429 </FONT><A NAME="429"></A>    <FONT ID="Return">return</FONT> m_ClassValueIndex;
<FONT ID="LN">430 </FONT><A NAME="430"></A>  }
<FONT ID="LN">431 </FONT><A NAME="431"></A>
<FONT ID="LN">432 </FONT><A NAME="432"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">433 </FONT><A NAME="433"></A>   * Sets the format of the input instances.
<FONT ID="LN">434 </FONT><A NAME="434"></A>   *
<FONT ID="LN">435 </FONT><A NAME="435"></A>   * @param instanceInfo    an Instances object containing the input 
<FONT ID="LN">436 </FONT><A NAME="436"></A>   *                instance structure (any instances contained in 
<FONT ID="LN">437 </FONT><A NAME="437"></A>   *                the object are ignored - only the structure is required).
<FONT ID="LN">438 </FONT><A NAME="438"></A>   * @return            true if the outputFormat may be collected immediately
<FONT ID="LN">439 </FONT><A NAME="439"></A>   * @throws Exception      if the input format can't be set successfully
<FONT ID="LN">440 </FONT><A NAME="440"></A>   */</FONT>
<FONT ID="LN">441 </FONT><A NAME="441"></A>  <FONT ID="Public">public</FONT> <FONT ID="Boolean">boolean</FONT> setInputFormat(<A HREF="../../../../weka/core/Instances.java.html">Instances</A> instanceInfo) <FONT ID="Throws">throws</FONT> Exception {
<FONT ID="LN">442 </FONT><A NAME="442"></A>    <FONT ID="Super">super</FONT>.setInputFormat(instanceInfo);
<FONT ID="LN">443 </FONT><A NAME="443"></A>    <FONT ID="Super">super</FONT>.setOutputFormat(instanceInfo);
<FONT ID="LN">444 </FONT><A NAME="444"></A>    <FONT ID="Return">return</FONT> <FONT ID="True">true</FONT>;
<FONT ID="LN">445 </FONT><A NAME="445"></A>  }
<FONT ID="LN">446 </FONT><A NAME="446"></A>
<FONT ID="LN">447 </FONT><A NAME="447"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">448 </FONT><A NAME="448"></A>   * Input an instance for filtering. Filter requires all
<FONT ID="LN">449 </FONT><A NAME="449"></A>   * training instances be read before producing output.
<FONT ID="LN">450 </FONT><A NAME="450"></A>   *
<FONT ID="LN">451 </FONT><A NAME="451"></A>   * @param instance        the input instance
<FONT ID="LN">452 </FONT><A NAME="452"></A>   * @return            true if the filtered instance may now be
<FONT ID="LN">453 </FONT><A NAME="453"></A>   *                collected with output().
<FONT ID="LN">454 </FONT><A NAME="454"></A>   * @throws IllegalStateException if no input structure has been defined
<FONT ID="LN">455 </FONT><A NAME="455"></A>   */</FONT>
<FONT ID="LN">456 </FONT><A NAME="456"></A>  <FONT ID="Public">public</FONT> <FONT ID="Boolean">boolean</FONT> input(<A HREF="../../../../weka/core/Instance.java.html">Instance</A> instance) {
<FONT ID="LN">457 </FONT><A NAME="457"></A>    <FONT ID="If">if</FONT> (getInputFormat() == <FONT ID="Null">null</FONT>) {
<FONT ID="LN">458 </FONT><A NAME="458"></A>      <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalStateException(<FONT ID="StringLiteral">"No input instance format defined"</FONT>);
<FONT ID="LN">459 </FONT><A NAME="459"></A>    }
<FONT ID="LN">460 </FONT><A NAME="460"></A>    <FONT ID="If">if</FONT> (m_NewBatch) {
<FONT ID="LN">461 </FONT><A NAME="461"></A>      resetQueue();
<FONT ID="LN">462 </FONT><A NAME="462"></A>      m_NewBatch = <FONT ID="False">false</FONT>;
<FONT ID="LN">463 </FONT><A NAME="463"></A>    }
<FONT ID="LN">464 </FONT><A NAME="464"></A>    <FONT ID="If">if</FONT> (m_FirstBatchDone) {
<FONT ID="LN">465 </FONT><A NAME="465"></A>      push(instance);
<FONT ID="LN">466 </FONT><A NAME="466"></A>      <FONT ID="Return">return</FONT> <FONT ID="True">true</FONT>;
<FONT ID="LN">467 </FONT><A NAME="467"></A>    } <FONT ID="Else">else</FONT> {
<FONT ID="LN">468 </FONT><A NAME="468"></A>      bufferInput(instance);
<FONT ID="LN">469 </FONT><A NAME="469"></A>      <FONT ID="Return">return</FONT> <FONT ID="False">false</FONT>;
<FONT ID="LN">470 </FONT><A NAME="470"></A>    }
<FONT ID="LN">471 </FONT><A NAME="471"></A>  }
<FONT ID="LN">472 </FONT><A NAME="472"></A>
<FONT ID="LN">473 </FONT><A NAME="473"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">474 </FONT><A NAME="474"></A>   * Signify that this batch of input to the filter is finished. 
<FONT ID="LN">475 </FONT><A NAME="475"></A>   * If the filter requires all instances prior to filtering,
<FONT ID="LN">476 </FONT><A NAME="476"></A>   * output() may now be called to retrieve the filtered instances.
<FONT ID="LN">477 </FONT><A NAME="477"></A>   *
<FONT ID="LN">478 </FONT><A NAME="478"></A>   * @return        true if there are instances pending output
<FONT ID="LN">479 </FONT><A NAME="479"></A>   * @throws IllegalStateException if no input structure has been defined
<FONT ID="LN">480 </FONT><A NAME="480"></A>   * @throws Exception  if provided options cannot be executed 
<FONT ID="LN">481 </FONT><A NAME="481"></A>   *            on input instances
<FONT ID="LN">482 </FONT><A NAME="482"></A>   */</FONT>
<FONT ID="LN">483 </FONT><A NAME="483"></A>  <FONT ID="Public">public</FONT> <FONT ID="Boolean">boolean</FONT> batchFinished() <FONT ID="Throws">throws</FONT> Exception {
<FONT ID="LN">484 </FONT><A NAME="484"></A>    <FONT ID="If">if</FONT> (getInputFormat() == <FONT ID="Null">null</FONT>) {
<FONT ID="LN">485 </FONT><A NAME="485"></A>      <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalStateException(<FONT ID="StringLiteral">"No input instance format defined"</FONT>);
<FONT ID="LN">486 </FONT><A NAME="486"></A>    }
<FONT ID="LN">487 </FONT><A NAME="487"></A>
<FONT ID="LN">488 </FONT><A NAME="488"></A>    <FONT ID="If">if</FONT> (!m_FirstBatchDone) {
<FONT ID="LN">489 </FONT><A NAME="489"></A>      <FONT ID="SingleLineComment">// Do SMOTE, and clear the input instances.
<FONT ID="LN">490 </FONT><A NAME="490"></A></FONT>      doSMOTE();
<FONT ID="LN">491 </FONT><A NAME="491"></A>    }
<FONT ID="LN">492 </FONT><A NAME="492"></A>    flushInput();
<FONT ID="LN">493 </FONT><A NAME="493"></A>
<FONT ID="LN">494 </FONT><A NAME="494"></A>    m_NewBatch = <FONT ID="True">true</FONT>;
<FONT ID="LN">495 </FONT><A NAME="495"></A>    m_FirstBatchDone = <FONT ID="True">true</FONT>;
<FONT ID="LN">496 </FONT><A NAME="496"></A>    <FONT ID="Return">return</FONT> (numPendingOutput() != <FONT ID="IntegerLiteral">0</FONT>);
<FONT ID="LN">497 </FONT><A NAME="497"></A>  }
<FONT ID="LN">498 </FONT><A NAME="498"></A>
<FONT ID="LN">499 </FONT><A NAME="499"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">500 </FONT><A NAME="500"></A>   * The procedure implementing the SMOTE algorithm. The output
<FONT ID="LN">501 </FONT><A NAME="501"></A>   * instances are pushed onto the output queue for collection.
<FONT ID="LN">502 </FONT><A NAME="502"></A>   * 
<FONT ID="LN">503 </FONT><A NAME="503"></A>   * @throws Exception  if provided options cannot be executed 
<FONT ID="LN">504 </FONT><A NAME="504"></A>   *            on input instances
<FONT ID="LN">505 </FONT><A NAME="505"></A>   */</FONT>
<FONT ID="LN">506 </FONT><A NAME="506"></A>  <FONT ID="Protected">protected</FONT> <FONT ID="Void">void</FONT> doSMOTE() <FONT ID="Throws">throws</FONT> Exception {
<FONT ID="LN">507 </FONT><A NAME="507"></A>    <FONT ID="Int">int</FONT> minIndex = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">508 </FONT><A NAME="508"></A>    <FONT ID="Int">int</FONT> min = Integer.MAX_VALUE;
<FONT ID="LN">509 </FONT><A NAME="509"></A>    <FONT ID="If">if</FONT> (m_DetectMinorityClass) {
<FONT ID="LN">510 </FONT><A NAME="510"></A>      <FONT ID="SingleLineComment">// find minority class
<FONT ID="LN">511 </FONT><A NAME="511"></A></FONT>      <FONT ID="Int">int</FONT>[] classCounts = getInputFormat().attributeStats(getInputFormat().classIndex()).nominalCounts;
<FONT ID="LN">512 </FONT><A NAME="512"></A>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; classCounts.length; i++) {
<FONT ID="LN">513 </FONT><A NAME="513"></A>    <FONT ID="If">if</FONT> (classCounts[i] != <FONT ID="IntegerLiteral">0</FONT> &amp;&amp; classCounts[i] &lt; min) {
<FONT ID="LN">514 </FONT><A NAME="514"></A>      min = classCounts[i];
<FONT ID="LN">515 </FONT><A NAME="515"></A>      minIndex = i;
<FONT ID="LN">516 </FONT><A NAME="516"></A>    }
<FONT ID="LN">517 </FONT><A NAME="517"></A>      }
<FONT ID="LN">518 </FONT><A NAME="518"></A>    } <FONT ID="Else">else</FONT> {
<FONT ID="LN">519 </FONT><A NAME="519"></A>      String classVal = getClassValue();
<FONT ID="LN">520 </FONT><A NAME="520"></A>      <FONT ID="If">if</FONT> (classVal.equalsIgnoreCase(<FONT ID="StringLiteral">"first"</FONT>)) {
<FONT ID="LN">521 </FONT><A NAME="521"></A>    minIndex = <FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">522 </FONT><A NAME="522"></A>      } <FONT ID="Else">else</FONT> <FONT ID="If">if</FONT> (classVal.equalsIgnoreCase(<FONT ID="StringLiteral">"last"</FONT>)) {
<FONT ID="LN">523 </FONT><A NAME="523"></A>    minIndex = getInputFormat().numClasses();
<FONT ID="LN">524 </FONT><A NAME="524"></A>      } <FONT ID="Else">else</FONT> {
<FONT ID="LN">525 </FONT><A NAME="525"></A>    minIndex = Integer.parseInt(classVal);
<FONT ID="LN">526 </FONT><A NAME="526"></A>      }
<FONT ID="LN">527 </FONT><A NAME="527"></A>      <FONT ID="If">if</FONT> (minIndex &gt; getInputFormat().numClasses()) {
<FONT ID="LN">528 </FONT><A NAME="528"></A>    <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> Exception(<FONT ID="StringLiteral">"value index must be &lt;= the number of classes"</FONT>);
<FONT ID="LN">529 </FONT><A NAME="529"></A>      }
<FONT ID="LN">530 </FONT><A NAME="530"></A>      minIndex--; <FONT ID="SingleLineComment">// make it an index
<FONT ID="LN">531 </FONT><A NAME="531"></A></FONT>    }
<FONT ID="LN">532 </FONT><A NAME="532"></A>
<FONT ID="LN">533 </FONT><A NAME="533"></A>    <FONT ID="Int">int</FONT> nearestNeighbors;
<FONT ID="LN">534 </FONT><A NAME="534"></A>    <FONT ID="If">if</FONT> (min &lt;= getNearestNeighbors()) {
<FONT ID="LN">535 </FONT><A NAME="535"></A>      nearestNeighbors = min - <FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">536 </FONT><A NAME="536"></A>    } <FONT ID="Else">else</FONT> {
<FONT ID="LN">537 </FONT><A NAME="537"></A>      nearestNeighbors = getNearestNeighbors();
<FONT ID="LN">538 </FONT><A NAME="538"></A>    }
<FONT ID="LN">539 </FONT><A NAME="539"></A>    <FONT ID="If">if</FONT> (nearestNeighbors &lt; <FONT ID="IntegerLiteral">1</FONT>)
<FONT ID="LN">540 </FONT><A NAME="540"></A>      <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> Exception(<FONT ID="StringLiteral">"Cannot use 0 neighbors!"</FONT>);
<FONT ID="LN">541 </FONT><A NAME="541"></A>
<FONT ID="LN">542 </FONT><A NAME="542"></A>    <FONT ID="SingleLineComment">// compose minority class dataset
<FONT ID="LN">543 </FONT><A NAME="543"></A></FONT>    <FONT ID="SingleLineComment">// also push all dataset instances
<FONT ID="LN">544 </FONT><A NAME="544"></A></FONT>    <A HREF="../../../../weka/core/Instances.java.html">Instances</A> sample = getInputFormat().stringFreeStructure();
<FONT ID="LN">545 </FONT><A NAME="545"></A>    Enumeration instanceEnum = getInputFormat().enumerateInstances();
<FONT ID="LN">546 </FONT><A NAME="546"></A>    <FONT ID="While">while</FONT>(instanceEnum.hasMoreElements()) {
<FONT ID="LN">547 </FONT><A NAME="547"></A>      <A HREF="../../../../weka/core/Instance.java.html">Instance</A> instance = (<A HREF="../../../../weka/core/Instance.java.html">Instance</A>) instanceEnum.nextElement();
<FONT ID="LN">548 </FONT><A NAME="548"></A>      push((<A HREF="../../../../weka/core/Instance.java.html">Instance</A>) instance.copy());
<FONT ID="LN">549 </FONT><A NAME="549"></A>      <FONT ID="If">if</FONT> ((<FONT ID="Int">int</FONT>) instance.classValue() == minIndex) {
<FONT ID="LN">550 </FONT><A NAME="550"></A>    sample.add(instance);
<FONT ID="LN">551 </FONT><A NAME="551"></A>      }
<FONT ID="LN">552 </FONT><A NAME="552"></A>    }
<FONT ID="LN">553 </FONT><A NAME="553"></A>
<FONT ID="LN">554 </FONT><A NAME="554"></A>    <FONT ID="SingleLineComment">// compute Value Distance Metric matrices for nominal features
<FONT ID="LN">555 </FONT><A NAME="555"></A></FONT>    Map vdmMap = <FONT ID="New">new</FONT> HashMap();
<FONT ID="LN">556 </FONT><A NAME="556"></A>    Enumeration attrEnum = getInputFormat().enumerateAttributes();
<FONT ID="LN">557 </FONT><A NAME="557"></A>    <FONT ID="While">while</FONT>(attrEnum.hasMoreElements()) {
<FONT ID="LN">558 </FONT><A NAME="558"></A>      <A HREF="../../../../weka/core/Attribute.java.html">Attribute</A> attr = (<A HREF="../../../../weka/core/Attribute.java.html">Attribute</A>) attrEnum.nextElement();
<FONT ID="LN">559 </FONT><A NAME="559"></A>      <FONT ID="If">if</FONT> (!attr.equals(getInputFormat().classAttribute())) {
<FONT ID="LN">560 </FONT><A NAME="560"></A>    <FONT ID="If">if</FONT> (attr.isNominal() || attr.isString()) {
<FONT ID="LN">561 </FONT><A NAME="561"></A>      <FONT ID="Double">double</FONT>[][] vdm = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[attr.numValues()][attr.numValues()];
<FONT ID="LN">562 </FONT><A NAME="562"></A>      vdmMap.put(attr, vdm);
<FONT ID="LN">563 </FONT><A NAME="563"></A>      <FONT ID="Int">int</FONT>[] featureValueCounts = <FONT ID="New">new</FONT> <FONT ID="Int">int</FONT>[attr.numValues()];
<FONT ID="LN">564 </FONT><A NAME="564"></A>      <FONT ID="Int">int</FONT>[][] featureValueCountsByClass = <FONT ID="New">new</FONT> <FONT ID="Int">int</FONT>[getInputFormat().classAttribute().numValues()][attr.numValues()];
<FONT ID="LN">565 </FONT><A NAME="565"></A>      instanceEnum = getInputFormat().enumerateInstances();
<FONT ID="LN">566 </FONT><A NAME="566"></A>      <FONT ID="While">while</FONT>(instanceEnum.hasMoreElements()) {
<FONT ID="LN">567 </FONT><A NAME="567"></A>        <A HREF="../../../../weka/core/Instance.java.html">Instance</A> instance = (<A HREF="../../../../weka/core/Instance.java.html">Instance</A>) instanceEnum.nextElement();
<FONT ID="LN">568 </FONT><A NAME="568"></A>        <FONT ID="Int">int</FONT> value = (<FONT ID="Int">int</FONT>) instance.value(attr);
<FONT ID="LN">569 </FONT><A NAME="569"></A>        <FONT ID="Int">int</FONT> classValue = (<FONT ID="Int">int</FONT>) instance.classValue();
<FONT ID="LN">570 </FONT><A NAME="570"></A>        featureValueCounts[value]++;
<FONT ID="LN">571 </FONT><A NAME="571"></A>        featureValueCountsByClass[classValue][value]++;
<FONT ID="LN">572 </FONT><A NAME="572"></A>      }
<FONT ID="LN">573 </FONT><A NAME="573"></A>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> valueIndex1 = <FONT ID="IntegerLiteral">0</FONT>; valueIndex1 &lt; attr.numValues(); valueIndex1++) {
<FONT ID="LN">574 </FONT><A NAME="574"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> valueIndex2 = <FONT ID="IntegerLiteral">0</FONT>; valueIndex2 &lt; attr.numValues(); valueIndex2++) {
<FONT ID="LN">575 </FONT><A NAME="575"></A>          <FONT ID="Double">double</FONT> sum = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">576 </FONT><A NAME="576"></A>          <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> classValueIndex = <FONT ID="IntegerLiteral">0</FONT>; classValueIndex &lt; getInputFormat().numClasses(); classValueIndex++) {
<FONT ID="LN">577 </FONT><A NAME="577"></A>        <FONT ID="Double">double</FONT> c1i = (<FONT ID="Double">double</FONT>) featureValueCountsByClass[classValueIndex][valueIndex1];
<FONT ID="LN">578 </FONT><A NAME="578"></A>        <FONT ID="Double">double</FONT> c2i = (<FONT ID="Double">double</FONT>) featureValueCountsByClass[classValueIndex][valueIndex2];
<FONT ID="LN">579 </FONT><A NAME="579"></A>        <FONT ID="Double">double</FONT> c1 = (<FONT ID="Double">double</FONT>) featureValueCounts[valueIndex1];
<FONT ID="LN">580 </FONT><A NAME="580"></A>        <FONT ID="Double">double</FONT> c2 = (<FONT ID="Double">double</FONT>) featureValueCounts[valueIndex2];
<FONT ID="LN">581 </FONT><A NAME="581"></A>        <FONT ID="Double">double</FONT> term1 = c1i / c1;
<FONT ID="LN">582 </FONT><A NAME="582"></A>        <FONT ID="Double">double</FONT> term2 = c2i / c2;
<FONT ID="LN">583 </FONT><A NAME="583"></A>        sum += Math.abs(term1 - term2);
<FONT ID="LN">584 </FONT><A NAME="584"></A>          }
<FONT ID="LN">585 </FONT><A NAME="585"></A>          vdm[valueIndex1][valueIndex2] = sum;
<FONT ID="LN">586 </FONT><A NAME="586"></A>        }
<FONT ID="LN">587 </FONT><A NAME="587"></A>      }
<FONT ID="LN">588 </FONT><A NAME="588"></A>    }
<FONT ID="LN">589 </FONT><A NAME="589"></A>      }
<FONT ID="LN">590 </FONT><A NAME="590"></A>    }
<FONT ID="LN">591 </FONT><A NAME="591"></A>
<FONT ID="LN">592 </FONT><A NAME="592"></A>    <FONT ID="SingleLineComment">// use this random source for all required randomness
<FONT ID="LN">593 </FONT><A NAME="593"></A></FONT>    Random rand = <FONT ID="New">new</FONT> Random(getRandomSeed());
<FONT ID="LN">594 </FONT><A NAME="594"></A>
<FONT ID="LN">595 </FONT><A NAME="595"></A>    <FONT ID="SingleLineComment">// find the set of extra indices to use if the percentage is not evenly divisible by 100
<FONT ID="LN">596 </FONT><A NAME="596"></A></FONT>    List extraIndices = <FONT ID="New">new</FONT> LinkedList();
<FONT ID="LN">597 </FONT><A NAME="597"></A>    <FONT ID="Double">double</FONT> percentageRemainder = (getPercentage() / <FONT ID="IntegerLiteral">100</FONT>) - Math.floor(getPercentage() / <FONT ID="FloatPointLiteral">100.0</FONT>);
<FONT ID="LN">598 </FONT><A NAME="598"></A>    <FONT ID="Int">int</FONT> extraIndicesCount = (<FONT ID="Int">int</FONT>) (percentageRemainder * sample.numInstances());
<FONT ID="LN">599 </FONT><A NAME="599"></A>    <FONT ID="If">if</FONT> (extraIndicesCount &gt;= <FONT ID="IntegerLiteral">1</FONT>) {
<FONT ID="LN">600 </FONT><A NAME="600"></A>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; sample.numInstances(); i++) {
<FONT ID="LN">601 </FONT><A NAME="601"></A>    extraIndices.add(i);
<FONT ID="LN">602 </FONT><A NAME="602"></A>      }
<FONT ID="LN">603 </FONT><A NAME="603"></A>    }
<FONT ID="LN">604 </FONT><A NAME="604"></A>    Collections.shuffle(extraIndices, rand);
<FONT ID="LN">605 </FONT><A NAME="605"></A>    extraIndices = extraIndices.subList(<FONT ID="IntegerLiteral">0</FONT>, extraIndicesCount);
<FONT ID="LN">606 </FONT><A NAME="606"></A>    Set extraIndexSet = <FONT ID="New">new</FONT> HashSet(extraIndices);
<FONT ID="LN">607 </FONT><A NAME="607"></A>
<FONT ID="LN">608 </FONT><A NAME="608"></A>    <FONT ID="SingleLineComment">// the main loop to handle computing nearest neighbors and generating SMOTE
<FONT ID="LN">609 </FONT><A NAME="609"></A></FONT>    <FONT ID="SingleLineComment">// examples from each instance in the original minority class data
<FONT ID="LN">610 </FONT><A NAME="610"></A></FONT>    <A HREF="../../../../weka/core/Instance.java.html">Instance</A>[] nnArray = <FONT ID="New">new</FONT> <A HREF="../../../../weka/core/Instance.java.html">Instance</A>[nearestNeighbors];
<FONT ID="LN">611 </FONT><A NAME="611"></A>    <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; sample.numInstances(); i++) {
<FONT ID="LN">612 </FONT><A NAME="612"></A>      <A HREF="../../../../weka/core/Instance.java.html">Instance</A> instanceI = sample.instance(i);
<FONT ID="LN">613 </FONT><A NAME="613"></A>      <FONT ID="SingleLineComment">// find k nearest neighbors for each instance
<FONT ID="LN">614 </FONT><A NAME="614"></A></FONT>      List distanceToInstance = <FONT ID="New">new</FONT> LinkedList();
<FONT ID="LN">615 </FONT><A NAME="615"></A>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> j = <FONT ID="IntegerLiteral">0</FONT>; j &lt; sample.numInstances(); j++) {
<FONT ID="LN">616 </FONT><A NAME="616"></A>    <A HREF="../../../../weka/core/Instance.java.html">Instance</A> instanceJ = sample.instance(j);
<FONT ID="LN">617 </FONT><A NAME="617"></A>    <FONT ID="If">if</FONT> (i != j) {
<FONT ID="LN">618 </FONT><A NAME="618"></A>      <FONT ID="Double">double</FONT> distance = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">619 </FONT><A NAME="619"></A>      attrEnum = getInputFormat().enumerateAttributes();
<FONT ID="LN">620 </FONT><A NAME="620"></A>      <FONT ID="While">while</FONT>(attrEnum.hasMoreElements()) {
<FONT ID="LN">621 </FONT><A NAME="621"></A>        <A HREF="../../../../weka/core/Attribute.java.html">Attribute</A> attr = (<A HREF="../../../../weka/core/Attribute.java.html">Attribute</A>) attrEnum.nextElement();
<FONT ID="LN">622 </FONT><A NAME="622"></A>        <FONT ID="If">if</FONT> (!attr.equals(getInputFormat().classAttribute())) {
<FONT ID="LN">623 </FONT><A NAME="623"></A>          <FONT ID="Double">double</FONT> iVal = instanceI.value(attr);
<FONT ID="LN">624 </FONT><A NAME="624"></A>          <FONT ID="Double">double</FONT> jVal = instanceJ.value(attr);
<FONT ID="LN">625 </FONT><A NAME="625"></A>          <FONT ID="If">if</FONT> (attr.isNumeric()) {
<FONT ID="LN">626 </FONT><A NAME="626"></A>        distance += Math.pow(iVal - jVal, <FONT ID="IntegerLiteral">2</FONT>);
<FONT ID="LN">627 </FONT><A NAME="627"></A>          } <FONT ID="Else">else</FONT> {
<FONT ID="LN">628 </FONT><A NAME="628"></A>        distance += ((<FONT ID="Double">double</FONT>[][]) vdmMap.get(attr))[(<FONT ID="Int">int</FONT>) iVal][(<FONT ID="Int">int</FONT>) jVal];
<FONT ID="LN">629 </FONT><A NAME="629"></A>          }
<FONT ID="LN">630 </FONT><A NAME="630"></A>        }
<FONT ID="LN">631 </FONT><A NAME="631"></A>      }
<FONT ID="LN">632 </FONT><A NAME="632"></A>      distance = Math.pow(distance, <FONT ID="FloatPointLiteral">.5</FONT>);
<FONT ID="LN">633 </FONT><A NAME="633"></A>      distanceToInstance.add(<FONT ID="New">new</FONT> Object[] {distance, instanceJ});
<FONT ID="LN">634 </FONT><A NAME="634"></A>    }
<FONT ID="LN">635 </FONT><A NAME="635"></A>      }
<FONT ID="LN">636 </FONT><A NAME="636"></A>
<FONT ID="LN">637 </FONT><A NAME="637"></A>      <FONT ID="SingleLineComment">// sort the neighbors according to distance
<FONT ID="LN">638 </FONT><A NAME="638"></A></FONT>      Collections.sort(distanceToInstance, <FONT ID="New">new</FONT> Comparator() {
<FONT ID="LN">639 </FONT><A NAME="639"></A>    <FONT ID="Public">public</FONT> <FONT ID="Int">int</FONT> compare(Object o1, Object o2) {
<FONT ID="LN">640 </FONT><A NAME="640"></A>      <FONT ID="Double">double</FONT> distance1 = (Double) ((Object[]) o1)[<FONT ID="IntegerLiteral">0</FONT>];
<FONT ID="LN">641 </FONT><A NAME="641"></A>      <FONT ID="Double">double</FONT> distance2 = (Double) ((Object[]) o2)[<FONT ID="IntegerLiteral">0</FONT>];
<FONT ID="LN">642 </FONT><A NAME="642"></A>      <FONT ID="Return">return</FONT> (<FONT ID="Int">int</FONT>) Math.ceil(distance1 - distance2);
<FONT ID="LN">643 </FONT><A NAME="643"></A>    }
<FONT ID="LN">644 </FONT><A NAME="644"></A>      });
<FONT ID="LN">645 </FONT><A NAME="645"></A>
<FONT ID="LN">646 </FONT><A NAME="646"></A>      <FONT ID="SingleLineComment">// populate the actual nearest neighbor instance array
<FONT ID="LN">647 </FONT><A NAME="647"></A></FONT>      Iterator entryIterator = distanceToInstance.iterator();
<FONT ID="LN">648 </FONT><A NAME="648"></A>      <FONT ID="Int">int</FONT> j = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">649 </FONT><A NAME="649"></A>      <FONT ID="While">while</FONT>(entryIterator.hasNext() &amp;&amp; j &lt; nearestNeighbors) {
<FONT ID="LN">650 </FONT><A NAME="650"></A>    nnArray[j] = (<A HREF="../../../../weka/core/Instance.java.html">Instance</A>) ((Object[])entryIterator.next())[<FONT ID="IntegerLiteral">1</FONT>];
<FONT ID="LN">651 </FONT><A NAME="651"></A>    j++;
<FONT ID="LN">652 </FONT><A NAME="652"></A>      }
<FONT ID="LN">653 </FONT><A NAME="653"></A>
<FONT ID="LN">654 </FONT><A NAME="654"></A>      <FONT ID="SingleLineComment">// create synthetic examples
<FONT ID="LN">655 </FONT><A NAME="655"></A></FONT>      <FONT ID="Int">int</FONT> n = (<FONT ID="Int">int</FONT>) Math.floor(getPercentage() / <FONT ID="IntegerLiteral">100</FONT>);
<FONT ID="LN">656 </FONT><A NAME="656"></A>      <FONT ID="While">while</FONT>(n &gt; <FONT ID="IntegerLiteral">0</FONT> || extraIndexSet.remove(i)) {
<FONT ID="LN">657 </FONT><A NAME="657"></A>    <FONT ID="Double">double</FONT>[] values = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[sample.numAttributes()];
<FONT ID="LN">658 </FONT><A NAME="658"></A>    <FONT ID="Int">int</FONT> nn = rand.nextInt(nearestNeighbors);
<FONT ID="LN">659 </FONT><A NAME="659"></A>    attrEnum = getInputFormat().enumerateAttributes();
<FONT ID="LN">660 </FONT><A NAME="660"></A>    <FONT ID="While">while</FONT>(attrEnum.hasMoreElements()) {
<FONT ID="LN">661 </FONT><A NAME="661"></A>      <A HREF="../../../../weka/core/Attribute.java.html">Attribute</A> attr = (<A HREF="../../../../weka/core/Attribute.java.html">Attribute</A>) attrEnum.nextElement();
<FONT ID="LN">662 </FONT><A NAME="662"></A>      <FONT ID="If">if</FONT> (!attr.equals(getInputFormat().classAttribute())) {
<FONT ID="LN">663 </FONT><A NAME="663"></A>        <FONT ID="If">if</FONT> (attr.isNumeric()) {
<FONT ID="LN">664 </FONT><A NAME="664"></A>          <FONT ID="Double">double</FONT> dif = nnArray[nn].value(attr) - instanceI.value(attr);
<FONT ID="LN">665 </FONT><A NAME="665"></A>          <FONT ID="Double">double</FONT> gap = rand.nextDouble();
<FONT ID="LN">666 </FONT><A NAME="666"></A>          values[attr.index()] = (<FONT ID="Double">double</FONT>) (instanceI.value(attr) + gap * dif);
<FONT ID="LN">667 </FONT><A NAME="667"></A>        } <FONT ID="Else">else</FONT> <FONT ID="If">if</FONT> (attr.isDate()) {
<FONT ID="LN">668 </FONT><A NAME="668"></A>          <FONT ID="Double">double</FONT> dif = nnArray[nn].value(attr) - instanceI.value(attr);
<FONT ID="LN">669 </FONT><A NAME="669"></A>          <FONT ID="Double">double</FONT> gap = rand.nextDouble();
<FONT ID="LN">670 </FONT><A NAME="670"></A>          values[attr.index()] = (<FONT ID="Long">long</FONT>) (instanceI.value(attr) + gap * dif);
<FONT ID="LN">671 </FONT><A NAME="671"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">672 </FONT><A NAME="672"></A>          <FONT ID="Int">int</FONT>[] valueCounts = <FONT ID="New">new</FONT> <FONT ID="Int">int</FONT>[attr.numValues()];
<FONT ID="LN">673 </FONT><A NAME="673"></A>          <FONT ID="Int">int</FONT> iVal = (<FONT ID="Int">int</FONT>) instanceI.value(attr);
<FONT ID="LN">674 </FONT><A NAME="674"></A>          valueCounts[iVal]++;
<FONT ID="LN">675 </FONT><A NAME="675"></A>          <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> nnEx = <FONT ID="IntegerLiteral">0</FONT>; nnEx &lt; nearestNeighbors; nnEx++) {
<FONT ID="LN">676 </FONT><A NAME="676"></A>        <FONT ID="Int">int</FONT> val = (<FONT ID="Int">int</FONT>) nnArray[nnEx].value(attr);
<FONT ID="LN">677 </FONT><A NAME="677"></A>        valueCounts[val]++;
<FONT ID="LN">678 </FONT><A NAME="678"></A>          }
<FONT ID="LN">679 </FONT><A NAME="679"></A>          <FONT ID="Int">int</FONT> maxIndex = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">680 </FONT><A NAME="680"></A>          <FONT ID="Int">int</FONT> max = Integer.MIN_VALUE;
<FONT ID="LN">681 </FONT><A NAME="681"></A>          <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> index = <FONT ID="IntegerLiteral">0</FONT>; index &lt; attr.numValues(); index++) {
<FONT ID="LN">682 </FONT><A NAME="682"></A>        <FONT ID="If">if</FONT> (valueCounts[index] &gt; max) {
<FONT ID="LN">683 </FONT><A NAME="683"></A>          max = valueCounts[index];
<FONT ID="LN">684 </FONT><A NAME="684"></A>          maxIndex = index;
<FONT ID="LN">685 </FONT><A NAME="685"></A>        }
<FONT ID="LN">686 </FONT><A NAME="686"></A>          }
<FONT ID="LN">687 </FONT><A NAME="687"></A>          values[attr.index()] = maxIndex;
<FONT ID="LN">688 </FONT><A NAME="688"></A>        }
<FONT ID="LN">689 </FONT><A NAME="689"></A>      }
<FONT ID="LN">690 </FONT><A NAME="690"></A>    }
<FONT ID="LN">691 </FONT><A NAME="691"></A>    values[sample.classIndex()] = minIndex;
<FONT ID="LN">692 </FONT><A NAME="692"></A>    <A HREF="../../../../weka/core/Instance.java.html">Instance</A> synthetic = <FONT ID="New">new</FONT> <A HREF="../../../../weka/core/DenseInstance.java.html">DenseInstance</A>(<FONT ID="FloatPointLiteral">1.0</FONT>, values);
<FONT ID="LN">693 </FONT><A NAME="693"></A>    push(synthetic);
<FONT ID="LN">694 </FONT><A NAME="694"></A>    n--;
<FONT ID="LN">695 </FONT><A NAME="695"></A>      }
<FONT ID="LN">696 </FONT><A NAME="696"></A>    }
<FONT ID="LN">697 </FONT><A NAME="697"></A>  }
<FONT ID="LN">698 </FONT><A NAME="698"></A>
<FONT ID="LN">699 </FONT><A NAME="699"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">700 </FONT><A NAME="700"></A>   * Main method for running this filter.
<FONT ID="LN">701 </FONT><A NAME="701"></A>   *
<FONT ID="LN">702 </FONT><A NAME="702"></A>   * @param args    should contain arguments to the filter: 
<FONT ID="LN">703 </FONT><A NAME="703"></A>   *            use -h for help
<FONT ID="LN">704 </FONT><A NAME="704"></A>   */</FONT>
<FONT ID="LN">705 </FONT><A NAME="705"></A>  <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Void">void</FONT> main(String[] args) {
<FONT ID="LN">706 </FONT><A NAME="706"></A>    runFilter(<FONT ID="New">new</FONT> <A HREF="../../../../weka/filters/supervised/instance/SMOTE.java.html">SMOTE</A>(), args);
<FONT ID="LN">707 </FONT><A NAME="707"></A>  }
<FONT ID="LN">708 </FONT><A NAME="708"></A>}
<FONT ID="LN">709 </FONT><A NAME="709"></A></pre><TABLE id="Header" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2" width="33%">&nbsp;</td>
<td align="center" colspan="2" width="33%">
<font size="4">SMOTE.java</font>
</td>
<td align="right" colspan="2" width="33%">&nbsp;</td>
</tr>
</TABLE>

</BODY>
</HTML>