<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<LINK REL=STYLESHEET TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">
<META NAME="GENERATOR" CONTENT="Java2HTML Version 1.5">
<TITLE>weka.attributeSelection.ReliefFAttributeEval (Java2HTML)</TITLE>
</HEAD>
<BODY><TABLE id="Header" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2" width="33%">&nbsp;</td>
<td align="center" colspan="2" width="33%">
<font size="4">ReliefFAttributeEval.java</font>
</td>
<td align="right" colspan="2" width="33%">&nbsp;</td>
</tr>
</TABLE>
<pre ID="Classes">
<FONT ID="LN">1   </FONT><A NAME="1"></A><FONT ID="MultiLineComment">/*
<FONT ID="LN">2   </FONT><A NAME="2"></A> *    This program is free software; you can redistribute it and/or modify
<FONT ID="LN">3   </FONT><A NAME="3"></A> *    it under the terms of the GNU General Public License as published by
<FONT ID="LN">4   </FONT><A NAME="4"></A> *    the Free Software Foundation; either version 2 of the License, or
<FONT ID="LN">5   </FONT><A NAME="5"></A> *    (at your option) any later version.
<FONT ID="LN">6   </FONT><A NAME="6"></A> *
<FONT ID="LN">7   </FONT><A NAME="7"></A> *    This program is distributed in the hope that it will be useful,
<FONT ID="LN">8   </FONT><A NAME="8"></A> *    but WITHOUT ANY WARRANTY; without even the implied warranty of
<FONT ID="LN">9   </FONT><A NAME="9"></A> *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
<FONT ID="LN">10  </FONT><A NAME="10"></A> *    GNU General Public License for more details.
<FONT ID="LN">11  </FONT><A NAME="11"></A> *
<FONT ID="LN">12  </FONT><A NAME="12"></A> *    You should have received a copy of the GNU General Public License
<FONT ID="LN">13  </FONT><A NAME="13"></A> *    along with this program; if not, write to the Free Software
<FONT ID="LN">14  </FONT><A NAME="14"></A> *    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
<FONT ID="LN">15  </FONT><A NAME="15"></A> */</FONT>
<FONT ID="LN">16  </FONT><A NAME="16"></A>
<FONT ID="LN">17  </FONT><A NAME="17"></A><FONT ID="MultiLineComment">/*
<FONT ID="LN">18  </FONT><A NAME="18"></A> *    ReliefFAttributeEval.java
<FONT ID="LN">19  </FONT><A NAME="19"></A> *    Copyright (C) 1999 University of Waikato, Hamilton, New Zealand
<FONT ID="LN">20  </FONT><A NAME="20"></A> *
<FONT ID="LN">21  </FONT><A NAME="21"></A> */</FONT>
<FONT ID="LN">22  </FONT><A NAME="22"></A>
<FONT ID="LN">23  </FONT><A NAME="23"></A><FONT ID="Package">package</FONT> weka.attributeSelection;
<FONT ID="LN">24  </FONT><A NAME="24"></A>
<FONT ID="LN">25  </FONT><A NAME="25"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/Attribute.java.html">weka.core.Attribute</A>;
<FONT ID="LN">26  </FONT><A NAME="26"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/Capabilities.java.html">weka.core.Capabilities</A>;
<FONT ID="LN">27  </FONT><A NAME="27"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/Instance.java.html">weka.core.Instance</A>;
<FONT ID="LN">28  </FONT><A NAME="28"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/Instances.java.html">weka.core.Instances</A>;
<FONT ID="LN">29  </FONT><A NAME="29"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/Option.java.html">weka.core.Option</A>;
<FONT ID="LN">30  </FONT><A NAME="30"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/OptionHandler.java.html">weka.core.OptionHandler</A>;
<FONT ID="LN">31  </FONT><A NAME="31"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/RevisionUtils.java.html">weka.core.RevisionUtils</A>;
<FONT ID="LN">32  </FONT><A NAME="32"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/TechnicalInformation.java.html">weka.core.TechnicalInformation</A>;
<FONT ID="LN">33  </FONT><A NAME="33"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/TechnicalInformationHandler.java.html">weka.core.TechnicalInformationHandler</A>;
<FONT ID="LN">34  </FONT><A NAME="34"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/Utils.java.html">weka.core.Utils</A>;
<FONT ID="LN">35  </FONT><A NAME="35"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/Capabilities.java.html">weka.core.Capabilities.Capability</A>;
<FONT ID="LN">36  </FONT><A NAME="36"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/TechnicalInformation.java.html">weka.core.TechnicalInformation.Field</A>;
<FONT ID="LN">37  </FONT><A NAME="37"></A><FONT ID="Import">import</FONT> <A HREF="../../weka/core/TechnicalInformation.java.html">weka.core.TechnicalInformation.Type</A>;
<FONT ID="LN">38  </FONT><A NAME="38"></A>
<FONT ID="LN">39  </FONT><A NAME="39"></A><FONT ID="Import">import</FONT> java.util.Enumeration;
<FONT ID="LN">40  </FONT><A NAME="40"></A><FONT ID="Import">import</FONT> java.util.Random;
<FONT ID="LN">41  </FONT><A NAME="41"></A><FONT ID="Import">import</FONT> java.util.Vector;
<FONT ID="LN">42  </FONT><A NAME="42"></A>
<FONT ID="LN">43  </FONT><A NAME="43"></A><FONT ID="FormalComment">/** 
<FONT ID="LN">44  </FONT><A NAME="44"></A> &lt;!-- globalinfo-start --&gt;
<FONT ID="LN">45  </FONT><A NAME="45"></A> * ReliefFAttributeEval :&lt;br/&gt;
<FONT ID="LN">46  </FONT><A NAME="46"></A> * &lt;br/&gt;
<FONT ID="LN">47  </FONT><A NAME="47"></A> * Evaluates the worth of an attribute by repeatedly sampling an instance and considering the value of the given attribute for the nearest instance of the same and different class. Can operate on both discrete and continuous class data.&lt;br/&gt;
<FONT ID="LN">48  </FONT><A NAME="48"></A> * &lt;br/&gt;
<FONT ID="LN">49  </FONT><A NAME="49"></A> * For more information see:&lt;br/&gt;
<FONT ID="LN">50  </FONT><A NAME="50"></A> * &lt;br/&gt;
<FONT ID="LN">51  </FONT><A NAME="51"></A> * Kenji Kira, Larry A. Rendell: A Practical Approach to Feature Selection. In: Ninth International Workshop on Machine Learning, 249-256, 1992.&lt;br/&gt;
<FONT ID="LN">52  </FONT><A NAME="52"></A> * &lt;br/&gt;
<FONT ID="LN">53  </FONT><A NAME="53"></A> * Igor Kononenko: Estimating Attributes: Analysis and Extensions of RELIEF. In: European Conference on Machine Learning, 171-182, 1994.&lt;br/&gt;
<FONT ID="LN">54  </FONT><A NAME="54"></A> * &lt;br/&gt;
<FONT ID="LN">55  </FONT><A NAME="55"></A> * Marko Robnik-Sikonja, Igor Kononenko: An adaptation of Relief for attribute estimation in regression. In: Fourteenth International Conference on Machine Learning, 296-304, 1997.
<FONT ID="LN">56  </FONT><A NAME="56"></A> * &lt;p/&gt;
<FONT ID="LN">57  </FONT><A NAME="57"></A> &lt;!-- globalinfo-end --&gt;
<FONT ID="LN">58  </FONT><A NAME="58"></A> *
<FONT ID="LN">59  </FONT><A NAME="59"></A> &lt;!-- technical-bibtex-start --&gt;
<FONT ID="LN">60  </FONT><A NAME="60"></A> * BibTeX:
<FONT ID="LN">61  </FONT><A NAME="61"></A> * &lt;pre&gt;
<FONT ID="LN">62  </FONT><A NAME="62"></A> * &amp;#64;inproceedings{Kira1992,
<FONT ID="LN">63  </FONT><A NAME="63"></A> *    author = {Kenji Kira and Larry A. Rendell},
<FONT ID="LN">64  </FONT><A NAME="64"></A> *    booktitle = {Ninth International Workshop on Machine Learning},
<FONT ID="LN">65  </FONT><A NAME="65"></A> *    editor = {Derek H. Sleeman and Peter Edwards},
<FONT ID="LN">66  </FONT><A NAME="66"></A> *    pages = {249-256},
<FONT ID="LN">67  </FONT><A NAME="67"></A> *    publisher = {Morgan Kaufmann},
<FONT ID="LN">68  </FONT><A NAME="68"></A> *    title = {A Practical Approach to Feature Selection},
<FONT ID="LN">69  </FONT><A NAME="69"></A> *    year = {1992}
<FONT ID="LN">70  </FONT><A NAME="70"></A> * }
<FONT ID="LN">71  </FONT><A NAME="71"></A> * 
<FONT ID="LN">72  </FONT><A NAME="72"></A> * &amp;#64;inproceedings{Kononenko1994,
<FONT ID="LN">73  </FONT><A NAME="73"></A> *    author = {Igor Kononenko},
<FONT ID="LN">74  </FONT><A NAME="74"></A> *    booktitle = {European Conference on Machine Learning},
<FONT ID="LN">75  </FONT><A NAME="75"></A> *    editor = {Francesco Bergadano and Luc De Raedt},
<FONT ID="LN">76  </FONT><A NAME="76"></A> *    pages = {171-182},
<FONT ID="LN">77  </FONT><A NAME="77"></A> *    publisher = {Springer},
<FONT ID="LN">78  </FONT><A NAME="78"></A> *    title = {Estimating Attributes: Analysis and Extensions of RELIEF},
<FONT ID="LN">79  </FONT><A NAME="79"></A> *    year = {1994}
<FONT ID="LN">80  </FONT><A NAME="80"></A> * }
<FONT ID="LN">81  </FONT><A NAME="81"></A> * 
<FONT ID="LN">82  </FONT><A NAME="82"></A> * &amp;#64;inproceedings{Robnik-Sikonja1997,
<FONT ID="LN">83  </FONT><A NAME="83"></A> *    author = {Marko Robnik-Sikonja and Igor Kononenko},
<FONT ID="LN">84  </FONT><A NAME="84"></A> *    booktitle = {Fourteenth International Conference on Machine Learning},
<FONT ID="LN">85  </FONT><A NAME="85"></A> *    editor = {Douglas H. Fisher},
<FONT ID="LN">86  </FONT><A NAME="86"></A> *    pages = {296-304},
<FONT ID="LN">87  </FONT><A NAME="87"></A> *    publisher = {Morgan Kaufmann},
<FONT ID="LN">88  </FONT><A NAME="88"></A> *    title = {An adaptation of Relief for attribute estimation in regression},
<FONT ID="LN">89  </FONT><A NAME="89"></A> *    year = {1997}
<FONT ID="LN">90  </FONT><A NAME="90"></A> * }
<FONT ID="LN">91  </FONT><A NAME="91"></A> * &lt;/pre&gt;
<FONT ID="LN">92  </FONT><A NAME="92"></A> * &lt;p/&gt;
<FONT ID="LN">93  </FONT><A NAME="93"></A> &lt;!-- technical-bibtex-end --&gt;
<FONT ID="LN">94  </FONT><A NAME="94"></A> *
<FONT ID="LN">95  </FONT><A NAME="95"></A> &lt;!-- options-start --&gt;
<FONT ID="LN">96  </FONT><A NAME="96"></A> * Valid options are: &lt;p/&gt;
<FONT ID="LN">97  </FONT><A NAME="97"></A> * 
<FONT ID="LN">98  </FONT><A NAME="98"></A> * &lt;pre&gt; -M &amp;lt;num instances&amp;gt;
<FONT ID="LN">99  </FONT><A NAME="99"></A> *  Specify the number of instances to
<FONT ID="LN">100 </FONT><A NAME="100"></A> *  sample when estimating attributes.
<FONT ID="LN">101 </FONT><A NAME="101"></A> *  If not specified, then all instances
<FONT ID="LN">102 </FONT><A NAME="102"></A> *  will be used.&lt;/pre&gt;
<FONT ID="LN">103 </FONT><A NAME="103"></A> * 
<FONT ID="LN">104 </FONT><A NAME="104"></A> * &lt;pre&gt; -D &amp;lt;seed&amp;gt;
<FONT ID="LN">105 </FONT><A NAME="105"></A> *  Seed for randomly sampling instances.
<FONT ID="LN">106 </FONT><A NAME="106"></A> *  (Default = 1)&lt;/pre&gt;
<FONT ID="LN">107 </FONT><A NAME="107"></A> * 
<FONT ID="LN">108 </FONT><A NAME="108"></A> * &lt;pre&gt; -K &amp;lt;number of neighbours&amp;gt;
<FONT ID="LN">109 </FONT><A NAME="109"></A> *  Number of nearest neighbours (k) used
<FONT ID="LN">110 </FONT><A NAME="110"></A> *  to estimate attribute relevances
<FONT ID="LN">111 </FONT><A NAME="111"></A> *  (Default = 10).&lt;/pre&gt;
<FONT ID="LN">112 </FONT><A NAME="112"></A> * 
<FONT ID="LN">113 </FONT><A NAME="113"></A> * &lt;pre&gt; -W
<FONT ID="LN">114 </FONT><A NAME="114"></A> *  Weight nearest neighbours by distance&lt;/pre&gt;
<FONT ID="LN">115 </FONT><A NAME="115"></A> * 
<FONT ID="LN">116 </FONT><A NAME="116"></A> * &lt;pre&gt; -A &amp;lt;num&amp;gt;
<FONT ID="LN">117 </FONT><A NAME="117"></A> *  Specify sigma value (used in an exp
<FONT ID="LN">118 </FONT><A NAME="118"></A> *  function to control how quickly
<FONT ID="LN">119 </FONT><A NAME="119"></A> *  weights for more distant instances
<FONT ID="LN">120 </FONT><A NAME="120"></A> *  decrease. Use in conjunction with -W.
<FONT ID="LN">121 </FONT><A NAME="121"></A> *  Sensible value=1/5 to 1/10 of the
<FONT ID="LN">122 </FONT><A NAME="122"></A> *  number of nearest neighbours.
<FONT ID="LN">123 </FONT><A NAME="123"></A> *  (Default = 2)&lt;/pre&gt;
<FONT ID="LN">124 </FONT><A NAME="124"></A> * 
<FONT ID="LN">125 </FONT><A NAME="125"></A> &lt;!-- options-end --&gt;
<FONT ID="LN">126 </FONT><A NAME="126"></A> *
<FONT ID="LN">127 </FONT><A NAME="127"></A> * @author Mark Hall (mhall@cs.waikato.ac.nz)
<FONT ID="LN">128 </FONT><A NAME="128"></A> * @version $Revision: 5987 $
<FONT ID="LN">129 </FONT><A NAME="129"></A> */</FONT>
<FONT ID="LN">130 </FONT><A NAME="130"></A><FONT ID="Public">public</FONT> <FONT ID="Class">class</FONT> ReliefFAttributeEval
<FONT ID="LN">131 </FONT><A NAME="131"></A>  <FONT ID="Extends">extends</FONT> <A HREF="../../weka/attributeSelection/ASEvaluation.java.html">ASEvaluation</A>
<FONT ID="LN">132 </FONT><A NAME="132"></A>  <FONT ID="Implements">implements</FONT> <A HREF="../../weka/attributeSelection/AttributeEvaluator.java.html">AttributeEvaluator</A>,
<FONT ID="LN">133 </FONT><A NAME="133"></A>             <A HREF="../../weka/core/OptionHandler.java.html">OptionHandler</A>, 
<FONT ID="LN">134 </FONT><A NAME="134"></A>             <A HREF="../../weka/core/TechnicalInformationHandler.java.html">TechnicalInformationHandler</A> {
<FONT ID="LN">135 </FONT><A NAME="135"></A>  
<FONT ID="LN">136 </FONT><A NAME="136"></A>  <FONT ID="FormalComment">/** for serialization */</FONT>
<FONT ID="LN">137 </FONT><A NAME="137"></A>  <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> <FONT ID="Long">long</FONT> serialVersionUID = -<FONT ID="IntegerLiteral">8422186665795839379L</FONT>;
<FONT ID="LN">138 </FONT><A NAME="138"></A>
<FONT ID="LN">139 </FONT><A NAME="139"></A>  <FONT ID="FormalComment">/** The training instances */</FONT>
<FONT ID="LN">140 </FONT><A NAME="140"></A>  <FONT ID="Private">private</FONT> <A HREF="../../weka/core/Instances.java.html">Instances</A> m_trainInstances;
<FONT ID="LN">141 </FONT><A NAME="141"></A>
<FONT ID="LN">142 </FONT><A NAME="142"></A>  <FONT ID="FormalComment">/** The class index */</FONT>
<FONT ID="LN">143 </FONT><A NAME="143"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT> m_classIndex;
<FONT ID="LN">144 </FONT><A NAME="144"></A>
<FONT ID="LN">145 </FONT><A NAME="145"></A>  <FONT ID="FormalComment">/** The number of attributes */</FONT>
<FONT ID="LN">146 </FONT><A NAME="146"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT> m_numAttribs;
<FONT ID="LN">147 </FONT><A NAME="147"></A>
<FONT ID="LN">148 </FONT><A NAME="148"></A>  <FONT ID="FormalComment">/** The number of instances */</FONT>
<FONT ID="LN">149 </FONT><A NAME="149"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT> m_numInstances;
<FONT ID="LN">150 </FONT><A NAME="150"></A>
<FONT ID="LN">151 </FONT><A NAME="151"></A>  <FONT ID="FormalComment">/** Numeric class */</FONT>
<FONT ID="LN">152 </FONT><A NAME="152"></A>  <FONT ID="Private">private</FONT> <FONT ID="Boolean">boolean</FONT> m_numericClass;
<FONT ID="LN">153 </FONT><A NAME="153"></A>
<FONT ID="LN">154 </FONT><A NAME="154"></A>  <FONT ID="FormalComment">/** The number of classes if class is nominal */</FONT>
<FONT ID="LN">155 </FONT><A NAME="155"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT> m_numClasses;
<FONT ID="LN">156 </FONT><A NAME="156"></A>
<FONT ID="LN">157 </FONT><A NAME="157"></A>  <FONT ID="FormalComment">/** 
<FONT ID="LN">158 </FONT><A NAME="158"></A>   * Used to hold the probability of a different class val given nearest
<FONT ID="LN">159 </FONT><A NAME="159"></A>   * instances (numeric class)
<FONT ID="LN">160 </FONT><A NAME="160"></A>   */</FONT>
<FONT ID="LN">161 </FONT><A NAME="161"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT> m_ndc;
<FONT ID="LN">162 </FONT><A NAME="162"></A>
<FONT ID="LN">163 </FONT><A NAME="163"></A>  <FONT ID="FormalComment">/** 
<FONT ID="LN">164 </FONT><A NAME="164"></A>   * Used to hold the prob of different value of an attribute given
<FONT ID="LN">165 </FONT><A NAME="165"></A>   * nearest instances (numeric class case)
<FONT ID="LN">166 </FONT><A NAME="166"></A>   */</FONT>
<FONT ID="LN">167 </FONT><A NAME="167"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[] m_nda;
<FONT ID="LN">168 </FONT><A NAME="168"></A>
<FONT ID="LN">169 </FONT><A NAME="169"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">170 </FONT><A NAME="170"></A>   * Used to hold the prob of a different class val and different att
<FONT ID="LN">171 </FONT><A NAME="171"></A>   * val given nearest instances (numeric class case)
<FONT ID="LN">172 </FONT><A NAME="172"></A>   */</FONT>
<FONT ID="LN">173 </FONT><A NAME="173"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[] m_ndcda;
<FONT ID="LN">174 </FONT><A NAME="174"></A>
<FONT ID="LN">175 </FONT><A NAME="175"></A>  <FONT ID="FormalComment">/** Holds the weights that relief assigns to attributes */</FONT>
<FONT ID="LN">176 </FONT><A NAME="176"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[] m_weights;
<FONT ID="LN">177 </FONT><A NAME="177"></A>
<FONT ID="LN">178 </FONT><A NAME="178"></A>  <FONT ID="FormalComment">/** Prior class probabilities (discrete class case) */</FONT>
<FONT ID="LN">179 </FONT><A NAME="179"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[] m_classProbs;
<FONT ID="LN">180 </FONT><A NAME="180"></A>
<FONT ID="LN">181 </FONT><A NAME="181"></A>  <FONT ID="FormalComment">/** 
<FONT ID="LN">182 </FONT><A NAME="182"></A>   * The number of instances to sample when estimating attributes
<FONT ID="LN">183 </FONT><A NAME="183"></A>   * default == -1, use all instances
<FONT ID="LN">184 </FONT><A NAME="184"></A>   */</FONT>
<FONT ID="LN">185 </FONT><A NAME="185"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT> m_sampleM;
<FONT ID="LN">186 </FONT><A NAME="186"></A>
<FONT ID="LN">187 </FONT><A NAME="187"></A>  <FONT ID="FormalComment">/** The number of nearest hits/misses */</FONT>
<FONT ID="LN">188 </FONT><A NAME="188"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT> m_Knn;
<FONT ID="LN">189 </FONT><A NAME="189"></A>
<FONT ID="LN">190 </FONT><A NAME="190"></A>  <FONT ID="FormalComment">/** k nearest scores + instance indexes for n classes */</FONT>
<FONT ID="LN">191 </FONT><A NAME="191"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[][][] m_karray;
<FONT ID="LN">192 </FONT><A NAME="192"></A>
<FONT ID="LN">193 </FONT><A NAME="193"></A>  <FONT ID="FormalComment">/** Upper bound for numeric attributes */</FONT>
<FONT ID="LN">194 </FONT><A NAME="194"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[] m_maxArray;
<FONT ID="LN">195 </FONT><A NAME="195"></A>
<FONT ID="LN">196 </FONT><A NAME="196"></A>  <FONT ID="FormalComment">/** Lower bound for numeric attributes */</FONT>
<FONT ID="LN">197 </FONT><A NAME="197"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[] m_minArray;
<FONT ID="LN">198 </FONT><A NAME="198"></A>
<FONT ID="LN">199 </FONT><A NAME="199"></A>  <FONT ID="FormalComment">/** Keep track of the farthest instance for each class */</FONT>
<FONT ID="LN">200 </FONT><A NAME="200"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[] m_worst;
<FONT ID="LN">201 </FONT><A NAME="201"></A>
<FONT ID="LN">202 </FONT><A NAME="202"></A>  <FONT ID="FormalComment">/** Index in the m_karray of the farthest instance for each class */</FONT>
<FONT ID="LN">203 </FONT><A NAME="203"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT>[] m_index;
<FONT ID="LN">204 </FONT><A NAME="204"></A>
<FONT ID="LN">205 </FONT><A NAME="205"></A>  <FONT ID="FormalComment">/** Number of nearest neighbours stored of each class */</FONT>
<FONT ID="LN">206 </FONT><A NAME="206"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT>[] m_stored;
<FONT ID="LN">207 </FONT><A NAME="207"></A> 
<FONT ID="LN">208 </FONT><A NAME="208"></A>  <FONT ID="FormalComment">/** Random number seed used for sampling instances */</FONT>
<FONT ID="LN">209 </FONT><A NAME="209"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT> m_seed;
<FONT ID="LN">210 </FONT><A NAME="210"></A>
<FONT ID="LN">211 </FONT><A NAME="211"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">212 </FONT><A NAME="212"></A>   *  used to (optionally) weight nearest neighbours by their distance
<FONT ID="LN">213 </FONT><A NAME="213"></A>   *  from the instance in question. Each entry holds 
<FONT ID="LN">214 </FONT><A NAME="214"></A>   *  exp(-((rank(r_i, i_j)/sigma)^2)) where rank(r_i,i_j) is the rank of
<FONT ID="LN">215 </FONT><A NAME="215"></A>   *  instance i_j in a sequence of instances ordered by the distance
<FONT ID="LN">216 </FONT><A NAME="216"></A>   *  from r_i. sigma is a user defined parameter, default=20
<FONT ID="LN">217 </FONT><A NAME="217"></A>   **/</FONT>
<FONT ID="LN">218 </FONT><A NAME="218"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT>[] m_weightsByRank;
<FONT ID="LN">219 </FONT><A NAME="219"></A>  <FONT ID="Private">private</FONT> <FONT ID="Int">int</FONT> m_sigma;
<FONT ID="LN">220 </FONT><A NAME="220"></A>  
<FONT ID="LN">221 </FONT><A NAME="221"></A>  <FONT ID="FormalComment">/** Weight by distance rather than equal weights */</FONT>
<FONT ID="LN">222 </FONT><A NAME="222"></A>  <FONT ID="Private">private</FONT> <FONT ID="Boolean">boolean</FONT> m_weightByDistance;
<FONT ID="LN">223 </FONT><A NAME="223"></A>
<FONT ID="LN">224 </FONT><A NAME="224"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">225 </FONT><A NAME="225"></A>   * Constructor
<FONT ID="LN">226 </FONT><A NAME="226"></A>   */</FONT>
<FONT ID="LN">227 </FONT><A NAME="227"></A>  <FONT ID="Public">public</FONT> ReliefFAttributeEval () {
<FONT ID="LN">228 </FONT><A NAME="228"></A>    resetOptions();
<FONT ID="LN">229 </FONT><A NAME="229"></A>  }
<FONT ID="LN">230 </FONT><A NAME="230"></A>
<FONT ID="LN">231 </FONT><A NAME="231"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">232 </FONT><A NAME="232"></A>   * Returns a string describing this attribute evaluator
<FONT ID="LN">233 </FONT><A NAME="233"></A>   * @return a description of the evaluator suitable for
<FONT ID="LN">234 </FONT><A NAME="234"></A>   * displaying in the explorer/experimenter gui
<FONT ID="LN">235 </FONT><A NAME="235"></A>   */</FONT>
<FONT ID="LN">236 </FONT><A NAME="236"></A>  <FONT ID="Public">public</FONT> String globalInfo() {
<FONT ID="LN">237 </FONT><A NAME="237"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"ReliefFAttributeEval :\n\nEvaluates the worth of an attribute by "</FONT>
<FONT ID="LN">238 </FONT><A NAME="238"></A>      +<FONT ID="StringLiteral">"repeatedly sampling an instance and considering the value of the "</FONT>
<FONT ID="LN">239 </FONT><A NAME="239"></A>      +<FONT ID="StringLiteral">"given attribute for the nearest instance of the same and different "</FONT>
<FONT ID="LN">240 </FONT><A NAME="240"></A>      +<FONT ID="StringLiteral">"class. Can operate on both discrete and continuous class data.\n\n"</FONT>
<FONT ID="LN">241 </FONT><A NAME="241"></A>      + <FONT ID="StringLiteral">"For more information see:\n\n"</FONT>
<FONT ID="LN">242 </FONT><A NAME="242"></A>      + getTechnicalInformation().toString();
<FONT ID="LN">243 </FONT><A NAME="243"></A>  }
<FONT ID="LN">244 </FONT><A NAME="244"></A>
<FONT ID="LN">245 </FONT><A NAME="245"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">246 </FONT><A NAME="246"></A>   * Returns an instance of a TechnicalInformation object, containing 
<FONT ID="LN">247 </FONT><A NAME="247"></A>   * detailed information about the technical background of this class,
<FONT ID="LN">248 </FONT><A NAME="248"></A>   * e.g., paper reference or book this class is based on.
<FONT ID="LN">249 </FONT><A NAME="249"></A>   * 
<FONT ID="LN">250 </FONT><A NAME="250"></A>   * @return the technical information about this class
<FONT ID="LN">251 </FONT><A NAME="251"></A>   */</FONT>
<FONT ID="LN">252 </FONT><A NAME="252"></A>  <FONT ID="Public">public</FONT> <A HREF="../../weka/core/TechnicalInformation.java.html">TechnicalInformation</A> getTechnicalInformation() {
<FONT ID="LN">253 </FONT><A NAME="253"></A>    <A HREF="../../weka/core/TechnicalInformation.java.html">TechnicalInformation</A>        result;
<FONT ID="LN">254 </FONT><A NAME="254"></A>    <A HREF="../../weka/core/TechnicalInformation.java.html">TechnicalInformation</A>        additional;
<FONT ID="LN">255 </FONT><A NAME="255"></A>    
<FONT ID="LN">256 </FONT><A NAME="256"></A>    result = <FONT ID="New">new</FONT> <A HREF="../../weka/core/TechnicalInformation.java.html">TechnicalInformation</A>(Type.INPROCEEDINGS);
<FONT ID="LN">257 </FONT><A NAME="257"></A>    result.setValue(Field.AUTHOR, <FONT ID="StringLiteral">"Kenji Kira and Larry A. Rendell"</FONT>);
<FONT ID="LN">258 </FONT><A NAME="258"></A>    result.setValue(Field.TITLE, <FONT ID="StringLiteral">"A Practical Approach to Feature Selection"</FONT>);
<FONT ID="LN">259 </FONT><A NAME="259"></A>    result.setValue(Field.BOOKTITLE, <FONT ID="StringLiteral">"Ninth International Workshop on Machine Learning"</FONT>);
<FONT ID="LN">260 </FONT><A NAME="260"></A>    result.setValue(Field.EDITOR, <FONT ID="StringLiteral">"Derek H. Sleeman and Peter Edwards"</FONT>);
<FONT ID="LN">261 </FONT><A NAME="261"></A>    result.setValue(Field.YEAR, <FONT ID="StringLiteral">"1992"</FONT>);
<FONT ID="LN">262 </FONT><A NAME="262"></A>    result.setValue(Field.PAGES, <FONT ID="StringLiteral">"249-256"</FONT>);
<FONT ID="LN">263 </FONT><A NAME="263"></A>    result.setValue(Field.PUBLISHER, <FONT ID="StringLiteral">"Morgan Kaufmann"</FONT>);
<FONT ID="LN">264 </FONT><A NAME="264"></A>    
<FONT ID="LN">265 </FONT><A NAME="265"></A>    additional = result.add(Type.INPROCEEDINGS);
<FONT ID="LN">266 </FONT><A NAME="266"></A>    additional.setValue(Field.AUTHOR, <FONT ID="StringLiteral">"Igor Kononenko"</FONT>);
<FONT ID="LN">267 </FONT><A NAME="267"></A>    additional.setValue(Field.TITLE, <FONT ID="StringLiteral">"Estimating Attributes: Analysis and Extensions of RELIEF"</FONT>);
<FONT ID="LN">268 </FONT><A NAME="268"></A>    additional.setValue(Field.BOOKTITLE, <FONT ID="StringLiteral">"European Conference on Machine Learning"</FONT>);
<FONT ID="LN">269 </FONT><A NAME="269"></A>    additional.setValue(Field.EDITOR, <FONT ID="StringLiteral">"Francesco Bergadano and Luc De Raedt"</FONT>);
<FONT ID="LN">270 </FONT><A NAME="270"></A>    additional.setValue(Field.YEAR, <FONT ID="StringLiteral">"1994"</FONT>);
<FONT ID="LN">271 </FONT><A NAME="271"></A>    additional.setValue(Field.PAGES, <FONT ID="StringLiteral">"171-182"</FONT>);
<FONT ID="LN">272 </FONT><A NAME="272"></A>    additional.setValue(Field.PUBLISHER, <FONT ID="StringLiteral">"Springer"</FONT>);
<FONT ID="LN">273 </FONT><A NAME="273"></A>    
<FONT ID="LN">274 </FONT><A NAME="274"></A>    additional = result.add(Type.INPROCEEDINGS);
<FONT ID="LN">275 </FONT><A NAME="275"></A>    additional.setValue(Field.AUTHOR, <FONT ID="StringLiteral">"Marko Robnik-Sikonja and Igor Kononenko"</FONT>);
<FONT ID="LN">276 </FONT><A NAME="276"></A>    additional.setValue(Field.TITLE, <FONT ID="StringLiteral">"An adaptation of Relief for attribute estimation in regression"</FONT>);
<FONT ID="LN">277 </FONT><A NAME="277"></A>    additional.setValue(Field.BOOKTITLE, <FONT ID="StringLiteral">"Fourteenth International Conference on Machine Learning"</FONT>);
<FONT ID="LN">278 </FONT><A NAME="278"></A>    additional.setValue(Field.EDITOR, <FONT ID="StringLiteral">"Douglas H. Fisher"</FONT>);
<FONT ID="LN">279 </FONT><A NAME="279"></A>    additional.setValue(Field.YEAR, <FONT ID="StringLiteral">"1997"</FONT>);
<FONT ID="LN">280 </FONT><A NAME="280"></A>    additional.setValue(Field.PAGES, <FONT ID="StringLiteral">"296-304"</FONT>);
<FONT ID="LN">281 </FONT><A NAME="281"></A>    additional.setValue(Field.PUBLISHER, <FONT ID="StringLiteral">"Morgan Kaufmann"</FONT>);
<FONT ID="LN">282 </FONT><A NAME="282"></A>    
<FONT ID="LN">283 </FONT><A NAME="283"></A>    <FONT ID="Return">return</FONT> result;
<FONT ID="LN">284 </FONT><A NAME="284"></A>  }
<FONT ID="LN">285 </FONT><A NAME="285"></A>
<FONT ID="LN">286 </FONT><A NAME="286"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">287 </FONT><A NAME="287"></A>   * Returns an enumeration describing the available options.
<FONT ID="LN">288 </FONT><A NAME="288"></A>   * @return an enumeration of all the available options.
<FONT ID="LN">289 </FONT><A NAME="289"></A>   **/</FONT>
<FONT ID="LN">290 </FONT><A NAME="290"></A>  <FONT ID="Public">public</FONT> Enumeration listOptions () {
<FONT ID="LN">291 </FONT><A NAME="291"></A>    Vector newVector = <FONT ID="New">new</FONT> Vector(<FONT ID="IntegerLiteral">4</FONT>);
<FONT ID="LN">292 </FONT><A NAME="292"></A>    newVector
<FONT ID="LN">293 </FONT><A NAME="293"></A>      .addElement(<FONT ID="New">new</FONT> <A HREF="../../weka/core/Option.java.html">Option</A>(<FONT ID="StringLiteral">"\tSpecify the number of instances to\n"</FONT> 
<FONT ID="LN">294 </FONT><A NAME="294"></A>                             + <FONT ID="StringLiteral">"\tsample when estimating attributes.\n"</FONT> 
<FONT ID="LN">295 </FONT><A NAME="295"></A>                             + <FONT ID="StringLiteral">"\tIf not specified, then all instances\n"</FONT> 
<FONT ID="LN">296 </FONT><A NAME="296"></A>                             + <FONT ID="StringLiteral">"\twill be used."</FONT>, <FONT ID="StringLiteral">"M"</FONT>, <FONT ID="IntegerLiteral">1</FONT>
<FONT ID="LN">297 </FONT><A NAME="297"></A>                             , <FONT ID="StringLiteral">"-M &lt;num instances&gt;"</FONT>));
<FONT ID="LN">298 </FONT><A NAME="298"></A>    newVector.
<FONT ID="LN">299 </FONT><A NAME="299"></A>      addElement(<FONT ID="New">new</FONT> <A HREF="../../weka/core/Option.java.html">Option</A>(<FONT ID="StringLiteral">"\tSeed for randomly sampling instances.\n"</FONT> 
<FONT ID="LN">300 </FONT><A NAME="300"></A>                            + <FONT ID="StringLiteral">"\t(Default = 1)"</FONT>, <FONT ID="StringLiteral">"D"</FONT>, <FONT ID="IntegerLiteral">1</FONT>
<FONT ID="LN">301 </FONT><A NAME="301"></A>                            , <FONT ID="StringLiteral">"-D &lt;seed&gt;"</FONT>));
<FONT ID="LN">302 </FONT><A NAME="302"></A>    newVector.
<FONT ID="LN">303 </FONT><A NAME="303"></A>      addElement(<FONT ID="New">new</FONT> <A HREF="../../weka/core/Option.java.html">Option</A>(<FONT ID="StringLiteral">"\tNumber of nearest neighbours (k) used\n"</FONT> 
<FONT ID="LN">304 </FONT><A NAME="304"></A>                            + <FONT ID="StringLiteral">"\tto estimate attribute relevances\n"</FONT> 
<FONT ID="LN">305 </FONT><A NAME="305"></A>                            + <FONT ID="StringLiteral">"\t(Default = 10)."</FONT>, <FONT ID="StringLiteral">"K"</FONT>, <FONT ID="IntegerLiteral">1</FONT>
<FONT ID="LN">306 </FONT><A NAME="306"></A>                            , <FONT ID="StringLiteral">"-K &lt;number of neighbours&gt;"</FONT>));
<FONT ID="LN">307 </FONT><A NAME="307"></A>    newVector.
<FONT ID="LN">308 </FONT><A NAME="308"></A>      addElement(<FONT ID="New">new</FONT> <A HREF="../../weka/core/Option.java.html">Option</A>(<FONT ID="StringLiteral">"\tWeight nearest neighbours by distance"</FONT>, <FONT ID="StringLiteral">"W"</FONT>
<FONT ID="LN">309 </FONT><A NAME="309"></A>                            , <FONT ID="IntegerLiteral">0</FONT>, <FONT ID="StringLiteral">"-W"</FONT>));
<FONT ID="LN">310 </FONT><A NAME="310"></A>    newVector.
<FONT ID="LN">311 </FONT><A NAME="311"></A>      addElement(<FONT ID="New">new</FONT> <A HREF="../../weka/core/Option.java.html">Option</A>(<FONT ID="StringLiteral">"\tSpecify sigma value (used in an exp\n"</FONT> 
<FONT ID="LN">312 </FONT><A NAME="312"></A>                            + <FONT ID="StringLiteral">"\tfunction to control how quickly\n"</FONT> 
<FONT ID="LN">313 </FONT><A NAME="313"></A>                            + <FONT ID="StringLiteral">"\tweights for more distant instances\n"</FONT> 
<FONT ID="LN">314 </FONT><A NAME="314"></A>                            + <FONT ID="StringLiteral">"\tdecrease. Use in conjunction with -W.\n"</FONT> 
<FONT ID="LN">315 </FONT><A NAME="315"></A>                            + <FONT ID="StringLiteral">"\tSensible value=1/5 to 1/10 of the\n"</FONT> 
<FONT ID="LN">316 </FONT><A NAME="316"></A>                            + <FONT ID="StringLiteral">"\tnumber of nearest neighbours.\n"</FONT> 
<FONT ID="LN">317 </FONT><A NAME="317"></A>                            + <FONT ID="StringLiteral">"\t(Default = 2)"</FONT>, <FONT ID="StringLiteral">"A"</FONT>, <FONT ID="IntegerLiteral">1</FONT>, <FONT ID="StringLiteral">"-A &lt;num&gt;"</FONT>));
<FONT ID="LN">318 </FONT><A NAME="318"></A>    <FONT ID="Return">return</FONT>  newVector.elements();
<FONT ID="LN">319 </FONT><A NAME="319"></A>  }
<FONT ID="LN">320 </FONT><A NAME="320"></A>
<FONT ID="LN">321 </FONT><A NAME="321"></A>
<FONT ID="LN">322 </FONT><A NAME="322"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">323 </FONT><A NAME="323"></A>   * Parses a given list of options. &lt;p/&gt;
<FONT ID="LN">324 </FONT><A NAME="324"></A>   *
<FONT ID="LN">325 </FONT><A NAME="325"></A>   &lt;!-- options-start --&gt;
<FONT ID="LN">326 </FONT><A NAME="326"></A>   * Valid options are: &lt;p/&gt;
<FONT ID="LN">327 </FONT><A NAME="327"></A>   * 
<FONT ID="LN">328 </FONT><A NAME="328"></A>   * &lt;pre&gt; -M &amp;lt;num instances&amp;gt;
<FONT ID="LN">329 </FONT><A NAME="329"></A>   *  Specify the number of instances to
<FONT ID="LN">330 </FONT><A NAME="330"></A>   *  sample when estimating attributes.
<FONT ID="LN">331 </FONT><A NAME="331"></A>   *  If not specified, then all instances
<FONT ID="LN">332 </FONT><A NAME="332"></A>   *  will be used.&lt;/pre&gt;
<FONT ID="LN">333 </FONT><A NAME="333"></A>   * 
<FONT ID="LN">334 </FONT><A NAME="334"></A>   * &lt;pre&gt; -D &amp;lt;seed&amp;gt;
<FONT ID="LN">335 </FONT><A NAME="335"></A>   *  Seed for randomly sampling instances.
<FONT ID="LN">336 </FONT><A NAME="336"></A>   *  (Default = 1)&lt;/pre&gt;
<FONT ID="LN">337 </FONT><A NAME="337"></A>   * 
<FONT ID="LN">338 </FONT><A NAME="338"></A>   * &lt;pre&gt; -K &amp;lt;number of neighbours&amp;gt;
<FONT ID="LN">339 </FONT><A NAME="339"></A>   *  Number of nearest neighbours (k) used
<FONT ID="LN">340 </FONT><A NAME="340"></A>   *  to estimate attribute relevances
<FONT ID="LN">341 </FONT><A NAME="341"></A>   *  (Default = 10).&lt;/pre&gt;
<FONT ID="LN">342 </FONT><A NAME="342"></A>   * 
<FONT ID="LN">343 </FONT><A NAME="343"></A>   * &lt;pre&gt; -W
<FONT ID="LN">344 </FONT><A NAME="344"></A>   *  Weight nearest neighbours by distance&lt;/pre&gt;
<FONT ID="LN">345 </FONT><A NAME="345"></A>   * 
<FONT ID="LN">346 </FONT><A NAME="346"></A>   * &lt;pre&gt; -A &amp;lt;num&amp;gt;
<FONT ID="LN">347 </FONT><A NAME="347"></A>   *  Specify sigma value (used in an exp
<FONT ID="LN">348 </FONT><A NAME="348"></A>   *  function to control how quickly
<FONT ID="LN">349 </FONT><A NAME="349"></A>   *  weights for more distant instances
<FONT ID="LN">350 </FONT><A NAME="350"></A>   *  decrease. Use in conjunction with -W.
<FONT ID="LN">351 </FONT><A NAME="351"></A>   *  Sensible value=1/5 to 1/10 of the
<FONT ID="LN">352 </FONT><A NAME="352"></A>   *  number of nearest neighbours.
<FONT ID="LN">353 </FONT><A NAME="353"></A>   *  (Default = 2)&lt;/pre&gt;
<FONT ID="LN">354 </FONT><A NAME="354"></A>   * 
<FONT ID="LN">355 </FONT><A NAME="355"></A>   &lt;!-- options-end --&gt;
<FONT ID="LN">356 </FONT><A NAME="356"></A>   *
<FONT ID="LN">357 </FONT><A NAME="357"></A>   * @param options the list of options as an array of strings
<FONT ID="LN">358 </FONT><A NAME="358"></A>   * @throws Exception if an option is not supported
<FONT ID="LN">359 </FONT><A NAME="359"></A>   */</FONT>
<FONT ID="LN">360 </FONT><A NAME="360"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setOptions (String[] options)
<FONT ID="LN">361 </FONT><A NAME="361"></A>    <FONT ID="Throws">throws</FONT> Exception {
<FONT ID="LN">362 </FONT><A NAME="362"></A>    String optionString;
<FONT ID="LN">363 </FONT><A NAME="363"></A>    resetOptions();
<FONT ID="LN">364 </FONT><A NAME="364"></A>    setWeightByDistance(Utils.getFlag(<FONT ID="CharacerLiteral">'W'</FONT>, options));
<FONT ID="LN">365 </FONT><A NAME="365"></A>    optionString = Utils.getOption(<FONT ID="CharacerLiteral">'M'</FONT>, options);
<FONT ID="LN">366 </FONT><A NAME="366"></A>
<FONT ID="LN">367 </FONT><A NAME="367"></A>    <FONT ID="If">if</FONT> (optionString.length() != <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">368 </FONT><A NAME="368"></A>      setSampleSize(Integer.parseInt(optionString));
<FONT ID="LN">369 </FONT><A NAME="369"></A>    }
<FONT ID="LN">370 </FONT><A NAME="370"></A>
<FONT ID="LN">371 </FONT><A NAME="371"></A>    optionString = Utils.getOption(<FONT ID="CharacerLiteral">'D'</FONT>, options);
<FONT ID="LN">372 </FONT><A NAME="372"></A>
<FONT ID="LN">373 </FONT><A NAME="373"></A>    <FONT ID="If">if</FONT> (optionString.length() != <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">374 </FONT><A NAME="374"></A>      setSeed(Integer.parseInt(optionString));
<FONT ID="LN">375 </FONT><A NAME="375"></A>    }
<FONT ID="LN">376 </FONT><A NAME="376"></A>
<FONT ID="LN">377 </FONT><A NAME="377"></A>    optionString = Utils.getOption(<FONT ID="CharacerLiteral">'K'</FONT>, options);
<FONT ID="LN">378 </FONT><A NAME="378"></A>
<FONT ID="LN">379 </FONT><A NAME="379"></A>    <FONT ID="If">if</FONT> (optionString.length() != <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">380 </FONT><A NAME="380"></A>      setNumNeighbours(Integer.parseInt(optionString));
<FONT ID="LN">381 </FONT><A NAME="381"></A>    }
<FONT ID="LN">382 </FONT><A NAME="382"></A>
<FONT ID="LN">383 </FONT><A NAME="383"></A>    optionString = Utils.getOption(<FONT ID="CharacerLiteral">'A'</FONT>, options);
<FONT ID="LN">384 </FONT><A NAME="384"></A>
<FONT ID="LN">385 </FONT><A NAME="385"></A>    <FONT ID="If">if</FONT> (optionString.length() != <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">386 </FONT><A NAME="386"></A>      setWeightByDistance(<FONT ID="True">true</FONT>); <FONT ID="SingleLineComment">// turn on weighting by distance
<FONT ID="LN">387 </FONT><A NAME="387"></A></FONT>      setSigma(Integer.parseInt(optionString));
<FONT ID="LN">388 </FONT><A NAME="388"></A>    }
<FONT ID="LN">389 </FONT><A NAME="389"></A>  }
<FONT ID="LN">390 </FONT><A NAME="390"></A>
<FONT ID="LN">391 </FONT><A NAME="391"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">392 </FONT><A NAME="392"></A>   * Returns the tip text for this property
<FONT ID="LN">393 </FONT><A NAME="393"></A>   * @return tip text for this property suitable for
<FONT ID="LN">394 </FONT><A NAME="394"></A>   * displaying in the explorer/experimenter gui
<FONT ID="LN">395 </FONT><A NAME="395"></A>   */</FONT>
<FONT ID="LN">396 </FONT><A NAME="396"></A>  <FONT ID="Public">public</FONT> String sigmaTipText() {
<FONT ID="LN">397 </FONT><A NAME="397"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"Set influence of nearest neighbours. Used in an exp function to "</FONT>
<FONT ID="LN">398 </FONT><A NAME="398"></A>      +<FONT ID="StringLiteral">"control how quickly weights decrease for more distant instances. "</FONT>
<FONT ID="LN">399 </FONT><A NAME="399"></A>      +<FONT ID="StringLiteral">"Use in conjunction with weightByDistance. Sensible values = 1/5 to "</FONT>
<FONT ID="LN">400 </FONT><A NAME="400"></A>      +<FONT ID="StringLiteral">"1/10 the number of nearest neighbours."</FONT>;
<FONT ID="LN">401 </FONT><A NAME="401"></A>  }
<FONT ID="LN">402 </FONT><A NAME="402"></A>
<FONT ID="LN">403 </FONT><A NAME="403"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">404 </FONT><A NAME="404"></A>   * Sets the sigma value.
<FONT ID="LN">405 </FONT><A NAME="405"></A>   *
<FONT ID="LN">406 </FONT><A NAME="406"></A>   * @param s the value of sigma (&gt; 0)
<FONT ID="LN">407 </FONT><A NAME="407"></A>   * @throws Exception if s is not positive
<FONT ID="LN">408 </FONT><A NAME="408"></A>   */</FONT>
<FONT ID="LN">409 </FONT><A NAME="409"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setSigma (<FONT ID="Int">int</FONT> s)
<FONT ID="LN">410 </FONT><A NAME="410"></A>    <FONT ID="Throws">throws</FONT> Exception {
<FONT ID="LN">411 </FONT><A NAME="411"></A>    <FONT ID="If">if</FONT> (s &lt;= <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">412 </FONT><A NAME="412"></A>      <FONT ID="Throw">throw</FONT>  <FONT ID="New">new</FONT> Exception(<FONT ID="StringLiteral">"value of sigma must be &gt; 0!"</FONT>);
<FONT ID="LN">413 </FONT><A NAME="413"></A>    }
<FONT ID="LN">414 </FONT><A NAME="414"></A>
<FONT ID="LN">415 </FONT><A NAME="415"></A>    m_sigma = s;
<FONT ID="LN">416 </FONT><A NAME="416"></A>  }
<FONT ID="LN">417 </FONT><A NAME="417"></A>
<FONT ID="LN">418 </FONT><A NAME="418"></A>
<FONT ID="LN">419 </FONT><A NAME="419"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">420 </FONT><A NAME="420"></A>   * Get the value of sigma.
<FONT ID="LN">421 </FONT><A NAME="421"></A>   *
<FONT ID="LN">422 </FONT><A NAME="422"></A>   * @return the sigma value.
<FONT ID="LN">423 </FONT><A NAME="423"></A>   */</FONT>
<FONT ID="LN">424 </FONT><A NAME="424"></A>  <FONT ID="Public">public</FONT> <FONT ID="Int">int</FONT> getSigma () {
<FONT ID="LN">425 </FONT><A NAME="425"></A>    <FONT ID="Return">return</FONT>  m_sigma;
<FONT ID="LN">426 </FONT><A NAME="426"></A>  }
<FONT ID="LN">427 </FONT><A NAME="427"></A>
<FONT ID="LN">428 </FONT><A NAME="428"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">429 </FONT><A NAME="429"></A>   * Returns the tip text for this property
<FONT ID="LN">430 </FONT><A NAME="430"></A>   * @return tip text for this property suitable for
<FONT ID="LN">431 </FONT><A NAME="431"></A>   * displaying in the explorer/experimenter gui
<FONT ID="LN">432 </FONT><A NAME="432"></A>   */</FONT>
<FONT ID="LN">433 </FONT><A NAME="433"></A>  <FONT ID="Public">public</FONT> String numNeighboursTipText() {
<FONT ID="LN">434 </FONT><A NAME="434"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"Number of nearest neighbours for attribute estimation."</FONT>;
<FONT ID="LN">435 </FONT><A NAME="435"></A>  }
<FONT ID="LN">436 </FONT><A NAME="436"></A>
<FONT ID="LN">437 </FONT><A NAME="437"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">438 </FONT><A NAME="438"></A>   * Set the number of nearest neighbours
<FONT ID="LN">439 </FONT><A NAME="439"></A>   *
<FONT ID="LN">440 </FONT><A NAME="440"></A>   * @param n the number of nearest neighbours.
<FONT ID="LN">441 </FONT><A NAME="441"></A>   */</FONT>
<FONT ID="LN">442 </FONT><A NAME="442"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setNumNeighbours (<FONT ID="Int">int</FONT> n) {
<FONT ID="LN">443 </FONT><A NAME="443"></A>    m_Knn = n;
<FONT ID="LN">444 </FONT><A NAME="444"></A>  }
<FONT ID="LN">445 </FONT><A NAME="445"></A>
<FONT ID="LN">446 </FONT><A NAME="446"></A>
<FONT ID="LN">447 </FONT><A NAME="447"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">448 </FONT><A NAME="448"></A>   * Get the number of nearest neighbours
<FONT ID="LN">449 </FONT><A NAME="449"></A>   *
<FONT ID="LN">450 </FONT><A NAME="450"></A>   * @return the number of nearest neighbours
<FONT ID="LN">451 </FONT><A NAME="451"></A>   */</FONT>
<FONT ID="LN">452 </FONT><A NAME="452"></A>  <FONT ID="Public">public</FONT> <FONT ID="Int">int</FONT> getNumNeighbours () {
<FONT ID="LN">453 </FONT><A NAME="453"></A>    <FONT ID="Return">return</FONT>  m_Knn;
<FONT ID="LN">454 </FONT><A NAME="454"></A>  }
<FONT ID="LN">455 </FONT><A NAME="455"></A>
<FONT ID="LN">456 </FONT><A NAME="456"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">457 </FONT><A NAME="457"></A>   * Returns the tip text for this property
<FONT ID="LN">458 </FONT><A NAME="458"></A>   * @return tip text for this property suitable for
<FONT ID="LN">459 </FONT><A NAME="459"></A>   * displaying in the explorer/experimenter gui
<FONT ID="LN">460 </FONT><A NAME="460"></A>   */</FONT>
<FONT ID="LN">461 </FONT><A NAME="461"></A>  <FONT ID="Public">public</FONT> String seedTipText() {
<FONT ID="LN">462 </FONT><A NAME="462"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"Random seed for sampling instances."</FONT>;
<FONT ID="LN">463 </FONT><A NAME="463"></A>  }
<FONT ID="LN">464 </FONT><A NAME="464"></A>
<FONT ID="LN">465 </FONT><A NAME="465"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">466 </FONT><A NAME="466"></A>   * Set the random number seed for randomly sampling instances.
<FONT ID="LN">467 </FONT><A NAME="467"></A>   *
<FONT ID="LN">468 </FONT><A NAME="468"></A>   * @param s the random number seed.
<FONT ID="LN">469 </FONT><A NAME="469"></A>   */</FONT>
<FONT ID="LN">470 </FONT><A NAME="470"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setSeed (<FONT ID="Int">int</FONT> s) {
<FONT ID="LN">471 </FONT><A NAME="471"></A>    m_seed = s;
<FONT ID="LN">472 </FONT><A NAME="472"></A>  }
<FONT ID="LN">473 </FONT><A NAME="473"></A>
<FONT ID="LN">474 </FONT><A NAME="474"></A>
<FONT ID="LN">475 </FONT><A NAME="475"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">476 </FONT><A NAME="476"></A>   * Get the seed used for randomly sampling instances.
<FONT ID="LN">477 </FONT><A NAME="477"></A>   *
<FONT ID="LN">478 </FONT><A NAME="478"></A>   * @return the random number seed.
<FONT ID="LN">479 </FONT><A NAME="479"></A>   */</FONT>
<FONT ID="LN">480 </FONT><A NAME="480"></A>  <FONT ID="Public">public</FONT> <FONT ID="Int">int</FONT> getSeed () {
<FONT ID="LN">481 </FONT><A NAME="481"></A>    <FONT ID="Return">return</FONT>  m_seed;
<FONT ID="LN">482 </FONT><A NAME="482"></A>  }
<FONT ID="LN">483 </FONT><A NAME="483"></A>
<FONT ID="LN">484 </FONT><A NAME="484"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">485 </FONT><A NAME="485"></A>   * Returns the tip text for this property
<FONT ID="LN">486 </FONT><A NAME="486"></A>   * @return tip text for this property suitable for
<FONT ID="LN">487 </FONT><A NAME="487"></A>   * displaying in the explorer/experimenter gui
<FONT ID="LN">488 </FONT><A NAME="488"></A>   */</FONT>
<FONT ID="LN">489 </FONT><A NAME="489"></A>  <FONT ID="Public">public</FONT> String sampleSizeTipText() {
<FONT ID="LN">490 </FONT><A NAME="490"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"Number of instances to sample. Default (-1) indicates that all "</FONT>
<FONT ID="LN">491 </FONT><A NAME="491"></A>      +<FONT ID="StringLiteral">"instances will be used for attribute estimation."</FONT>;
<FONT ID="LN">492 </FONT><A NAME="492"></A>  }
<FONT ID="LN">493 </FONT><A NAME="493"></A>
<FONT ID="LN">494 </FONT><A NAME="494"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">495 </FONT><A NAME="495"></A>   * Set the number of instances to sample for attribute estimation
<FONT ID="LN">496 </FONT><A NAME="496"></A>   *
<FONT ID="LN">497 </FONT><A NAME="497"></A>   * @param s the number of instances to sample.
<FONT ID="LN">498 </FONT><A NAME="498"></A>   */</FONT>
<FONT ID="LN">499 </FONT><A NAME="499"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setSampleSize (<FONT ID="Int">int</FONT> s) {
<FONT ID="LN">500 </FONT><A NAME="500"></A>    m_sampleM = s;
<FONT ID="LN">501 </FONT><A NAME="501"></A>  }
<FONT ID="LN">502 </FONT><A NAME="502"></A>
<FONT ID="LN">503 </FONT><A NAME="503"></A>
<FONT ID="LN">504 </FONT><A NAME="504"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">505 </FONT><A NAME="505"></A>   * Get the number of instances used for estimating attributes
<FONT ID="LN">506 </FONT><A NAME="506"></A>   *
<FONT ID="LN">507 </FONT><A NAME="507"></A>   * @return the number of instances.
<FONT ID="LN">508 </FONT><A NAME="508"></A>   */</FONT>
<FONT ID="LN">509 </FONT><A NAME="509"></A>  <FONT ID="Public">public</FONT> <FONT ID="Int">int</FONT> getSampleSize () {
<FONT ID="LN">510 </FONT><A NAME="510"></A>    <FONT ID="Return">return</FONT>  m_sampleM;
<FONT ID="LN">511 </FONT><A NAME="511"></A>  }
<FONT ID="LN">512 </FONT><A NAME="512"></A>
<FONT ID="LN">513 </FONT><A NAME="513"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">514 </FONT><A NAME="514"></A>   * Returns the tip text for this property
<FONT ID="LN">515 </FONT><A NAME="515"></A>   * @return tip text for this property suitable for
<FONT ID="LN">516 </FONT><A NAME="516"></A>   * displaying in the explorer/experimenter gui
<FONT ID="LN">517 </FONT><A NAME="517"></A>   */</FONT>
<FONT ID="LN">518 </FONT><A NAME="518"></A>  <FONT ID="Public">public</FONT> String weightByDistanceTipText() {
<FONT ID="LN">519 </FONT><A NAME="519"></A>    <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">"Weight nearest neighbours by their distance."</FONT>;
<FONT ID="LN">520 </FONT><A NAME="520"></A>  }
<FONT ID="LN">521 </FONT><A NAME="521"></A>
<FONT ID="LN">522 </FONT><A NAME="522"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">523 </FONT><A NAME="523"></A>   * Set the nearest neighbour weighting method
<FONT ID="LN">524 </FONT><A NAME="524"></A>   *
<FONT ID="LN">525 </FONT><A NAME="525"></A>   * @param b true nearest neighbours are to be weighted by distance.
<FONT ID="LN">526 </FONT><A NAME="526"></A>   */</FONT>
<FONT ID="LN">527 </FONT><A NAME="527"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> setWeightByDistance (<FONT ID="Boolean">boolean</FONT> b) {
<FONT ID="LN">528 </FONT><A NAME="528"></A>    m_weightByDistance = b;
<FONT ID="LN">529 </FONT><A NAME="529"></A>  }
<FONT ID="LN">530 </FONT><A NAME="530"></A>
<FONT ID="LN">531 </FONT><A NAME="531"></A>
<FONT ID="LN">532 </FONT><A NAME="532"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">533 </FONT><A NAME="533"></A>   * Get whether nearest neighbours are being weighted by distance
<FONT ID="LN">534 </FONT><A NAME="534"></A>   *
<FONT ID="LN">535 </FONT><A NAME="535"></A>   * @return m_weightByDiffernce
<FONT ID="LN">536 </FONT><A NAME="536"></A>   */</FONT>
<FONT ID="LN">537 </FONT><A NAME="537"></A>  <FONT ID="Public">public</FONT> <FONT ID="Boolean">boolean</FONT> getWeightByDistance () {
<FONT ID="LN">538 </FONT><A NAME="538"></A>    <FONT ID="Return">return</FONT>  m_weightByDistance;
<FONT ID="LN">539 </FONT><A NAME="539"></A>  }
<FONT ID="LN">540 </FONT><A NAME="540"></A>
<FONT ID="LN">541 </FONT><A NAME="541"></A>
<FONT ID="LN">542 </FONT><A NAME="542"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">543 </FONT><A NAME="543"></A>   * Gets the current settings of ReliefFAttributeEval.
<FONT ID="LN">544 </FONT><A NAME="544"></A>   *
<FONT ID="LN">545 </FONT><A NAME="545"></A>   * @return an array of strings suitable for passing to setOptions()
<FONT ID="LN">546 </FONT><A NAME="546"></A>   */</FONT>
<FONT ID="LN">547 </FONT><A NAME="547"></A>  <FONT ID="Public">public</FONT> String[] getOptions () {
<FONT ID="LN">548 </FONT><A NAME="548"></A>    String[] options = <FONT ID="New">new</FONT> String[<FONT ID="IntegerLiteral">9</FONT>];
<FONT ID="LN">549 </FONT><A NAME="549"></A>    <FONT ID="Int">int</FONT> current = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">550 </FONT><A NAME="550"></A>
<FONT ID="LN">551 </FONT><A NAME="551"></A>    <FONT ID="If">if</FONT> (getWeightByDistance()) {
<FONT ID="LN">552 </FONT><A NAME="552"></A>      options[current++] = <FONT ID="StringLiteral">"-W"</FONT>;
<FONT ID="LN">553 </FONT><A NAME="553"></A>    }
<FONT ID="LN">554 </FONT><A NAME="554"></A>
<FONT ID="LN">555 </FONT><A NAME="555"></A>    options[current++] = <FONT ID="StringLiteral">"-M"</FONT>;
<FONT ID="LN">556 </FONT><A NAME="556"></A>    options[current++] = <FONT ID="StringLiteral">""</FONT> + getSampleSize();
<FONT ID="LN">557 </FONT><A NAME="557"></A>    options[current++] = <FONT ID="StringLiteral">"-D"</FONT>;
<FONT ID="LN">558 </FONT><A NAME="558"></A>    options[current++] = <FONT ID="StringLiteral">""</FONT> + getSeed();
<FONT ID="LN">559 </FONT><A NAME="559"></A>    options[current++] = <FONT ID="StringLiteral">"-K"</FONT>;
<FONT ID="LN">560 </FONT><A NAME="560"></A>    options[current++] = <FONT ID="StringLiteral">""</FONT> + getNumNeighbours();
<FONT ID="LN">561 </FONT><A NAME="561"></A>    
<FONT ID="LN">562 </FONT><A NAME="562"></A>    <FONT ID="If">if</FONT> (getWeightByDistance()) {
<FONT ID="LN">563 </FONT><A NAME="563"></A>      options[current++] = <FONT ID="StringLiteral">"-A"</FONT>;
<FONT ID="LN">564 </FONT><A NAME="564"></A>      options[current++] = <FONT ID="StringLiteral">""</FONT> + getSigma();
<FONT ID="LN">565 </FONT><A NAME="565"></A>    }
<FONT ID="LN">566 </FONT><A NAME="566"></A>
<FONT ID="LN">567 </FONT><A NAME="567"></A>    <FONT ID="While">while</FONT> (current &lt; options.length) {
<FONT ID="LN">568 </FONT><A NAME="568"></A>      options[current++] = <FONT ID="StringLiteral">""</FONT>;
<FONT ID="LN">569 </FONT><A NAME="569"></A>    }
<FONT ID="LN">570 </FONT><A NAME="570"></A>
<FONT ID="LN">571 </FONT><A NAME="571"></A>    <FONT ID="Return">return</FONT>  options;
<FONT ID="LN">572 </FONT><A NAME="572"></A>  }
<FONT ID="LN">573 </FONT><A NAME="573"></A>
<FONT ID="LN">574 </FONT><A NAME="574"></A>
<FONT ID="LN">575 </FONT><A NAME="575"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">576 </FONT><A NAME="576"></A>   * Return a description of the ReliefF attribute evaluator.
<FONT ID="LN">577 </FONT><A NAME="577"></A>   *
<FONT ID="LN">578 </FONT><A NAME="578"></A>   * @return a description of the evaluator as a String.
<FONT ID="LN">579 </FONT><A NAME="579"></A>   */</FONT>
<FONT ID="LN">580 </FONT><A NAME="580"></A>  <FONT ID="Public">public</FONT> String toString () {
<FONT ID="LN">581 </FONT><A NAME="581"></A>    StringBuffer text = <FONT ID="New">new</FONT> StringBuffer();
<FONT ID="LN">582 </FONT><A NAME="582"></A>
<FONT ID="LN">583 </FONT><A NAME="583"></A>    <FONT ID="If">if</FONT> (m_trainInstances == <FONT ID="Null">null</FONT>) {
<FONT ID="LN">584 </FONT><A NAME="584"></A>      text.append(<FONT ID="StringLiteral">"ReliefF feature evaluator has not been built yet\n"</FONT>);
<FONT ID="LN">585 </FONT><A NAME="585"></A>    }
<FONT ID="LN">586 </FONT><A NAME="586"></A>    <FONT ID="Else">else</FONT> {
<FONT ID="LN">587 </FONT><A NAME="587"></A>      text.append(<FONT ID="StringLiteral">"\tReliefF Ranking Filter"</FONT>);
<FONT ID="LN">588 </FONT><A NAME="588"></A>      text.append(<FONT ID="StringLiteral">"\n\tInstances sampled: "</FONT>);
<FONT ID="LN">589 </FONT><A NAME="589"></A>
<FONT ID="LN">590 </FONT><A NAME="590"></A>      <FONT ID="If">if</FONT> (m_sampleM == -<FONT ID="IntegerLiteral">1</FONT>) {
<FONT ID="LN">591 </FONT><A NAME="591"></A>        text.append(<FONT ID="StringLiteral">"all\n"</FONT>);
<FONT ID="LN">592 </FONT><A NAME="592"></A>      }
<FONT ID="LN">593 </FONT><A NAME="593"></A>      <FONT ID="Else">else</FONT> {
<FONT ID="LN">594 </FONT><A NAME="594"></A>        text.append(m_sampleM + <FONT ID="StringLiteral">"\n"</FONT>);
<FONT ID="LN">595 </FONT><A NAME="595"></A>      }
<FONT ID="LN">596 </FONT><A NAME="596"></A>
<FONT ID="LN">597 </FONT><A NAME="597"></A>      text.append(<FONT ID="StringLiteral">"\tNumber of nearest neighbours (k): "</FONT> + m_Knn + <FONT ID="StringLiteral">"\n"</FONT>);
<FONT ID="LN">598 </FONT><A NAME="598"></A>
<FONT ID="LN">599 </FONT><A NAME="599"></A>      <FONT ID="If">if</FONT> (m_weightByDistance) {
<FONT ID="LN">600 </FONT><A NAME="600"></A>        text.append(<FONT ID="StringLiteral">"\tExponentially decreasing (with distance) "</FONT> 
<FONT ID="LN">601 </FONT><A NAME="601"></A>                    + <FONT ID="StringLiteral">"influence for\n"</FONT> 
<FONT ID="LN">602 </FONT><A NAME="602"></A>                    + <FONT ID="StringLiteral">"\tnearest neighbours. Sigma: "</FONT> 
<FONT ID="LN">603 </FONT><A NAME="603"></A>                    + m_sigma + <FONT ID="StringLiteral">"\n"</FONT>);
<FONT ID="LN">604 </FONT><A NAME="604"></A>      }
<FONT ID="LN">605 </FONT><A NAME="605"></A>      <FONT ID="Else">else</FONT> {
<FONT ID="LN">606 </FONT><A NAME="606"></A>        text.append(<FONT ID="StringLiteral">"\tEqual influence nearest neighbours\n"</FONT>);
<FONT ID="LN">607 </FONT><A NAME="607"></A>      }
<FONT ID="LN">608 </FONT><A NAME="608"></A>    }
<FONT ID="LN">609 </FONT><A NAME="609"></A>
<FONT ID="LN">610 </FONT><A NAME="610"></A>    <FONT ID="Return">return</FONT>  text.toString();
<FONT ID="LN">611 </FONT><A NAME="611"></A>  }
<FONT ID="LN">612 </FONT><A NAME="612"></A>
<FONT ID="LN">613 </FONT><A NAME="613"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">614 </FONT><A NAME="614"></A>   * Returns the capabilities of this evaluator.
<FONT ID="LN">615 </FONT><A NAME="615"></A>   *
<FONT ID="LN">616 </FONT><A NAME="616"></A>   * @return            the capabilities of this evaluator
<FONT ID="LN">617 </FONT><A NAME="617"></A>   * @see               Capabilities
<FONT ID="LN">618 </FONT><A NAME="618"></A>   */</FONT>
<FONT ID="LN">619 </FONT><A NAME="619"></A>  <FONT ID="Public">public</FONT> <A HREF="../../weka/core/Capabilities.java.html">Capabilities</A> getCapabilities() {
<FONT ID="LN">620 </FONT><A NAME="620"></A>    <A HREF="../../weka/core/Capabilities.java.html">Capabilities</A> result = <FONT ID="Super">super</FONT>.getCapabilities();
<FONT ID="LN">621 </FONT><A NAME="621"></A>    result.disableAll();
<FONT ID="LN">622 </FONT><A NAME="622"></A>    
<FONT ID="LN">623 </FONT><A NAME="623"></A>    <FONT ID="SingleLineComment">// attributes
<FONT ID="LN">624 </FONT><A NAME="624"></A></FONT>    result.enable(Capability.NOMINAL_ATTRIBUTES);
<FONT ID="LN">625 </FONT><A NAME="625"></A>    result.enable(Capability.NUMERIC_ATTRIBUTES);
<FONT ID="LN">626 </FONT><A NAME="626"></A>    result.enable(Capability.DATE_ATTRIBUTES);
<FONT ID="LN">627 </FONT><A NAME="627"></A>    result.enable(Capability.MISSING_VALUES);
<FONT ID="LN">628 </FONT><A NAME="628"></A>    
<FONT ID="LN">629 </FONT><A NAME="629"></A>    <FONT ID="SingleLineComment">// class
<FONT ID="LN">630 </FONT><A NAME="630"></A></FONT>    result.enable(Capability.NOMINAL_CLASS);
<FONT ID="LN">631 </FONT><A NAME="631"></A>    result.enable(Capability.NUMERIC_CLASS);
<FONT ID="LN">632 </FONT><A NAME="632"></A>    result.enable(Capability.DATE_CLASS);
<FONT ID="LN">633 </FONT><A NAME="633"></A>    result.enable(Capability.MISSING_CLASS_VALUES);
<FONT ID="LN">634 </FONT><A NAME="634"></A>    
<FONT ID="LN">635 </FONT><A NAME="635"></A>    <FONT ID="Return">return</FONT> result;
<FONT ID="LN">636 </FONT><A NAME="636"></A>  }
<FONT ID="LN">637 </FONT><A NAME="637"></A>
<FONT ID="LN">638 </FONT><A NAME="638"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">639 </FONT><A NAME="639"></A>   * Initializes a ReliefF attribute evaluator. 
<FONT ID="LN">640 </FONT><A NAME="640"></A>   *
<FONT ID="LN">641 </FONT><A NAME="641"></A>   * @param data set of instances serving as training data 
<FONT ID="LN">642 </FONT><A NAME="642"></A>   * @throws Exception if the evaluator has not been 
<FONT ID="LN">643 </FONT><A NAME="643"></A>   * generated successfully
<FONT ID="LN">644 </FONT><A NAME="644"></A>   */</FONT>
<FONT ID="LN">645 </FONT><A NAME="645"></A>  <FONT ID="Public">public</FONT> <FONT ID="Void">void</FONT> buildEvaluator (<A HREF="../../weka/core/Instances.java.html">Instances</A> data)
<FONT ID="LN">646 </FONT><A NAME="646"></A>    <FONT ID="Throws">throws</FONT> Exception {
<FONT ID="LN">647 </FONT><A NAME="647"></A>    
<FONT ID="LN">648 </FONT><A NAME="648"></A>    <FONT ID="Int">int</FONT> z, totalInstances;
<FONT ID="LN">649 </FONT><A NAME="649"></A>    Random r = <FONT ID="New">new</FONT> Random(m_seed);
<FONT ID="LN">650 </FONT><A NAME="650"></A>
<FONT ID="LN">651 </FONT><A NAME="651"></A>    <FONT ID="SingleLineComment">// can evaluator handle data?
<FONT ID="LN">652 </FONT><A NAME="652"></A></FONT>    getCapabilities().testWithFail(data);
<FONT ID="LN">653 </FONT><A NAME="653"></A>
<FONT ID="LN">654 </FONT><A NAME="654"></A>    m_trainInstances = data;
<FONT ID="LN">655 </FONT><A NAME="655"></A>    m_classIndex = m_trainInstances.classIndex();
<FONT ID="LN">656 </FONT><A NAME="656"></A>    m_numAttribs = m_trainInstances.numAttributes();
<FONT ID="LN">657 </FONT><A NAME="657"></A>    m_numInstances = m_trainInstances.numInstances();
<FONT ID="LN">658 </FONT><A NAME="658"></A>
<FONT ID="LN">659 </FONT><A NAME="659"></A>    <FONT ID="If">if</FONT> (m_trainInstances.attribute(m_classIndex).isNumeric()) {
<FONT ID="LN">660 </FONT><A NAME="660"></A>      m_numericClass = <FONT ID="True">true</FONT>;
<FONT ID="LN">661 </FONT><A NAME="661"></A>    }
<FONT ID="LN">662 </FONT><A NAME="662"></A>    <FONT ID="Else">else</FONT> {
<FONT ID="LN">663 </FONT><A NAME="663"></A>      m_numericClass = <FONT ID="False">false</FONT>;
<FONT ID="LN">664 </FONT><A NAME="664"></A>    }
<FONT ID="LN">665 </FONT><A NAME="665"></A>
<FONT ID="LN">666 </FONT><A NAME="666"></A>    <FONT ID="If">if</FONT> (!m_numericClass) {
<FONT ID="LN">667 </FONT><A NAME="667"></A>      m_numClasses = m_trainInstances.attribute(m_classIndex).numValues();
<FONT ID="LN">668 </FONT><A NAME="668"></A>    }
<FONT ID="LN">669 </FONT><A NAME="669"></A>    <FONT ID="Else">else</FONT> {
<FONT ID="LN">670 </FONT><A NAME="670"></A>      m_ndc = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">671 </FONT><A NAME="671"></A>      m_numClasses = <FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">672 </FONT><A NAME="672"></A>      m_nda = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numAttribs];
<FONT ID="LN">673 </FONT><A NAME="673"></A>      m_ndcda = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numAttribs];
<FONT ID="LN">674 </FONT><A NAME="674"></A>    }
<FONT ID="LN">675 </FONT><A NAME="675"></A>
<FONT ID="LN">676 </FONT><A NAME="676"></A>    <FONT ID="If">if</FONT> (m_weightByDistance) <FONT ID="SingleLineComment">// set up the rank based weights
<FONT ID="LN">677 </FONT><A NAME="677"></A></FONT>      {
<FONT ID="LN">678 </FONT><A NAME="678"></A>        m_weightsByRank = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_Knn];
<FONT ID="LN">679 </FONT><A NAME="679"></A>
<FONT ID="LN">680 </FONT><A NAME="680"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; m_Knn; i++) {
<FONT ID="LN">681 </FONT><A NAME="681"></A>          m_weightsByRank[i] = 
<FONT ID="LN">682 </FONT><A NAME="682"></A>            Math.exp(-((i/(<FONT ID="Double">double</FONT>)m_sigma)*(i/(<FONT ID="Double">double</FONT>)m_sigma)));
<FONT ID="LN">683 </FONT><A NAME="683"></A>        }
<FONT ID="LN">684 </FONT><A NAME="684"></A>      }
<FONT ID="LN">685 </FONT><A NAME="685"></A>
<FONT ID="LN">686 </FONT><A NAME="686"></A>    <FONT ID="SingleLineComment">// the final attribute weights
<FONT ID="LN">687 </FONT><A NAME="687"></A></FONT>    m_weights = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numAttribs];
<FONT ID="LN">688 </FONT><A NAME="688"></A>    <FONT ID="SingleLineComment">// num classes (1 for numeric class) knn neighbours, 
<FONT ID="LN">689 </FONT><A NAME="689"></A></FONT>    <FONT ID="SingleLineComment">// and 0 = distance, 1 = instance index
<FONT ID="LN">690 </FONT><A NAME="690"></A></FONT>    m_karray = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numClasses][m_Knn][<FONT ID="IntegerLiteral">2</FONT>];
<FONT ID="LN">691 </FONT><A NAME="691"></A>
<FONT ID="LN">692 </FONT><A NAME="692"></A>    <FONT ID="If">if</FONT> (!m_numericClass) {
<FONT ID="LN">693 </FONT><A NAME="693"></A>      m_classProbs = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numClasses];
<FONT ID="LN">694 </FONT><A NAME="694"></A>
<FONT ID="LN">695 </FONT><A NAME="695"></A>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; m_numInstances; i++) {
<FONT ID="LN">696 </FONT><A NAME="696"></A>        m_classProbs[(<FONT ID="Int">int</FONT>)m_trainInstances.instance(i).value(m_classIndex)]++;
<FONT ID="LN">697 </FONT><A NAME="697"></A>      }
<FONT ID="LN">698 </FONT><A NAME="698"></A>
<FONT ID="LN">699 </FONT><A NAME="699"></A>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; m_numClasses; i++) {
<FONT ID="LN">700 </FONT><A NAME="700"></A>        m_classProbs[i] /= m_numInstances;
<FONT ID="LN">701 </FONT><A NAME="701"></A>      }
<FONT ID="LN">702 </FONT><A NAME="702"></A>    }
<FONT ID="LN">703 </FONT><A NAME="703"></A>
<FONT ID="LN">704 </FONT><A NAME="704"></A>    m_worst = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numClasses];
<FONT ID="LN">705 </FONT><A NAME="705"></A>    m_index = <FONT ID="New">new</FONT> <FONT ID="Int">int</FONT>[m_numClasses];
<FONT ID="LN">706 </FONT><A NAME="706"></A>    m_stored = <FONT ID="New">new</FONT> <FONT ID="Int">int</FONT>[m_numClasses];
<FONT ID="LN">707 </FONT><A NAME="707"></A>    m_minArray = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numAttribs];
<FONT ID="LN">708 </FONT><A NAME="708"></A>    m_maxArray = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numAttribs];
<FONT ID="LN">709 </FONT><A NAME="709"></A>
<FONT ID="LN">710 </FONT><A NAME="710"></A>    <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; m_numAttribs; i++) {
<FONT ID="LN">711 </FONT><A NAME="711"></A>      m_minArray[i] = m_maxArray[i] = Double.NaN;
<FONT ID="LN">712 </FONT><A NAME="712"></A>    }
<FONT ID="LN">713 </FONT><A NAME="713"></A>
<FONT ID="LN">714 </FONT><A NAME="714"></A>    <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; m_numInstances; i++) {
<FONT ID="LN">715 </FONT><A NAME="715"></A>      updateMinMax(m_trainInstances.instance(i));
<FONT ID="LN">716 </FONT><A NAME="716"></A>    }
<FONT ID="LN">717 </FONT><A NAME="717"></A>    
<FONT ID="LN">718 </FONT><A NAME="718"></A>    <FONT ID="If">if</FONT> ((m_sampleM &gt; m_numInstances) || (m_sampleM &lt; <FONT ID="IntegerLiteral">0</FONT>)) {
<FONT ID="LN">719 </FONT><A NAME="719"></A>      totalInstances = m_numInstances;
<FONT ID="LN">720 </FONT><A NAME="720"></A>    }
<FONT ID="LN">721 </FONT><A NAME="721"></A>    <FONT ID="Else">else</FONT> {
<FONT ID="LN">722 </FONT><A NAME="722"></A>      totalInstances = m_sampleM;
<FONT ID="LN">723 </FONT><A NAME="723"></A>    }
<FONT ID="LN">724 </FONT><A NAME="724"></A>
<FONT ID="LN">725 </FONT><A NAME="725"></A>    <FONT ID="SingleLineComment">// process each instance, updating attribute weights
<FONT ID="LN">726 </FONT><A NAME="726"></A></FONT>    <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; totalInstances; i++) {
<FONT ID="LN">727 </FONT><A NAME="727"></A>      <FONT ID="If">if</FONT> (totalInstances == m_numInstances) {
<FONT ID="LN">728 </FONT><A NAME="728"></A>        z = i;
<FONT ID="LN">729 </FONT><A NAME="729"></A>      }
<FONT ID="LN">730 </FONT><A NAME="730"></A>      <FONT ID="Else">else</FONT> {
<FONT ID="LN">731 </FONT><A NAME="731"></A>        z = r.nextInt()%m_numInstances;
<FONT ID="LN">732 </FONT><A NAME="732"></A>      }
<FONT ID="LN">733 </FONT><A NAME="733"></A>
<FONT ID="LN">734 </FONT><A NAME="734"></A>      <FONT ID="If">if</FONT> (z &lt; <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">735 </FONT><A NAME="735"></A>        z *= -<FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">736 </FONT><A NAME="736"></A>      }
<FONT ID="LN">737 </FONT><A NAME="737"></A>
<FONT ID="LN">738 </FONT><A NAME="738"></A>      <FONT ID="If">if</FONT> (!(m_trainInstances.instance(z).isMissing(m_classIndex))) {
<FONT ID="LN">739 </FONT><A NAME="739"></A>        <FONT ID="SingleLineComment">// first clear the knn and worst index stuff for the classes
<FONT ID="LN">740 </FONT><A NAME="740"></A></FONT>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> j = <FONT ID="IntegerLiteral">0</FONT>; j &lt; m_numClasses; j++) {
<FONT ID="LN">741 </FONT><A NAME="741"></A>          m_index[j] = m_stored[j] = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">742 </FONT><A NAME="742"></A>
<FONT ID="LN">743 </FONT><A NAME="743"></A>          <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> k = <FONT ID="IntegerLiteral">0</FONT>; k &lt; m_Knn; k++) {
<FONT ID="LN">744 </FONT><A NAME="744"></A>            m_karray[j][k][<FONT ID="IntegerLiteral">0</FONT>] = m_karray[j][k][<FONT ID="IntegerLiteral">1</FONT>] = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">745 </FONT><A NAME="745"></A>          }
<FONT ID="LN">746 </FONT><A NAME="746"></A>        }
<FONT ID="LN">747 </FONT><A NAME="747"></A>
<FONT ID="LN">748 </FONT><A NAME="748"></A>        findKHitMiss(z);
<FONT ID="LN">749 </FONT><A NAME="749"></A>
<FONT ID="LN">750 </FONT><A NAME="750"></A>        <FONT ID="If">if</FONT> (m_numericClass) {
<FONT ID="LN">751 </FONT><A NAME="751"></A>          updateWeightsNumericClass(z);
<FONT ID="LN">752 </FONT><A NAME="752"></A>        }
<FONT ID="LN">753 </FONT><A NAME="753"></A>        <FONT ID="Else">else</FONT> {
<FONT ID="LN">754 </FONT><A NAME="754"></A>          updateWeightsDiscreteClass(z);
<FONT ID="LN">755 </FONT><A NAME="755"></A>        }
<FONT ID="LN">756 </FONT><A NAME="756"></A>      }
<FONT ID="LN">757 </FONT><A NAME="757"></A>    }
<FONT ID="LN">758 </FONT><A NAME="758"></A>
<FONT ID="LN">759 </FONT><A NAME="759"></A>    <FONT ID="SingleLineComment">// now scale weights by 1/m_numInstances (nominal class) or
<FONT ID="LN">760 </FONT><A NAME="760"></A></FONT>    <FONT ID="SingleLineComment">// calculate weights numeric class
<FONT ID="LN">761 </FONT><A NAME="761"></A></FONT>    <FONT ID="SingleLineComment">// System.out.println("num inst:"+m_numInstances+" r_ndc:"+r_ndc);
<FONT ID="LN">762 </FONT><A NAME="762"></A></FONT>    <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; m_numAttribs; i++) {<FONT ID="If">if</FONT> (i != m_classIndex) {
<FONT ID="LN">763 </FONT><A NAME="763"></A>      <FONT ID="If">if</FONT> (m_numericClass) {
<FONT ID="LN">764 </FONT><A NAME="764"></A>        m_weights[i] = m_ndcda[i]/m_ndc - 
<FONT ID="LN">765 </FONT><A NAME="765"></A>          ((m_nda[i] - m_ndcda[i])/((<FONT ID="Double">double</FONT>)totalInstances - m_ndc));
<FONT ID="LN">766 </FONT><A NAME="766"></A>      }
<FONT ID="LN">767 </FONT><A NAME="767"></A>      <FONT ID="Else">else</FONT> {
<FONT ID="LN">768 </FONT><A NAME="768"></A>        m_weights[i] *= (<FONT ID="FloatPointLiteral">1.0</FONT>/(<FONT ID="Double">double</FONT>)totalInstances);
<FONT ID="LN">769 </FONT><A NAME="769"></A>      }
<FONT ID="LN">770 </FONT><A NAME="770"></A>
<FONT ID="LN">771 </FONT><A NAME="771"></A>      <FONT ID="SingleLineComment">//          System.out.println(r_weights[i]);
<FONT ID="LN">772 </FONT><A NAME="772"></A></FONT>    }
<FONT ID="LN">773 </FONT><A NAME="773"></A>    }
<FONT ID="LN">774 </FONT><A NAME="774"></A>  }
<FONT ID="LN">775 </FONT><A NAME="775"></A>
<FONT ID="LN">776 </FONT><A NAME="776"></A>
<FONT ID="LN">777 </FONT><A NAME="777"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">778 </FONT><A NAME="778"></A>   * Evaluates an individual attribute using ReliefF's instance based approach.
<FONT ID="LN">779 </FONT><A NAME="779"></A>   * The actual work is done by buildEvaluator which evaluates all features.
<FONT ID="LN">780 </FONT><A NAME="780"></A>   *
<FONT ID="LN">781 </FONT><A NAME="781"></A>   * @param attribute the index of the attribute to be evaluated
<FONT ID="LN">782 </FONT><A NAME="782"></A>   * @throws Exception if the attribute could not be evaluated
<FONT ID="LN">783 </FONT><A NAME="783"></A>   */</FONT>
<FONT ID="LN">784 </FONT><A NAME="784"></A>  <FONT ID="Public">public</FONT> <FONT ID="Double">double</FONT> evaluateAttribute (<FONT ID="Int">int</FONT> attribute)
<FONT ID="LN">785 </FONT><A NAME="785"></A>    <FONT ID="Throws">throws</FONT> Exception {
<FONT ID="LN">786 </FONT><A NAME="786"></A>    <FONT ID="Return">return</FONT>  m_weights[attribute];
<FONT ID="LN">787 </FONT><A NAME="787"></A>  }
<FONT ID="LN">788 </FONT><A NAME="788"></A>
<FONT ID="LN">789 </FONT><A NAME="789"></A>
<FONT ID="LN">790 </FONT><A NAME="790"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">791 </FONT><A NAME="791"></A>   * Reset options to their default values
<FONT ID="LN">792 </FONT><A NAME="792"></A>   */</FONT>
<FONT ID="LN">793 </FONT><A NAME="793"></A>  <FONT ID="Protected">protected</FONT> <FONT ID="Void">void</FONT> resetOptions () {
<FONT ID="LN">794 </FONT><A NAME="794"></A>    m_trainInstances = <FONT ID="Null">null</FONT>;
<FONT ID="LN">795 </FONT><A NAME="795"></A>    m_sampleM = -<FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">796 </FONT><A NAME="796"></A>    m_Knn = <FONT ID="IntegerLiteral">10</FONT>;
<FONT ID="LN">797 </FONT><A NAME="797"></A>    m_sigma = <FONT ID="IntegerLiteral">2</FONT>;
<FONT ID="LN">798 </FONT><A NAME="798"></A>    m_weightByDistance = <FONT ID="False">false</FONT>;
<FONT ID="LN">799 </FONT><A NAME="799"></A>    m_seed = <FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">800 </FONT><A NAME="800"></A>  }
<FONT ID="LN">801 </FONT><A NAME="801"></A>
<FONT ID="LN">802 </FONT><A NAME="802"></A>
<FONT ID="LN">803 </FONT><A NAME="803"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">804 </FONT><A NAME="804"></A>   * Normalizes a given value of a numeric attribute.
<FONT ID="LN">805 </FONT><A NAME="805"></A>   *
<FONT ID="LN">806 </FONT><A NAME="806"></A>   * @param x the value to be normalized
<FONT ID="LN">807 </FONT><A NAME="807"></A>   * @param i the attribute's index
<FONT ID="LN">808 </FONT><A NAME="808"></A>   * @return the normalized value
<FONT ID="LN">809 </FONT><A NAME="809"></A>   */</FONT>
<FONT ID="LN">810 </FONT><A NAME="810"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT> norm (<FONT ID="Double">double</FONT> x, <FONT ID="Int">int</FONT> i) {
<FONT ID="LN">811 </FONT><A NAME="811"></A>    <FONT ID="If">if</FONT> (Double.isNaN(m_minArray[i]) || 
<FONT ID="LN">812 </FONT><A NAME="812"></A>        Utils.eq(m_maxArray[i], m_minArray[i])) {
<FONT ID="LN">813 </FONT><A NAME="813"></A>      <FONT ID="Return">return</FONT>  <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">814 </FONT><A NAME="814"></A>    }
<FONT ID="LN">815 </FONT><A NAME="815"></A>    <FONT ID="Else">else</FONT> {
<FONT ID="LN">816 </FONT><A NAME="816"></A>      <FONT ID="Return">return</FONT>  (x - m_minArray[i])/(m_maxArray[i] - m_minArray[i]);
<FONT ID="LN">817 </FONT><A NAME="817"></A>    }
<FONT ID="LN">818 </FONT><A NAME="818"></A>  }
<FONT ID="LN">819 </FONT><A NAME="819"></A>
<FONT ID="LN">820 </FONT><A NAME="820"></A>
<FONT ID="LN">821 </FONT><A NAME="821"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">822 </FONT><A NAME="822"></A>   * Updates the minimum and maximum values for all the attributes
<FONT ID="LN">823 </FONT><A NAME="823"></A>   * based on a new instance.
<FONT ID="LN">824 </FONT><A NAME="824"></A>   *
<FONT ID="LN">825 </FONT><A NAME="825"></A>   * @param instance the new instance
<FONT ID="LN">826 </FONT><A NAME="826"></A>   */</FONT>
<FONT ID="LN">827 </FONT><A NAME="827"></A>  <FONT ID="Private">private</FONT> <FONT ID="Void">void</FONT> updateMinMax (<A HREF="../../weka/core/Instance.java.html">Instance</A> instance) {
<FONT ID="LN">828 </FONT><A NAME="828"></A>    <FONT ID="SingleLineComment">//    for (int j = 0; j &lt; m_numAttribs; j++) {
<FONT ID="LN">829 </FONT><A NAME="829"></A></FONT>    <FONT ID="Try">try</FONT> {
<FONT ID="LN">830 </FONT><A NAME="830"></A>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> j = <FONT ID="IntegerLiteral">0</FONT>; j &lt; instance.numValues(); j++) {
<FONT ID="LN">831 </FONT><A NAME="831"></A>        <FONT ID="If">if</FONT> ((instance.attributeSparse(j).isNumeric()) &amp;&amp; 
<FONT ID="LN">832 </FONT><A NAME="832"></A>            (!instance.isMissingSparse(j))) {
<FONT ID="LN">833 </FONT><A NAME="833"></A>          <FONT ID="If">if</FONT> (Double.isNaN(m_minArray[instance.index(j)])) {
<FONT ID="LN">834 </FONT><A NAME="834"></A>            m_minArray[instance.index(j)] = instance.valueSparse(j);
<FONT ID="LN">835 </FONT><A NAME="835"></A>            m_maxArray[instance.index(j)] = instance.valueSparse(j);
<FONT ID="LN">836 </FONT><A NAME="836"></A>          }
<FONT ID="LN">837 </FONT><A NAME="837"></A>        <FONT ID="Else">else</FONT> {
<FONT ID="LN">838 </FONT><A NAME="838"></A>          <FONT ID="If">if</FONT> (instance.valueSparse(j) &lt; m_minArray[instance.index(j)]) {
<FONT ID="LN">839 </FONT><A NAME="839"></A>            m_minArray[instance.index(j)] = instance.valueSparse(j);
<FONT ID="LN">840 </FONT><A NAME="840"></A>          }
<FONT ID="LN">841 </FONT><A NAME="841"></A>          <FONT ID="Else">else</FONT> {
<FONT ID="LN">842 </FONT><A NAME="842"></A>            <FONT ID="If">if</FONT> (instance.valueSparse(j) &gt; m_maxArray[instance.index(j)]) {
<FONT ID="LN">843 </FONT><A NAME="843"></A>              m_maxArray[instance.index(j)] = instance.valueSparse(j);
<FONT ID="LN">844 </FONT><A NAME="844"></A>            }
<FONT ID="LN">845 </FONT><A NAME="845"></A>          }
<FONT ID="LN">846 </FONT><A NAME="846"></A>        }
<FONT ID="LN">847 </FONT><A NAME="847"></A>        }
<FONT ID="LN">848 </FONT><A NAME="848"></A>      }
<FONT ID="LN">849 </FONT><A NAME="849"></A>    } <FONT ID="Catch">catch</FONT> (Exception ex) {
<FONT ID="LN">850 </FONT><A NAME="850"></A>      System.err.println(ex);
<FONT ID="LN">851 </FONT><A NAME="851"></A>      ex.printStackTrace();
<FONT ID="LN">852 </FONT><A NAME="852"></A>    }
<FONT ID="LN">853 </FONT><A NAME="853"></A>  }
<FONT ID="LN">854 </FONT><A NAME="854"></A>
<FONT ID="LN">855 </FONT><A NAME="855"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">856 </FONT><A NAME="856"></A>   * Computes the difference between two given attribute
<FONT ID="LN">857 </FONT><A NAME="857"></A>   * values.
<FONT ID="LN">858 </FONT><A NAME="858"></A>   */</FONT>
<FONT ID="LN">859 </FONT><A NAME="859"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT> difference(<FONT ID="Int">int</FONT> index, <FONT ID="Double">double</FONT> val1, <FONT ID="Double">double</FONT> val2) {
<FONT ID="LN">860 </FONT><A NAME="860"></A>
<FONT ID="LN">861 </FONT><A NAME="861"></A>    <FONT ID="Switch">switch</FONT> (m_trainInstances.attribute(index).type()) {
<FONT ID="LN">862 </FONT><A NAME="862"></A>    <FONT ID="Case">case</FONT> Attribute.NOMINAL:
<FONT ID="LN">863 </FONT><A NAME="863"></A>      
<FONT ID="LN">864 </FONT><A NAME="864"></A>      <FONT ID="SingleLineComment">// If attribute is nominal
<FONT ID="LN">865 </FONT><A NAME="865"></A></FONT>      <FONT ID="If">if</FONT> (Utils.isMissingValue(val1) || 
<FONT ID="LN">866 </FONT><A NAME="866"></A>          Utils.isMissingValue(val2)) {
<FONT ID="LN">867 </FONT><A NAME="867"></A>        <FONT ID="Return">return</FONT> (<FONT ID="FloatPointLiteral">1.0</FONT> - (<FONT ID="FloatPointLiteral">1.0</FONT>/((<FONT ID="Double">double</FONT>)m_trainInstances.
<FONT ID="LN">868 </FONT><A NAME="868"></A>                            attribute(index).numValues())));
<FONT ID="LN">869 </FONT><A NAME="869"></A>      } <FONT ID="Else">else</FONT> <FONT ID="If">if</FONT> ((<FONT ID="Int">int</FONT>)val1 != (<FONT ID="Int">int</FONT>)val2) {
<FONT ID="LN">870 </FONT><A NAME="870"></A>        <FONT ID="Return">return</FONT> <FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">871 </FONT><A NAME="871"></A>      } <FONT ID="Else">else</FONT> {
<FONT ID="LN">872 </FONT><A NAME="872"></A>        <FONT ID="Return">return</FONT> <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">873 </FONT><A NAME="873"></A>      }
<FONT ID="LN">874 </FONT><A NAME="874"></A>    <FONT ID="Case">case</FONT> Attribute.NUMERIC:
<FONT ID="LN">875 </FONT><A NAME="875"></A>
<FONT ID="LN">876 </FONT><A NAME="876"></A>      <FONT ID="SingleLineComment">// If attribute is numeric
<FONT ID="LN">877 </FONT><A NAME="877"></A></FONT>      <FONT ID="If">if</FONT> (Utils.isMissingValue(val1) || 
<FONT ID="LN">878 </FONT><A NAME="878"></A>          Utils.isMissingValue(val2)) {
<FONT ID="LN">879 </FONT><A NAME="879"></A>        <FONT ID="If">if</FONT> (Utils.isMissingValue(val1) &amp;&amp; 
<FONT ID="LN">880 </FONT><A NAME="880"></A>            Utils.isMissingValue(val2)) {
<FONT ID="LN">881 </FONT><A NAME="881"></A>          <FONT ID="Return">return</FONT> <FONT ID="IntegerLiteral">1</FONT>;
<FONT ID="LN">882 </FONT><A NAME="882"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">883 </FONT><A NAME="883"></A>          <FONT ID="Double">double</FONT> diff;
<FONT ID="LN">884 </FONT><A NAME="884"></A>          <FONT ID="If">if</FONT> (Utils.isMissingValue(val2)) {
<FONT ID="LN">885 </FONT><A NAME="885"></A>            diff = norm(val1, index);
<FONT ID="LN">886 </FONT><A NAME="886"></A>          } <FONT ID="Else">else</FONT> {
<FONT ID="LN">887 </FONT><A NAME="887"></A>            diff = norm(val2, index);
<FONT ID="LN">888 </FONT><A NAME="888"></A>          }
<FONT ID="LN">889 </FONT><A NAME="889"></A>          <FONT ID="If">if</FONT> (diff &lt; <FONT ID="FloatPointLiteral">0.5</FONT>) {
<FONT ID="LN">890 </FONT><A NAME="890"></A>            diff = <FONT ID="FloatPointLiteral">1.0</FONT> - diff;
<FONT ID="LN">891 </FONT><A NAME="891"></A>          }
<FONT ID="LN">892 </FONT><A NAME="892"></A>          <FONT ID="Return">return</FONT> diff;
<FONT ID="LN">893 </FONT><A NAME="893"></A>        }
<FONT ID="LN">894 </FONT><A NAME="894"></A>      } <FONT ID="Else">else</FONT> {
<FONT ID="LN">895 </FONT><A NAME="895"></A>        <FONT ID="Return">return</FONT> Math.abs(norm(val1, index) - norm(val2, index));
<FONT ID="LN">896 </FONT><A NAME="896"></A>      }
<FONT ID="LN">897 </FONT><A NAME="897"></A>    <FONT ID="Default">default</FONT>:
<FONT ID="LN">898 </FONT><A NAME="898"></A>      <FONT ID="Return">return</FONT> <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">899 </FONT><A NAME="899"></A>    }
<FONT ID="LN">900 </FONT><A NAME="900"></A>  }
<FONT ID="LN">901 </FONT><A NAME="901"></A>
<FONT ID="LN">902 </FONT><A NAME="902"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">903 </FONT><A NAME="903"></A>   * Calculates the distance between two instances
<FONT ID="LN">904 </FONT><A NAME="904"></A>   *
<FONT ID="LN">905 </FONT><A NAME="905"></A>   * @param first the first instance
<FONT ID="LN">906 </FONT><A NAME="906"></A>   * @param second the second instance
<FONT ID="LN">907 </FONT><A NAME="907"></A>   * @return the distance between the two given instances, between 0 and 1
<FONT ID="LN">908 </FONT><A NAME="908"></A>   */</FONT>          
<FONT ID="LN">909 </FONT><A NAME="909"></A>  <FONT ID="Private">private</FONT> <FONT ID="Double">double</FONT> distance(<A HREF="../../weka/core/Instance.java.html">Instance</A> first, <A HREF="../../weka/core/Instance.java.html">Instance</A> second) {  
<FONT ID="LN">910 </FONT><A NAME="910"></A>
<FONT ID="LN">911 </FONT><A NAME="911"></A>    <FONT ID="Double">double</FONT> distance = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">912 </FONT><A NAME="912"></A>    <FONT ID="Int">int</FONT> firstI, secondI;
<FONT ID="LN">913 </FONT><A NAME="913"></A>
<FONT ID="LN">914 </FONT><A NAME="914"></A>    <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> p1 = <FONT ID="IntegerLiteral">0</FONT>, p2 = <FONT ID="IntegerLiteral">0</FONT>; 
<FONT ID="LN">915 </FONT><A NAME="915"></A>         p1 &lt; first.numValues() || p2 &lt; second.numValues();) {
<FONT ID="LN">916 </FONT><A NAME="916"></A>      <FONT ID="If">if</FONT> (p1 &gt;= first.numValues()) {
<FONT ID="LN">917 </FONT><A NAME="917"></A>        firstI = m_trainInstances.numAttributes();
<FONT ID="LN">918 </FONT><A NAME="918"></A>      } <FONT ID="Else">else</FONT> {
<FONT ID="LN">919 </FONT><A NAME="919"></A>        firstI = first.index(p1); 
<FONT ID="LN">920 </FONT><A NAME="920"></A>      }
<FONT ID="LN">921 </FONT><A NAME="921"></A>      <FONT ID="If">if</FONT> (p2 &gt;= second.numValues()) {
<FONT ID="LN">922 </FONT><A NAME="922"></A>        secondI = m_trainInstances.numAttributes();
<FONT ID="LN">923 </FONT><A NAME="923"></A>      } <FONT ID="Else">else</FONT> {
<FONT ID="LN">924 </FONT><A NAME="924"></A>        secondI = second.index(p2);
<FONT ID="LN">925 </FONT><A NAME="925"></A>      }
<FONT ID="LN">926 </FONT><A NAME="926"></A>      <FONT ID="If">if</FONT> (firstI == m_trainInstances.classIndex()) {
<FONT ID="LN">927 </FONT><A NAME="927"></A>        p1++; <FONT ID="Continue">continue</FONT>;
<FONT ID="LN">928 </FONT><A NAME="928"></A>      } 
<FONT ID="LN">929 </FONT><A NAME="929"></A>      <FONT ID="If">if</FONT> (secondI == m_trainInstances.classIndex()) {
<FONT ID="LN">930 </FONT><A NAME="930"></A>        p2++; <FONT ID="Continue">continue</FONT>;
<FONT ID="LN">931 </FONT><A NAME="931"></A>      } 
<FONT ID="LN">932 </FONT><A NAME="932"></A>      <FONT ID="Double">double</FONT> diff;
<FONT ID="LN">933 </FONT><A NAME="933"></A>      <FONT ID="If">if</FONT> (firstI == secondI) {
<FONT ID="LN">934 </FONT><A NAME="934"></A>        diff = difference(firstI, 
<FONT ID="LN">935 </FONT><A NAME="935"></A>                          first.valueSparse(p1),
<FONT ID="LN">936 </FONT><A NAME="936"></A>                          second.valueSparse(p2));
<FONT ID="LN">937 </FONT><A NAME="937"></A>        p1++; p2++;
<FONT ID="LN">938 </FONT><A NAME="938"></A>      } <FONT ID="Else">else</FONT> <FONT ID="If">if</FONT> (firstI &gt; secondI) {
<FONT ID="LN">939 </FONT><A NAME="939"></A>        diff = difference(secondI, 
<FONT ID="LN">940 </FONT><A NAME="940"></A>                          <FONT ID="IntegerLiteral">0</FONT>, second.valueSparse(p2));
<FONT ID="LN">941 </FONT><A NAME="941"></A>        p2++;
<FONT ID="LN">942 </FONT><A NAME="942"></A>      } <FONT ID="Else">else</FONT> {
<FONT ID="LN">943 </FONT><A NAME="943"></A>        diff = difference(firstI, 
<FONT ID="LN">944 </FONT><A NAME="944"></A>                          first.valueSparse(p1), <FONT ID="IntegerLiteral">0</FONT>);
<FONT ID="LN">945 </FONT><A NAME="945"></A>        p1++;
<FONT ID="LN">946 </FONT><A NAME="946"></A>      }
<FONT ID="LN">947 </FONT><A NAME="947"></A>      <FONT ID="SingleLineComment">//      distance += diff * diff;
<FONT ID="LN">948 </FONT><A NAME="948"></A></FONT>      distance += diff;
<FONT ID="LN">949 </FONT><A NAME="949"></A>    }
<FONT ID="LN">950 </FONT><A NAME="950"></A>    
<FONT ID="LN">951 </FONT><A NAME="951"></A>    <FONT ID="SingleLineComment">//    return Math.sqrt(distance / m_NumAttributesUsed);
<FONT ID="LN">952 </FONT><A NAME="952"></A></FONT>    <FONT ID="Return">return</FONT> distance;
<FONT ID="LN">953 </FONT><A NAME="953"></A>  }
<FONT ID="LN">954 </FONT><A NAME="954"></A>
<FONT ID="LN">955 </FONT><A NAME="955"></A>
<FONT ID="LN">956 </FONT><A NAME="956"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">957 </FONT><A NAME="957"></A>   * update attribute weights given an instance when the class is numeric
<FONT ID="LN">958 </FONT><A NAME="958"></A>   *
<FONT ID="LN">959 </FONT><A NAME="959"></A>   * @param instNum the index of the instance to use when updating weights
<FONT ID="LN">960 </FONT><A NAME="960"></A>   */</FONT>
<FONT ID="LN">961 </FONT><A NAME="961"></A>  <FONT ID="Private">private</FONT> <FONT ID="Void">void</FONT> updateWeightsNumericClass (<FONT ID="Int">int</FONT> instNum) {
<FONT ID="LN">962 </FONT><A NAME="962"></A>    <FONT ID="Int">int</FONT> i, j;
<FONT ID="LN">963 </FONT><A NAME="963"></A>    <FONT ID="Double">double</FONT> temp,temp2;
<FONT ID="LN">964 </FONT><A NAME="964"></A>    <FONT ID="Int">int</FONT>[] tempSorted = <FONT ID="Null">null</FONT>;
<FONT ID="LN">965 </FONT><A NAME="965"></A>    <FONT ID="Double">double</FONT>[] tempDist = <FONT ID="Null">null</FONT>;
<FONT ID="LN">966 </FONT><A NAME="966"></A>    <FONT ID="Double">double</FONT> distNorm = <FONT ID="FloatPointLiteral">1.0</FONT>;
<FONT ID="LN">967 </FONT><A NAME="967"></A>    <FONT ID="Int">int</FONT> firstI, secondI;
<FONT ID="LN">968 </FONT><A NAME="968"></A>
<FONT ID="LN">969 </FONT><A NAME="969"></A>    <A HREF="../../weka/core/Instance.java.html">Instance</A> inst = m_trainInstances.instance(instNum);
<FONT ID="LN">970 </FONT><A NAME="970"></A>   
<FONT ID="LN">971 </FONT><A NAME="971"></A>    <FONT ID="SingleLineComment">// sort nearest neighbours and set up normalization variable
<FONT ID="LN">972 </FONT><A NAME="972"></A></FONT>    <FONT ID="If">if</FONT> (m_weightByDistance) {
<FONT ID="LN">973 </FONT><A NAME="973"></A>      tempDist = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_stored[<FONT ID="IntegerLiteral">0</FONT>]];
<FONT ID="LN">974 </FONT><A NAME="974"></A>
<FONT ID="LN">975 </FONT><A NAME="975"></A>      <FONT ID="For">for</FONT> (j = <FONT ID="IntegerLiteral">0</FONT>, distNorm = <FONT ID="IntegerLiteral">0</FONT>; j &lt; m_stored[<FONT ID="IntegerLiteral">0</FONT>]; j++) {
<FONT ID="LN">976 </FONT><A NAME="976"></A>        <FONT ID="SingleLineComment">// copy the distances
<FONT ID="LN">977 </FONT><A NAME="977"></A></FONT>        tempDist[j] = m_karray[<FONT ID="IntegerLiteral">0</FONT>][j][<FONT ID="IntegerLiteral">0</FONT>];
<FONT ID="LN">978 </FONT><A NAME="978"></A>        <FONT ID="SingleLineComment">// sum normalizer
<FONT ID="LN">979 </FONT><A NAME="979"></A></FONT>        distNorm += m_weightsByRank[j];
<FONT ID="LN">980 </FONT><A NAME="980"></A>      }
<FONT ID="LN">981 </FONT><A NAME="981"></A>
<FONT ID="LN">982 </FONT><A NAME="982"></A>      tempSorted = Utils.sort(tempDist);
<FONT ID="LN">983 </FONT><A NAME="983"></A>    }
<FONT ID="LN">984 </FONT><A NAME="984"></A>
<FONT ID="LN">985 </FONT><A NAME="985"></A>    <FONT ID="For">for</FONT> (i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; m_stored[<FONT ID="IntegerLiteral">0</FONT>]; i++) {
<FONT ID="LN">986 </FONT><A NAME="986"></A>      <FONT ID="SingleLineComment">// P diff prediction (class) given nearest instances
<FONT ID="LN">987 </FONT><A NAME="987"></A></FONT>      <FONT ID="If">if</FONT> (m_weightByDistance) {
<FONT ID="LN">988 </FONT><A NAME="988"></A>        temp = difference(m_classIndex, 
<FONT ID="LN">989 </FONT><A NAME="989"></A>                          inst.value(m_classIndex),
<FONT ID="LN">990 </FONT><A NAME="990"></A>                          m_trainInstances.
<FONT ID="LN">991 </FONT><A NAME="991"></A>                          instance((<FONT ID="Int">int</FONT>)m_karray[<FONT ID="IntegerLiteral">0</FONT>][tempSorted[i]][<FONT ID="IntegerLiteral">1</FONT>]).
<FONT ID="LN">992 </FONT><A NAME="992"></A>                          value(m_classIndex));
<FONT ID="LN">993 </FONT><A NAME="993"></A>        temp *= (m_weightsByRank[i]/distNorm);
<FONT ID="LN">994 </FONT><A NAME="994"></A>      }
<FONT ID="LN">995 </FONT><A NAME="995"></A>      <FONT ID="Else">else</FONT> {
<FONT ID="LN">996 </FONT><A NAME="996"></A>        temp = difference(m_classIndex, 
<FONT ID="LN">997 </FONT><A NAME="997"></A>                          inst.value(m_classIndex), 
<FONT ID="LN">998 </FONT><A NAME="998"></A>                          m_trainInstances.
<FONT ID="LN">999 </FONT><A NAME="999"></A>                          instance((<FONT ID="Int">int</FONT>)m_karray[<FONT ID="IntegerLiteral">0</FONT>][i][<FONT ID="IntegerLiteral">1</FONT>]).
<FONT ID="LN">1000</FONT><A NAME="1000"></A>                          value(m_classIndex));
<FONT ID="LN">1001</FONT><A NAME="1001"></A>        temp *= (<FONT ID="FloatPointLiteral">1.0</FONT>/(<FONT ID="Double">double</FONT>)m_stored[<FONT ID="IntegerLiteral">0</FONT>]); <FONT ID="SingleLineComment">// equal influence
<FONT ID="LN">1002</FONT><A NAME="1002"></A></FONT>      }
<FONT ID="LN">1003</FONT><A NAME="1003"></A>
<FONT ID="LN">1004</FONT><A NAME="1004"></A>      m_ndc += temp;
<FONT ID="LN">1005</FONT><A NAME="1005"></A>
<FONT ID="LN">1006</FONT><A NAME="1006"></A>      <A HREF="../../weka/core/Instance.java.html">Instance</A> cmp;
<FONT ID="LN">1007</FONT><A NAME="1007"></A>      cmp = (m_weightByDistance) 
<FONT ID="LN">1008</FONT><A NAME="1008"></A>        ? m_trainInstances.instance((<FONT ID="Int">int</FONT>)m_karray[<FONT ID="IntegerLiteral">0</FONT>][tempSorted[i]][<FONT ID="IntegerLiteral">1</FONT>])
<FONT ID="LN">1009</FONT><A NAME="1009"></A>        : m_trainInstances.instance((<FONT ID="Int">int</FONT>)m_karray[<FONT ID="IntegerLiteral">0</FONT>][i][<FONT ID="IntegerLiteral">1</FONT>]);
<FONT ID="LN">1010</FONT><A NAME="1010"></A> 
<FONT ID="LN">1011</FONT><A NAME="1011"></A>      <FONT ID="Double">double</FONT> temp_diffP_diffA_givNearest = 
<FONT ID="LN">1012</FONT><A NAME="1012"></A>        difference(m_classIndex, inst.value(m_classIndex),
<FONT ID="LN">1013</FONT><A NAME="1013"></A>                   cmp.value(m_classIndex));
<FONT ID="LN">1014</FONT><A NAME="1014"></A>      <FONT ID="SingleLineComment">// now the attributes
<FONT ID="LN">1015</FONT><A NAME="1015"></A></FONT>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> p1 = <FONT ID="IntegerLiteral">0</FONT>, p2 = <FONT ID="IntegerLiteral">0</FONT>; 
<FONT ID="LN">1016</FONT><A NAME="1016"></A>           p1 &lt; inst.numValues() || p2 &lt; cmp.numValues();) {
<FONT ID="LN">1017</FONT><A NAME="1017"></A>        <FONT ID="If">if</FONT> (p1 &gt;= inst.numValues()) {
<FONT ID="LN">1018</FONT><A NAME="1018"></A>          firstI = m_trainInstances.numAttributes();
<FONT ID="LN">1019</FONT><A NAME="1019"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1020</FONT><A NAME="1020"></A>          firstI = inst.index(p1); 
<FONT ID="LN">1021</FONT><A NAME="1021"></A>        }
<FONT ID="LN">1022</FONT><A NAME="1022"></A>        <FONT ID="If">if</FONT> (p2 &gt;= cmp.numValues()) {
<FONT ID="LN">1023</FONT><A NAME="1023"></A>          secondI = m_trainInstances.numAttributes();
<FONT ID="LN">1024</FONT><A NAME="1024"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1025</FONT><A NAME="1025"></A>          secondI = cmp.index(p2);
<FONT ID="LN">1026</FONT><A NAME="1026"></A>        }
<FONT ID="LN">1027</FONT><A NAME="1027"></A>        <FONT ID="If">if</FONT> (firstI == m_trainInstances.classIndex()) {
<FONT ID="LN">1028</FONT><A NAME="1028"></A>          p1++; <FONT ID="Continue">continue</FONT>;
<FONT ID="LN">1029</FONT><A NAME="1029"></A>        } 
<FONT ID="LN">1030</FONT><A NAME="1030"></A>        <FONT ID="If">if</FONT> (secondI == m_trainInstances.classIndex()) {
<FONT ID="LN">1031</FONT><A NAME="1031"></A>          p2++; <FONT ID="Continue">continue</FONT>;
<FONT ID="LN">1032</FONT><A NAME="1032"></A>        } 
<FONT ID="LN">1033</FONT><A NAME="1033"></A>        temp = <FONT ID="FloatPointLiteral">0.0</FONT>;
<FONT ID="LN">1034</FONT><A NAME="1034"></A>        temp2 = <FONT ID="FloatPointLiteral">0.0</FONT>;
<FONT ID="LN">1035</FONT><A NAME="1035"></A>      
<FONT ID="LN">1036</FONT><A NAME="1036"></A>        <FONT ID="If">if</FONT> (firstI == secondI) {
<FONT ID="LN">1037</FONT><A NAME="1037"></A>          j = firstI;
<FONT ID="LN">1038</FONT><A NAME="1038"></A>          temp = difference(j, inst.valueSparse(p1), cmp.valueSparse(p2)); 
<FONT ID="LN">1039</FONT><A NAME="1039"></A>          p1++;p2++;
<FONT ID="LN">1040</FONT><A NAME="1040"></A>        } <FONT ID="Else">else</FONT> <FONT ID="If">if</FONT> (firstI &gt; secondI) {
<FONT ID="LN">1041</FONT><A NAME="1041"></A>          j = secondI;
<FONT ID="LN">1042</FONT><A NAME="1042"></A>          temp = difference(j, <FONT ID="IntegerLiteral">0</FONT>, cmp.valueSparse(p2));
<FONT ID="LN">1043</FONT><A NAME="1043"></A>          p2++;
<FONT ID="LN">1044</FONT><A NAME="1044"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1045</FONT><A NAME="1045"></A>          j = firstI;
<FONT ID="LN">1046</FONT><A NAME="1046"></A>          temp = difference(j, inst.valueSparse(p1), <FONT ID="IntegerLiteral">0</FONT>);
<FONT ID="LN">1047</FONT><A NAME="1047"></A>          p1++;
<FONT ID="LN">1048</FONT><A NAME="1048"></A>        } 
<FONT ID="LN">1049</FONT><A NAME="1049"></A>       
<FONT ID="LN">1050</FONT><A NAME="1050"></A>        temp2 = temp_diffP_diffA_givNearest * temp; 
<FONT ID="LN">1051</FONT><A NAME="1051"></A>        <FONT ID="SingleLineComment">// P of different prediction and different att value given
<FONT ID="LN">1052</FONT><A NAME="1052"></A></FONT>        <FONT ID="SingleLineComment">// nearest instances
<FONT ID="LN">1053</FONT><A NAME="1053"></A></FONT>        <FONT ID="If">if</FONT> (m_weightByDistance) {
<FONT ID="LN">1054</FONT><A NAME="1054"></A>          temp2 *= (m_weightsByRank[i]/distNorm);
<FONT ID="LN">1055</FONT><A NAME="1055"></A>        }
<FONT ID="LN">1056</FONT><A NAME="1056"></A>        <FONT ID="Else">else</FONT> {
<FONT ID="LN">1057</FONT><A NAME="1057"></A>          temp2 *= (<FONT ID="FloatPointLiteral">1.0</FONT>/(<FONT ID="Double">double</FONT>)m_stored[<FONT ID="IntegerLiteral">0</FONT>]); <FONT ID="SingleLineComment">// equal influence
<FONT ID="LN">1058</FONT><A NAME="1058"></A></FONT>        }
<FONT ID="LN">1059</FONT><A NAME="1059"></A>
<FONT ID="LN">1060</FONT><A NAME="1060"></A>        m_ndcda[j] += temp2;
<FONT ID="LN">1061</FONT><A NAME="1061"></A>       
<FONT ID="LN">1062</FONT><A NAME="1062"></A>        <FONT ID="SingleLineComment">// P of different attribute val given nearest instances
<FONT ID="LN">1063</FONT><A NAME="1063"></A></FONT>        <FONT ID="If">if</FONT> (m_weightByDistance) {
<FONT ID="LN">1064</FONT><A NAME="1064"></A>          temp *= (m_weightsByRank[i]/distNorm);
<FONT ID="LN">1065</FONT><A NAME="1065"></A>        }
<FONT ID="LN">1066</FONT><A NAME="1066"></A>        <FONT ID="Else">else</FONT> {
<FONT ID="LN">1067</FONT><A NAME="1067"></A>          temp *= (<FONT ID="FloatPointLiteral">1.0</FONT>/(<FONT ID="Double">double</FONT>)m_stored[<FONT ID="IntegerLiteral">0</FONT>]); <FONT ID="SingleLineComment">// equal influence
<FONT ID="LN">1068</FONT><A NAME="1068"></A></FONT>        }
<FONT ID="LN">1069</FONT><A NAME="1069"></A>
<FONT ID="LN">1070</FONT><A NAME="1070"></A>        m_nda[j] += temp;
<FONT ID="LN">1071</FONT><A NAME="1071"></A>      }
<FONT ID="LN">1072</FONT><A NAME="1072"></A>    }
<FONT ID="LN">1073</FONT><A NAME="1073"></A>  }
<FONT ID="LN">1074</FONT><A NAME="1074"></A>
<FONT ID="LN">1075</FONT><A NAME="1075"></A>
<FONT ID="LN">1076</FONT><A NAME="1076"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">1077</FONT><A NAME="1077"></A>   * update attribute weights given an instance when the class is discrete
<FONT ID="LN">1078</FONT><A NAME="1078"></A>   *
<FONT ID="LN">1079</FONT><A NAME="1079"></A>   * @param instNum the index of the instance to use when updating weights
<FONT ID="LN">1080</FONT><A NAME="1080"></A>   */</FONT>
<FONT ID="LN">1081</FONT><A NAME="1081"></A>  <FONT ID="Private">private</FONT> <FONT ID="Void">void</FONT> updateWeightsDiscreteClass (<FONT ID="Int">int</FONT> instNum) {
<FONT ID="LN">1082</FONT><A NAME="1082"></A>    <FONT ID="Int">int</FONT> i, j, k;
<FONT ID="LN">1083</FONT><A NAME="1083"></A>    <FONT ID="Int">int</FONT> cl;
<FONT ID="LN">1084</FONT><A NAME="1084"></A>    <FONT ID="Double">double</FONT> temp_diff, w_norm = <FONT ID="FloatPointLiteral">1.0</FONT>;
<FONT ID="LN">1085</FONT><A NAME="1085"></A>    <FONT ID="Double">double</FONT>[] tempDistClass;
<FONT ID="LN">1086</FONT><A NAME="1086"></A>    <FONT ID="Int">int</FONT>[] tempSortedClass = <FONT ID="Null">null</FONT>;
<FONT ID="LN">1087</FONT><A NAME="1087"></A>    <FONT ID="Double">double</FONT> distNormClass = <FONT ID="FloatPointLiteral">1.0</FONT>;
<FONT ID="LN">1088</FONT><A NAME="1088"></A>    <FONT ID="Double">double</FONT>[] tempDistAtt;
<FONT ID="LN">1089</FONT><A NAME="1089"></A>    <FONT ID="Int">int</FONT>[][] tempSortedAtt = <FONT ID="Null">null</FONT>;
<FONT ID="LN">1090</FONT><A NAME="1090"></A>    <FONT ID="Double">double</FONT>[] distNormAtt = <FONT ID="Null">null</FONT>;
<FONT ID="LN">1091</FONT><A NAME="1091"></A>    <FONT ID="Int">int</FONT> firstI, secondI;
<FONT ID="LN">1092</FONT><A NAME="1092"></A>
<FONT ID="LN">1093</FONT><A NAME="1093"></A>    <FONT ID="SingleLineComment">// store the indexes (sparse instances) of non-zero elements
<FONT ID="LN">1094</FONT><A NAME="1094"></A></FONT>    <A HREF="../../weka/core/Instance.java.html">Instance</A> inst = m_trainInstances.instance(instNum);
<FONT ID="LN">1095</FONT><A NAME="1095"></A>
<FONT ID="LN">1096</FONT><A NAME="1096"></A>    <FONT ID="SingleLineComment">// get the class of this instance
<FONT ID="LN">1097</FONT><A NAME="1097"></A></FONT>    cl = (<FONT ID="Int">int</FONT>)m_trainInstances.instance(instNum).value(m_classIndex);
<FONT ID="LN">1098</FONT><A NAME="1098"></A>
<FONT ID="LN">1099</FONT><A NAME="1099"></A>    <FONT ID="SingleLineComment">// sort nearest neighbours and set up normalization variables
<FONT ID="LN">1100</FONT><A NAME="1100"></A></FONT>    <FONT ID="If">if</FONT> (m_weightByDistance) {
<FONT ID="LN">1101</FONT><A NAME="1101"></A>      <FONT ID="SingleLineComment">// do class (hits) first
<FONT ID="LN">1102</FONT><A NAME="1102"></A></FONT>      <FONT ID="SingleLineComment">// sort the distances
<FONT ID="LN">1103</FONT><A NAME="1103"></A></FONT>      tempDistClass = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_stored[cl]];
<FONT ID="LN">1104</FONT><A NAME="1104"></A>
<FONT ID="LN">1105</FONT><A NAME="1105"></A>      <FONT ID="For">for</FONT> (j = <FONT ID="IntegerLiteral">0</FONT>, distNormClass = <FONT ID="IntegerLiteral">0</FONT>; j &lt; m_stored[cl]; j++) {
<FONT ID="LN">1106</FONT><A NAME="1106"></A>        <FONT ID="SingleLineComment">// copy the distances
<FONT ID="LN">1107</FONT><A NAME="1107"></A></FONT>        tempDistClass[j] = m_karray[cl][j][<FONT ID="IntegerLiteral">0</FONT>];
<FONT ID="LN">1108</FONT><A NAME="1108"></A>        <FONT ID="SingleLineComment">// sum normalizer
<FONT ID="LN">1109</FONT><A NAME="1109"></A></FONT>        distNormClass += m_weightsByRank[j];
<FONT ID="LN">1110</FONT><A NAME="1110"></A>      }
<FONT ID="LN">1111</FONT><A NAME="1111"></A>
<FONT ID="LN">1112</FONT><A NAME="1112"></A>      tempSortedClass = Utils.sort(tempDistClass);
<FONT ID="LN">1113</FONT><A NAME="1113"></A>      <FONT ID="SingleLineComment">// do misses (other classes)
<FONT ID="LN">1114</FONT><A NAME="1114"></A></FONT>      tempSortedAtt = <FONT ID="New">new</FONT> <FONT ID="Int">int</FONT>[m_numClasses][<FONT ID="IntegerLiteral">1</FONT>];
<FONT ID="LN">1115</FONT><A NAME="1115"></A>      distNormAtt = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_numClasses];
<FONT ID="LN">1116</FONT><A NAME="1116"></A>
<FONT ID="LN">1117</FONT><A NAME="1117"></A>      <FONT ID="For">for</FONT> (k = <FONT ID="IntegerLiteral">0</FONT>; k &lt; m_numClasses; k++) {
<FONT ID="LN">1118</FONT><A NAME="1118"></A>        <FONT ID="If">if</FONT> (k != cl) <FONT ID="SingleLineComment">// already done cl
<FONT ID="LN">1119</FONT><A NAME="1119"></A></FONT>          {
<FONT ID="LN">1120</FONT><A NAME="1120"></A>            <FONT ID="SingleLineComment">// sort the distances
<FONT ID="LN">1121</FONT><A NAME="1121"></A></FONT>            tempDistAtt = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[m_stored[k]];
<FONT ID="LN">1122</FONT><A NAME="1122"></A>
<FONT ID="LN">1123</FONT><A NAME="1123"></A>            <FONT ID="For">for</FONT> (j = <FONT ID="IntegerLiteral">0</FONT>, distNormAtt[k] = <FONT ID="IntegerLiteral">0</FONT>; j &lt; m_stored[k]; j++) {
<FONT ID="LN">1124</FONT><A NAME="1124"></A>              <FONT ID="SingleLineComment">// copy the distances
<FONT ID="LN">1125</FONT><A NAME="1125"></A></FONT>              tempDistAtt[j] = m_karray[k][j][<FONT ID="IntegerLiteral">0</FONT>];
<FONT ID="LN">1126</FONT><A NAME="1126"></A>              <FONT ID="SingleLineComment">// sum normalizer
<FONT ID="LN">1127</FONT><A NAME="1127"></A></FONT>              distNormAtt[k] += m_weightsByRank[j];
<FONT ID="LN">1128</FONT><A NAME="1128"></A>            }
<FONT ID="LN">1129</FONT><A NAME="1129"></A>
<FONT ID="LN">1130</FONT><A NAME="1130"></A>            tempSortedAtt[k] = Utils.sort(tempDistAtt);
<FONT ID="LN">1131</FONT><A NAME="1131"></A>          }
<FONT ID="LN">1132</FONT><A NAME="1132"></A>      }
<FONT ID="LN">1133</FONT><A NAME="1133"></A>    }
<FONT ID="LN">1134</FONT><A NAME="1134"></A>
<FONT ID="LN">1135</FONT><A NAME="1135"></A>    <FONT ID="If">if</FONT> (m_numClasses &gt; <FONT ID="IntegerLiteral">2</FONT>) {
<FONT ID="LN">1136</FONT><A NAME="1136"></A>      <FONT ID="SingleLineComment">// the amount of probability space left after removing the
<FONT ID="LN">1137</FONT><A NAME="1137"></A></FONT>      <FONT ID="SingleLineComment">// probability of this instance's class value
<FONT ID="LN">1138</FONT><A NAME="1138"></A></FONT>      w_norm = (<FONT ID="FloatPointLiteral">1.0</FONT> - m_classProbs[cl]);
<FONT ID="LN">1139</FONT><A NAME="1139"></A>    }
<FONT ID="LN">1140</FONT><A NAME="1140"></A>    
<FONT ID="LN">1141</FONT><A NAME="1141"></A>    <FONT ID="SingleLineComment">// do the k nearest hits of the same class
<FONT ID="LN">1142</FONT><A NAME="1142"></A></FONT>    <FONT ID="For">for</FONT> (j = <FONT ID="IntegerLiteral">0</FONT>, temp_diff = <FONT ID="FloatPointLiteral">0.0</FONT>; j &lt; m_stored[cl]; j++) {
<FONT ID="LN">1143</FONT><A NAME="1143"></A>      <A HREF="../../weka/core/Instance.java.html">Instance</A> cmp;
<FONT ID="LN">1144</FONT><A NAME="1144"></A>      cmp = (m_weightByDistance) 
<FONT ID="LN">1145</FONT><A NAME="1145"></A>        ? m_trainInstances.
<FONT ID="LN">1146</FONT><A NAME="1146"></A>        instance((<FONT ID="Int">int</FONT>)m_karray[cl][tempSortedClass[j]][<FONT ID="IntegerLiteral">1</FONT>])
<FONT ID="LN">1147</FONT><A NAME="1147"></A>        : m_trainInstances.instance((<FONT ID="Int">int</FONT>)m_karray[cl][j][<FONT ID="IntegerLiteral">1</FONT>]);
<FONT ID="LN">1148</FONT><A NAME="1148"></A>
<FONT ID="LN">1149</FONT><A NAME="1149"></A>      <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> p1 = <FONT ID="IntegerLiteral">0</FONT>, p2 = <FONT ID="IntegerLiteral">0</FONT>; 
<FONT ID="LN">1150</FONT><A NAME="1150"></A>           p1 &lt; inst.numValues() || p2 &lt; cmp.numValues();) {
<FONT ID="LN">1151</FONT><A NAME="1151"></A>        <FONT ID="If">if</FONT> (p1 &gt;= inst.numValues()) {
<FONT ID="LN">1152</FONT><A NAME="1152"></A>          firstI = m_trainInstances.numAttributes();
<FONT ID="LN">1153</FONT><A NAME="1153"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1154</FONT><A NAME="1154"></A>          firstI = inst.index(p1); 
<FONT ID="LN">1155</FONT><A NAME="1155"></A>        }
<FONT ID="LN">1156</FONT><A NAME="1156"></A>        <FONT ID="If">if</FONT> (p2 &gt;= cmp.numValues()) {
<FONT ID="LN">1157</FONT><A NAME="1157"></A>          secondI = m_trainInstances.numAttributes();
<FONT ID="LN">1158</FONT><A NAME="1158"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1159</FONT><A NAME="1159"></A>          secondI = cmp.index(p2);
<FONT ID="LN">1160</FONT><A NAME="1160"></A>        }
<FONT ID="LN">1161</FONT><A NAME="1161"></A>        <FONT ID="If">if</FONT> (firstI == m_trainInstances.classIndex()) {
<FONT ID="LN">1162</FONT><A NAME="1162"></A>          p1++; <FONT ID="Continue">continue</FONT>;
<FONT ID="LN">1163</FONT><A NAME="1163"></A>        } 
<FONT ID="LN">1164</FONT><A NAME="1164"></A>        <FONT ID="If">if</FONT> (secondI == m_trainInstances.classIndex()) {
<FONT ID="LN">1165</FONT><A NAME="1165"></A>          p2++; <FONT ID="Continue">continue</FONT>;
<FONT ID="LN">1166</FONT><A NAME="1166"></A>        } 
<FONT ID="LN">1167</FONT><A NAME="1167"></A>        <FONT ID="If">if</FONT> (firstI == secondI) {
<FONT ID="LN">1168</FONT><A NAME="1168"></A>          i = firstI;
<FONT ID="LN">1169</FONT><A NAME="1169"></A>          temp_diff = difference(i, inst.valueSparse(p1), 
<FONT ID="LN">1170</FONT><A NAME="1170"></A>                                 cmp.valueSparse(p2)); 
<FONT ID="LN">1171</FONT><A NAME="1171"></A>          p1++;p2++;
<FONT ID="LN">1172</FONT><A NAME="1172"></A>        } <FONT ID="Else">else</FONT> <FONT ID="If">if</FONT> (firstI &gt; secondI) {
<FONT ID="LN">1173</FONT><A NAME="1173"></A>          i = secondI;
<FONT ID="LN">1174</FONT><A NAME="1174"></A>          temp_diff = difference(i, <FONT ID="IntegerLiteral">0</FONT>, cmp.valueSparse(p2));
<FONT ID="LN">1175</FONT><A NAME="1175"></A>          p2++;
<FONT ID="LN">1176</FONT><A NAME="1176"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1177</FONT><A NAME="1177"></A>          i = firstI;
<FONT ID="LN">1178</FONT><A NAME="1178"></A>          temp_diff = difference(i, inst.valueSparse(p1), <FONT ID="IntegerLiteral">0</FONT>);
<FONT ID="LN">1179</FONT><A NAME="1179"></A>          p1++;
<FONT ID="LN">1180</FONT><A NAME="1180"></A>        } 
<FONT ID="LN">1181</FONT><A NAME="1181"></A>        
<FONT ID="LN">1182</FONT><A NAME="1182"></A>        <FONT ID="If">if</FONT> (m_weightByDistance) {
<FONT ID="LN">1183</FONT><A NAME="1183"></A>          temp_diff *=
<FONT ID="LN">1184</FONT><A NAME="1184"></A>            (m_weightsByRank[j]/distNormClass);
<FONT ID="LN">1185</FONT><A NAME="1185"></A>        } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1186</FONT><A NAME="1186"></A>          <FONT ID="If">if</FONT> (m_stored[cl] &gt; <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">1187</FONT><A NAME="1187"></A>            temp_diff /= (<FONT ID="Double">double</FONT>)m_stored[cl];
<FONT ID="LN">1188</FONT><A NAME="1188"></A>          }
<FONT ID="LN">1189</FONT><A NAME="1189"></A>        }
<FONT ID="LN">1190</FONT><A NAME="1190"></A>        m_weights[i] -= temp_diff;
<FONT ID="LN">1191</FONT><A NAME="1191"></A>
<FONT ID="LN">1192</FONT><A NAME="1192"></A>      }
<FONT ID="LN">1193</FONT><A NAME="1193"></A>    }
<FONT ID="LN">1194</FONT><A NAME="1194"></A>      
<FONT ID="LN">1195</FONT><A NAME="1195"></A>
<FONT ID="LN">1196</FONT><A NAME="1196"></A>    <FONT ID="SingleLineComment">// now do k nearest misses from each of the other classes
<FONT ID="LN">1197</FONT><A NAME="1197"></A></FONT>    temp_diff = <FONT ID="FloatPointLiteral">0.0</FONT>;
<FONT ID="LN">1198</FONT><A NAME="1198"></A>
<FONT ID="LN">1199</FONT><A NAME="1199"></A>    <FONT ID="For">for</FONT> (k = <FONT ID="IntegerLiteral">0</FONT>; k &lt; m_numClasses; k++) {
<FONT ID="LN">1200</FONT><A NAME="1200"></A>      <FONT ID="If">if</FONT> (k != cl) <FONT ID="SingleLineComment">// already done cl
<FONT ID="LN">1201</FONT><A NAME="1201"></A></FONT>        {
<FONT ID="LN">1202</FONT><A NAME="1202"></A>          <FONT ID="For">for</FONT> (j = <FONT ID="IntegerLiteral">0</FONT>; j &lt; m_stored[k]; j++) {
<FONT ID="LN">1203</FONT><A NAME="1203"></A>            <A HREF="../../weka/core/Instance.java.html">Instance</A> cmp;
<FONT ID="LN">1204</FONT><A NAME="1204"></A>            cmp = (m_weightByDistance) 
<FONT ID="LN">1205</FONT><A NAME="1205"></A>              ? m_trainInstances.
<FONT ID="LN">1206</FONT><A NAME="1206"></A>              instance((<FONT ID="Int">int</FONT>)m_karray[k][tempSortedAtt[k][j]][<FONT ID="IntegerLiteral">1</FONT>])
<FONT ID="LN">1207</FONT><A NAME="1207"></A>              : m_trainInstances.instance((<FONT ID="Int">int</FONT>)m_karray[k][j][<FONT ID="IntegerLiteral">1</FONT>]);
<FONT ID="LN">1208</FONT><A NAME="1208"></A>        
<FONT ID="LN">1209</FONT><A NAME="1209"></A>            <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> p1 = <FONT ID="IntegerLiteral">0</FONT>, p2 = <FONT ID="IntegerLiteral">0</FONT>; 
<FONT ID="LN">1210</FONT><A NAME="1210"></A>                 p1 &lt; inst.numValues() || p2 &lt; cmp.numValues();) {
<FONT ID="LN">1211</FONT><A NAME="1211"></A>              <FONT ID="If">if</FONT> (p1 &gt;= inst.numValues()) {
<FONT ID="LN">1212</FONT><A NAME="1212"></A>                firstI = m_trainInstances.numAttributes();
<FONT ID="LN">1213</FONT><A NAME="1213"></A>              } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1214</FONT><A NAME="1214"></A>                firstI = inst.index(p1); 
<FONT ID="LN">1215</FONT><A NAME="1215"></A>              }
<FONT ID="LN">1216</FONT><A NAME="1216"></A>              <FONT ID="If">if</FONT> (p2 &gt;= cmp.numValues()) {
<FONT ID="LN">1217</FONT><A NAME="1217"></A>                secondI = m_trainInstances.numAttributes();
<FONT ID="LN">1218</FONT><A NAME="1218"></A>              } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1219</FONT><A NAME="1219"></A>                secondI = cmp.index(p2);
<FONT ID="LN">1220</FONT><A NAME="1220"></A>              }
<FONT ID="LN">1221</FONT><A NAME="1221"></A>              <FONT ID="If">if</FONT> (firstI == m_trainInstances.classIndex()) {
<FONT ID="LN">1222</FONT><A NAME="1222"></A>                p1++; <FONT ID="Continue">continue</FONT>;
<FONT ID="LN">1223</FONT><A NAME="1223"></A>              } 
<FONT ID="LN">1224</FONT><A NAME="1224"></A>              <FONT ID="If">if</FONT> (secondI == m_trainInstances.classIndex()) {
<FONT ID="LN">1225</FONT><A NAME="1225"></A>                p2++; <FONT ID="Continue">continue</FONT>;
<FONT ID="LN">1226</FONT><A NAME="1226"></A>              } 
<FONT ID="LN">1227</FONT><A NAME="1227"></A>              <FONT ID="If">if</FONT> (firstI == secondI) {
<FONT ID="LN">1228</FONT><A NAME="1228"></A>                i = firstI;
<FONT ID="LN">1229</FONT><A NAME="1229"></A>                temp_diff = difference(i, inst.valueSparse(p1), 
<FONT ID="LN">1230</FONT><A NAME="1230"></A>                                       cmp.valueSparse(p2)); 
<FONT ID="LN">1231</FONT><A NAME="1231"></A>                p1++;p2++;
<FONT ID="LN">1232</FONT><A NAME="1232"></A>              } <FONT ID="Else">else</FONT> <FONT ID="If">if</FONT> (firstI &gt; secondI) {
<FONT ID="LN">1233</FONT><A NAME="1233"></A>                i = secondI;
<FONT ID="LN">1234</FONT><A NAME="1234"></A>                temp_diff = difference(i, <FONT ID="IntegerLiteral">0</FONT>, cmp.valueSparse(p2));
<FONT ID="LN">1235</FONT><A NAME="1235"></A>                p2++;
<FONT ID="LN">1236</FONT><A NAME="1236"></A>              } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1237</FONT><A NAME="1237"></A>                i = firstI;
<FONT ID="LN">1238</FONT><A NAME="1238"></A>                temp_diff = difference(i, inst.valueSparse(p1), <FONT ID="IntegerLiteral">0</FONT>);
<FONT ID="LN">1239</FONT><A NAME="1239"></A>                p1++;
<FONT ID="LN">1240</FONT><A NAME="1240"></A>              } 
<FONT ID="LN">1241</FONT><A NAME="1241"></A>
<FONT ID="LN">1242</FONT><A NAME="1242"></A>              <FONT ID="If">if</FONT> (m_weightByDistance) {
<FONT ID="LN">1243</FONT><A NAME="1243"></A>                temp_diff *=
<FONT ID="LN">1244</FONT><A NAME="1244"></A>                  (m_weightsByRank[j]/distNormAtt[k]);
<FONT ID="LN">1245</FONT><A NAME="1245"></A>              }
<FONT ID="LN">1246</FONT><A NAME="1246"></A>              <FONT ID="Else">else</FONT> {
<FONT ID="LN">1247</FONT><A NAME="1247"></A>                <FONT ID="If">if</FONT> (m_stored[k] &gt; <FONT ID="IntegerLiteral">0</FONT>) {
<FONT ID="LN">1248</FONT><A NAME="1248"></A>                  temp_diff /= (<FONT ID="Double">double</FONT>)m_stored[k];
<FONT ID="LN">1249</FONT><A NAME="1249"></A>                }
<FONT ID="LN">1250</FONT><A NAME="1250"></A>              }
<FONT ID="LN">1251</FONT><A NAME="1251"></A>              <FONT ID="If">if</FONT> (m_numClasses &gt; <FONT ID="IntegerLiteral">2</FONT>) {
<FONT ID="LN">1252</FONT><A NAME="1252"></A>                m_weights[i] += ((m_classProbs[k]/w_norm)*temp_diff);
<FONT ID="LN">1253</FONT><A NAME="1253"></A>              } <FONT ID="Else">else</FONT> {
<FONT ID="LN">1254</FONT><A NAME="1254"></A>                m_weights[i] += temp_diff;
<FONT ID="LN">1255</FONT><A NAME="1255"></A>              }
<FONT ID="LN">1256</FONT><A NAME="1256"></A>            }
<FONT ID="LN">1257</FONT><A NAME="1257"></A>          }
<FONT ID="LN">1258</FONT><A NAME="1258"></A>        }
<FONT ID="LN">1259</FONT><A NAME="1259"></A>    }
<FONT ID="LN">1260</FONT><A NAME="1260"></A>  }
<FONT ID="LN">1261</FONT><A NAME="1261"></A>
<FONT ID="LN">1262</FONT><A NAME="1262"></A>
<FONT ID="LN">1263</FONT><A NAME="1263"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">1264</FONT><A NAME="1264"></A>   * Find the K nearest instances to supplied instance if the class is numeric,
<FONT ID="LN">1265</FONT><A NAME="1265"></A>   * or the K nearest Hits (same class) and Misses (K from each of the other
<FONT ID="LN">1266</FONT><A NAME="1266"></A>   * classes) if the class is discrete.
<FONT ID="LN">1267</FONT><A NAME="1267"></A>   *
<FONT ID="LN">1268</FONT><A NAME="1268"></A>   * @param instNum the index of the instance to find nearest neighbours of
<FONT ID="LN">1269</FONT><A NAME="1269"></A>   */</FONT>
<FONT ID="LN">1270</FONT><A NAME="1270"></A>  <FONT ID="Private">private</FONT> <FONT ID="Void">void</FONT> findKHitMiss (<FONT ID="Int">int</FONT> instNum) {
<FONT ID="LN">1271</FONT><A NAME="1271"></A>    <FONT ID="Int">int</FONT> i, j;
<FONT ID="LN">1272</FONT><A NAME="1272"></A>    <FONT ID="Int">int</FONT> cl;
<FONT ID="LN">1273</FONT><A NAME="1273"></A>    <FONT ID="Double">double</FONT> ww;
<FONT ID="LN">1274</FONT><A NAME="1274"></A>    <FONT ID="Double">double</FONT> temp_diff = <FONT ID="FloatPointLiteral">0.0</FONT>;
<FONT ID="LN">1275</FONT><A NAME="1275"></A>    <A HREF="../../weka/core/Instance.java.html">Instance</A> thisInst = m_trainInstances.instance(instNum);
<FONT ID="LN">1276</FONT><A NAME="1276"></A>
<FONT ID="LN">1277</FONT><A NAME="1277"></A>    <FONT ID="For">for</FONT> (i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; m_numInstances; i++) {
<FONT ID="LN">1278</FONT><A NAME="1278"></A>      <FONT ID="If">if</FONT> (i != instNum) {
<FONT ID="LN">1279</FONT><A NAME="1279"></A>        <A HREF="../../weka/core/Instance.java.html">Instance</A> cmpInst = m_trainInstances.instance(i);
<FONT ID="LN">1280</FONT><A NAME="1280"></A>        temp_diff = distance(cmpInst, thisInst);
<FONT ID="LN">1281</FONT><A NAME="1281"></A>
<FONT ID="LN">1282</FONT><A NAME="1282"></A>        <FONT ID="SingleLineComment">// class of this training instance or 0 if numeric
<FONT ID="LN">1283</FONT><A NAME="1283"></A></FONT>        <FONT ID="If">if</FONT> (m_numericClass) {
<FONT ID="LN">1284</FONT><A NAME="1284"></A>          cl = <FONT ID="IntegerLiteral">0</FONT>;
<FONT ID="LN">1285</FONT><A NAME="1285"></A>        }
<FONT ID="LN">1286</FONT><A NAME="1286"></A>        <FONT ID="Else">else</FONT> {
<FONT ID="LN">1287</FONT><A NAME="1287"></A>          cl = (<FONT ID="Int">int</FONT>)m_trainInstances.instance(i).value(m_classIndex);
<FONT ID="LN">1288</FONT><A NAME="1288"></A>        }
<FONT ID="LN">1289</FONT><A NAME="1289"></A>
<FONT ID="LN">1290</FONT><A NAME="1290"></A>        <FONT ID="SingleLineComment">// add this diff to the list for the class of this instance
<FONT ID="LN">1291</FONT><A NAME="1291"></A></FONT>        <FONT ID="If">if</FONT> (m_stored[cl] &lt; m_Knn) {
<FONT ID="LN">1292</FONT><A NAME="1292"></A>          m_karray[cl][m_stored[cl]][<FONT ID="IntegerLiteral">0</FONT>] = temp_diff;
<FONT ID="LN">1293</FONT><A NAME="1293"></A>          m_karray[cl][m_stored[cl]][<FONT ID="IntegerLiteral">1</FONT>] = i;
<FONT ID="LN">1294</FONT><A NAME="1294"></A>          m_stored[cl]++;
<FONT ID="LN">1295</FONT><A NAME="1295"></A>
<FONT ID="LN">1296</FONT><A NAME="1296"></A>          <FONT ID="SingleLineComment">// note the worst diff for this class
<FONT ID="LN">1297</FONT><A NAME="1297"></A></FONT>          <FONT ID="For">for</FONT> (j = <FONT ID="IntegerLiteral">0</FONT>, ww = -<FONT ID="FloatPointLiteral">1.0</FONT>; j &lt; m_stored[cl]; j++) {
<FONT ID="LN">1298</FONT><A NAME="1298"></A>            <FONT ID="If">if</FONT> (m_karray[cl][j][<FONT ID="IntegerLiteral">0</FONT>] &gt; ww) {
<FONT ID="LN">1299</FONT><A NAME="1299"></A>              ww = m_karray[cl][j][<FONT ID="IntegerLiteral">0</FONT>];
<FONT ID="LN">1300</FONT><A NAME="1300"></A>              m_index[cl] = j;
<FONT ID="LN">1301</FONT><A NAME="1301"></A>            }
<FONT ID="LN">1302</FONT><A NAME="1302"></A>          }
<FONT ID="LN">1303</FONT><A NAME="1303"></A>
<FONT ID="LN">1304</FONT><A NAME="1304"></A>          m_worst[cl] = ww;
<FONT ID="LN">1305</FONT><A NAME="1305"></A>        }
<FONT ID="LN">1306</FONT><A NAME="1306"></A>        <FONT ID="Else">else</FONT> 
<FONT ID="LN">1307</FONT><A NAME="1307"></A>          <FONT ID="MultiLineComment">/* if we already have stored knn for this class then check to
<FONT ID="LN">1308</FONT><A NAME="1308"></A>             see if this instance is better than the worst */</FONT>
<FONT ID="LN">1309</FONT><A NAME="1309"></A>          {
<FONT ID="LN">1310</FONT><A NAME="1310"></A>            <FONT ID="If">if</FONT> (temp_diff &lt; m_karray[cl][m_index[cl]][<FONT ID="IntegerLiteral">0</FONT>]) {
<FONT ID="LN">1311</FONT><A NAME="1311"></A>              m_karray[cl][m_index[cl]][<FONT ID="IntegerLiteral">0</FONT>] = temp_diff;
<FONT ID="LN">1312</FONT><A NAME="1312"></A>              m_karray[cl][m_index[cl]][<FONT ID="IntegerLiteral">1</FONT>] = i;
<FONT ID="LN">1313</FONT><A NAME="1313"></A>
<FONT ID="LN">1314</FONT><A NAME="1314"></A>              <FONT ID="For">for</FONT> (j = <FONT ID="IntegerLiteral">0</FONT>, ww = -<FONT ID="FloatPointLiteral">1.0</FONT>; j &lt; m_stored[cl]; j++) {
<FONT ID="LN">1315</FONT><A NAME="1315"></A>                <FONT ID="If">if</FONT> (m_karray[cl][j][<FONT ID="IntegerLiteral">0</FONT>] &gt; ww) {
<FONT ID="LN">1316</FONT><A NAME="1316"></A>                  ww = m_karray[cl][j][<FONT ID="IntegerLiteral">0</FONT>];
<FONT ID="LN">1317</FONT><A NAME="1317"></A>                  m_index[cl] = j;
<FONT ID="LN">1318</FONT><A NAME="1318"></A>                }
<FONT ID="LN">1319</FONT><A NAME="1319"></A>              }
<FONT ID="LN">1320</FONT><A NAME="1320"></A>
<FONT ID="LN">1321</FONT><A NAME="1321"></A>              m_worst[cl] = ww;
<FONT ID="LN">1322</FONT><A NAME="1322"></A>            }
<FONT ID="LN">1323</FONT><A NAME="1323"></A>          }
<FONT ID="LN">1324</FONT><A NAME="1324"></A>      }
<FONT ID="LN">1325</FONT><A NAME="1325"></A>    }
<FONT ID="LN">1326</FONT><A NAME="1326"></A>  }
<FONT ID="LN">1327</FONT><A NAME="1327"></A>  
<FONT ID="LN">1328</FONT><A NAME="1328"></A>  <FONT ID="FormalComment">/**
<FONT ID="LN">1329</FONT><A NAME="1329"></A>   * Returns the revision string.
<FONT ID="LN">1330</FONT><A NAME="1330"></A>   * 
<FONT ID="LN">1331</FONT><A NAME="1331"></A>   * @return        the revision
<FONT ID="LN">1332</FONT><A NAME="1332"></A>   */</FONT>
<FONT ID="LN">1333</FONT><A NAME="1333"></A>  <FONT ID="Public">public</FONT> String getRevision() {
<FONT ID="LN">1334</FONT><A NAME="1334"></A>    <FONT ID="Return">return</FONT> RevisionUtils.extract(<FONT ID="StringLiteral">"$Revision: 5987 $"</FONT>);
<FONT ID="LN">1335</FONT><A NAME="1335"></A>  }
<FONT ID="LN">1336</FONT><A NAME="1336"></A>
<FONT ID="LN">1337</FONT><A NAME="1337"></A>  <FONT ID="SingleLineComment">// ============
<FONT ID="LN">1338</FONT><A NAME="1338"></A></FONT>  <FONT ID="SingleLineComment">// Test method.
<FONT ID="LN">1339</FONT><A NAME="1339"></A></FONT>  <FONT ID="SingleLineComment">// ============
<FONT ID="LN">1340</FONT><A NAME="1340"></A></FONT>  <FONT ID="FormalComment">/**
<FONT ID="LN">1341</FONT><A NAME="1341"></A>   * Main method for testing this class.
<FONT ID="LN">1342</FONT><A NAME="1342"></A>   *
<FONT ID="LN">1343</FONT><A NAME="1343"></A>   * @param args the options
<FONT ID="LN">1344</FONT><A NAME="1344"></A>   */</FONT>
<FONT ID="LN">1345</FONT><A NAME="1345"></A>  <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Void">void</FONT> main (String[] args) {
<FONT ID="LN">1346</FONT><A NAME="1346"></A>    runEvaluator(<FONT ID="New">new</FONT> <A HREF="../../weka/attributeSelection/ReliefFAttributeEval.java.html">ReliefFAttributeEval</A>(), args);
<FONT ID="LN">1347</FONT><A NAME="1347"></A>  }
<FONT ID="LN">1348</FONT><A NAME="1348"></A>}
<FONT ID="LN">1349</FONT><A NAME="1349"></A></pre><TABLE id="Header" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2" width="33%">&nbsp;</td>
<td align="center" colspan="2" width="33%">
<font size="4">ReliefFAttributeEval.java</font>
</td>
<td align="right" colspan="2" width="33%">&nbsp;</td>
</tr>
</TABLE>

</BODY>
</HTML>